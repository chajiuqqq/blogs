[{"content":"ğŸ˜€å¯ä»¥å«æˆ‘Chris Caiï¼Œå†™ä¸‹æ­¤æ–‡æ—¶åˆšå·¥ä½œ4ä¸ªæœˆï¼Œå¾ˆé«˜å…´é‡åˆ°æ¯ä¸ªç‚¹è¿›æ¥çš„ç½‘å‹ã€‚æˆ‘å±äºå…´è¶£å¹¿æ³›ä½†ä¸å¤Ÿæ·±å…¥æŒä¹…çš„éæ ‡å‡†ç†å·¥ç”·ï¼ˆå› ä¸ºå¿ƒæ€ç»†è…»ï¼‰ï¼Œä»¥ä¸‹æ˜¯æˆ‘çš„å±¥å†ï¼š\n2021å¹´æ¯•ä¸šäºä¸Šæµ·å¸ˆèŒƒå¤§å­¦ï¼Œè®¡ç®—æœºä¸“ä¸š 2021å¹´åœ¨ä¸€ä¸ªä¸¤ä¸ªäººçš„ä¼ä¸šå¹²äº†åŠå¹´Javaï¼Œå¤è¯•é€šè¿‡åè¯»ç ”å»äº† 2023å¹´1æœˆå¼€å§‹å­¦goï¼Œ5æœˆåœ¨ä¸€å®¶åšNFTçš„å…¬å¸Goå®ä¹ ï¼Œç§¯ç´¯äº†Goå¼€å‘ç»éªŒ 2024å¹´æ¯•ä¸šäºæœ¬æ ¡ï¼Œè®¡ç®—æœºç¡•å£«ï¼Œåœ¨ä¸€å®¶to B/Gçš„å…¬å¸åšGoå¼€å‘ï¼ˆåˆšå…¥èŒå°±é£åŒˆç‰™åˆ©å‘†äº†2ä¸ªæœˆä¸Šçº¿QAQï¼Œå¹¸å¥½æœ‰è¡¥è´´ï¼‰ï¼Œå·¥ä½œ965ï¼Œèƒ½èººä½†å–œæ¬¢æ‰¾äº‹åš ğŸ˜†æˆ‘çš„ä»·å€¼è§‚æ’åºï¼š\nå®¶åº­ï¼šå¸Œæœ›æ‰¾åˆ°çµé­‚å¥‘åˆçš„äººä¸€èµ·äº«å—ç”Ÿæ´» ä¸ªäººçˆ±å¥½ï¼šåšæœ‰æ„æ€çš„äº‹æƒ… èŒä¸š/è‡ªæˆ‘å®ç°ï¼šèµšmoneyçš„åŒæ—¶èƒ½å®ç°è‡ªæˆ‘ä»·å€¼å°±æ›´å¥½äº† ğŸ¥°æœ€è®©æˆ‘å¼€å¿ƒ/äº«å—çš„ä¸€ä»¶äº‹ï¼š\nåœ¨æ·±å±±è€æ—é‡ŒèƒŒç€åŒ…ï¼Œæ‹„ç€ç™»å±±æ–å‰è¿› æå‡ºéœ€æ±‚ï¼Œå®ç°éœ€æ±‚çš„è¿‡ç¨‹ï¼ˆç‰¹åˆ«æ˜¯æ¶‰åŠITã€æŠ€æœ¯æ–¹é¢çš„ï¼‰ ğŸ¤—çˆ±å¥½ï¼š\nACGï¼ˆæ–°æµ·è¯šã€å·¨äººï¼‰ è¿åŠ¨ï¼ˆç¾½æ¯›çƒã€å¾’æ­¥ã€éœ²è¥ï¼‰ éŸ³ä¹ï¼ˆJayZhouã€blueæƒ…æ­Œï¼‰ ğŸ¤–ç›®å‰æ¥è¯´æœ€é‡è¦çš„äº‹ï¼š\næ‰¾åˆ°ä¸€ä¸ªäººç”Ÿç›®æ ‡ å‡è„‚ã€å¡‘å½¢å¢è‚Œ æ‰¾åˆ°ä¸€ä¸ªèŠå¾—æ¥çš„å¼‚æ€§ ","date":"2024-11-14T04:51:25Z","permalink":"https://chajiuqqq.github.io/blogs/p/%E5%85%B3%E4%BA%8E%E6%88%91/","title":"ğŸ˜‹å…³äºæˆ‘"},{"content":"stackæ˜¯æœ¬blogä½¿ç”¨çš„hugoä¸»é¢˜ï¼Œä»Šå¤©ç ”ç©¶äº†ä¸€ä¸‹å¦‚ä½•é…ç½®disqusåŠŸèƒ½ã€‚\nstackæœ¬èº«æ”¯æŒå¤šç§commentsç³»ç»Ÿï¼Œåªè¦åœ¨configé…ç½®ä¸‹å³å¯ã€‚\nå¯ä»¥ä»æ–‡æ¡£å¼€å§‹,ç„¶åçœ‹DisqusJSçš„ä»‹ç»ã€‚\nå…ˆåœ¨Disqusæ³¨å†ŒAPPï¼Œç„¶ååœ¨ Disqus API Applicationå¤„æ³¨å†Œä¸€ä¸ª Applicationã€‚\nè·å–API Key ï¼Œæ·»åŠ domainã€‚\nåœ¨Advancedè¿™é‡Œè¿˜è¦åŠ ä¸ªdoaminã€‚\nç„¶åä¸»è¦ä¿®æ”¹configä»¥ä¸‹å‡ ä¸ªåœ°æ–¹ï¼š æ ¹ç›®å½•ä¸‹çš„disqusShortnameï¼Œä»è¿™é‡Œè·å–ï¼Œè¿™è¾¹æ–‡æ¡£ç»™äº†WARNINGï¼Œè¯´æ˜¯å¿…é¡»ä»è¿™é‡Œä¿®æ”¹ï¼Œä¸ç„¶æ— æ³•èµ·ä½œç”¨ï¼Œç¡®å®æ˜¯è¿™æ ·ã€‚ commentä¸‹çš„disqusjs: apiUrlæŠ„æˆ‘è¿™ä¸ªå°±å¯ä»¥ã€‚apiKeyå’Œshortnameç”¨ä½ è‡ªå·±çš„ï¼Œä¸ç¡®å®šshortnameè¿™è¾¹è¿˜æœ‰æ²¡æœ‰å¿…è¦å¡«ã€‚ 1 2 3 4 5 6 disqusjs: shortname: chrisblog-2 apiUrl: https://disqus.com/api/ apiKey: xxxxxx admin: adminLabel: æœ€åç»“æœå¯ä»¥çœ‹ä¸‹é¢çš„è¯„è®ºåŒºæ•ˆæœï¼Œå¯ä»¥ç™»å½•disqusè´¦å·æ¥å‘è¯„è®ºï¼Œadminå¯ä»¥åœ¨disqusä¸­ç®¡ç†è¯„è®ºï¼Œä¼°è®¡ä¹Ÿå¯ä»¥é…ç½®å‘é€é‚®ä»¶ã€‚\n","date":"2023-08-07T12:55:52+08:00","image":"https://chajiuqqq.github.io/blogs/p/%E7%BB%99blog%E6%B7%BB%E5%8A%A0disqus%E8%AF%84%E8%AE%BA%E5%8A%9F%E8%83%BD/ocean-3605547_1280_hua219baf853ba06bb2e93dec3e8777fbe_169844_120x120_fill_q75_box_smart1.jpg","permalink":"https://chajiuqqq.github.io/blogs/p/%E7%BB%99blog%E6%B7%BB%E5%8A%A0disqus%E8%AF%84%E8%AE%BA%E5%8A%9F%E8%83%BD/","title":"ç»™blogæ·»åŠ Disqusè¯„è®ºåŠŸèƒ½"},{"content":"æ¬¢è¿å‹å–„çš„è®¨è®ºï¼Œæ¶æ„çš„ã€äººèº«æ”»å‡»çš„è¨€è®ºä¼šè¢«åˆ é™¤ã€‚\n","date":"2023-08-06T21:36:12+08:00","permalink":"https://chajiuqqq.github.io/blogs/p/comment-policy/","title":"Comment Policy"},{"content":"Joplinæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„å¼€æºç¬”è®°åº”ç”¨ç¨‹åºï¼Œæ”¯æŒWindowsã€macOSã€Linuxã€Androidå’ŒiOSã€‚å®ƒå…·æœ‰å¼ºå¤§çš„ç¬”è®°ç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç¬”è®°çš„åˆ›å»ºã€ç¼–è¾‘ã€ç¬”è®°æœ¬çš„ç®¡ç†ã€æ ‡ç­¾çš„ç®¡ç†ã€ç¬”è®°æœç´¢ç­‰ã€‚\nJoplinæ”¯æŒå¤šå¹³å°åŒæ­¥ï¼Œç”¨æˆ·å¯ä»¥å°†ç¬”è®°åŒæ­¥åˆ°æ‰€æœ‰è®¾å¤‡ä¸Šï¼ŒåŒ…æ‹¬æ¡Œé¢ç”µè„‘ã€æ‰‹æœºå’Œå¹³æ¿ç”µè„‘ã€‚å®˜æ–¹æä¾›å…è´¹Joplin Cloudè¿›è¡Œç¬”è®°åŒæ­¥ï¼Œä¹Ÿæ”¯æŒå¾ˆå¤šè‡ªå»ºå¹³å°çš„ç¬”è®°åŒæ­¥ï¼Œå¦‚\nDropbox OneDrive Nextcloud/ownCloud WebDAV SFTP Joplin Server æœ¬æ–‡ä»‹ç»è‡ªå»ºJoplin Serverã€‚\nJopliné»˜è®¤ä½¿ç”¨SQLiteï¼Œä½†æ˜¯ä¸æ”¯æŒå¤šç”¨æˆ·å¹¶å‘è®¿é—®ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨postgresï¼Œæˆ‘ä»¬ç”¨docker-composeç»„åˆåˆ›å»ºå’Œç®¡ç†å®¹å™¨ï¼Œåœ¨ï½ä¸‹åˆ›å»ºdocker-compose.yml:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 version: \u0026#39;3.1\u0026#39; services: db: image: \u0026#34;postgres:13\u0026#34; restart: always environment: POSTGRES_USER: joplin POSTGRES_PASSWORD: joplinpwd POSTGRES_DB: joplin joplin: image: \u0026#34;joplin/server:latest\u0026#34; env_file: - .env ports: - \u0026#34;22300:22300\u0026#34; å¤åˆ¶.env-sampleåˆ°ï½ä¸‹çš„.envï¼Œè¿™æ˜¯joplinçš„é…ç½®æ–‡ä»¶ã€‚\nä¿®æ”¹\n1 2 APP_BASE_URL=https://example.com/joplin APP_PORT=22300 APP_BASE_URLå¯ä»¥ä¸ç”¨httpsï¼Œ/joplinæ˜¯ç”¨æ¥è·³è½¬çš„ï¼Œåœ¨nginxä¸­è®¾ç½®è®¿é—®/joplinæ—¶è¿›è¡Œåå‘ä»£ç†åˆ°æœ¬åœ°çš„22300ç«¯å£ã€‚ä¸€èˆ¬ç›´æ¥æ”¹åŸŸåå³å¯ï¼ˆå¦‚æœç”¨httpï¼Œè¿™é‡Œä¸€å®šè¦æ”¹ä¸ºhttpï¼‰ã€‚\nä¿®æ”¹æ•°æ®åº“é…ç½®æ•°æ®ï¼Œå’Œä¸Šé¢å¯¹åº”å¥½ï¼š\n1 2 3 4 5 6 DB_CLIENT=pg POSTGRES_PASSWORD=joplinpwd POSTGRES_DATABASE=joplin POSTGRES_USER=joplin POSTGRES_PORT=5432 POSTGRES_HOST=db é…ç½®nginxï¼Œä¿®æ”¹/etc/nginx/nginx.conf ä½¿ç”¨httpï¼Œè€Œä¸æ˜¯httpsçš„è¯nginxé…ç½®æ–‡ä»¶è¿™ä¹ˆå†™ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 server { server_name www.chajiuqqq.cn; listen 80; location /joplin/ { proxy_pass http://127.0.0.1:22300/; proxy_set_header Host $host; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; proxy_set_header X-Forwarded-Port $server_port; proxy_set_header X-Forwarded-Host $host; client_max_body_size 400M; } } å¦‚æœè¦ç”¨sslï¼Œå‡†å¤‡.pemå’Œ.keyæ–‡ä»¶æ”¾åˆ°ä¸€ä¸ªç›®å½•ä¸‹ï¼Œ è¿™é‡Œä»¥/rootä¸ºä¾‹ï¼š\nåœ¨Nginxä¸­ä¿®æ”¹nginx.confï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 server { server_name www.chajiuqqq.cn; listen 443 ssl; ssl_certificate /root/xxx.cn.pem; ssl_certificate_key /root/xxx.key; location /joplin/ { proxy_pass http://127.0.0.1:22300/; proxy_set_header Host $host; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; proxy_set_header X-Forwarded-Port $server_port; proxy_set_header X-Forwarded-Host $host; client_max_body_size 400M; } } æ³¨æ„ä¸¤ä¸ªåœ°æ–¹ç»“å°¾æœ‰/ï¼š\nlocation /joplin/ proxy_pass http://127.0.0.1:22300/; è¿è¡Œå®¹å™¨ åœ¨docker-compose.ymlç›®å½•ä¸‹è¿è¡Œdocker compose upï¼Œè®¿é—® https://example.com/joplin/loginï¼Œé»˜è®¤ç”¨æˆ·åadmin@localhostï¼Œå¯†ç adminã€‚\nå»ºè®®åˆ›å»ºæ™®é€šç”¨æˆ·ï¼Œåœ¨appä¸Šç™»é™†ä½¿ç”¨åŒæ­¥åŠŸèƒ½ã€‚appæˆ–pcè®¾ç½®é‡Œé€‰æ‹©åŒæ­¥ï¼Œç„¶åé€‰æœ€åº•ä¸‹çš„joplin serverï¼Œåœ°å€å°±æ˜¯https://example.com/joplin\n","date":"2023-03-14T20:37:50+08:00","image":"https://chajiuqqq.github.io/blogs/p/docker%E6%90%AD%E5%BB%BAjoplin%E6%B5%81%E7%A8%8B/cover_huf8320ca44821da6e66e3fb03042d0650_319311_120x120_fill_q75_box_smart1.jpeg","permalink":"https://chajiuqqq.github.io/blogs/p/docker%E6%90%AD%E5%BB%BAjoplin%E6%B5%81%E7%A8%8B/","title":"dockeræ­å»ºJoplinæµç¨‹"},{"content":"go-kitçš„ä¸‰å±‚ç»“æ„ go-kité¡¹ç›®é‡‡ç”¨åˆ†å±‚æ¶æ„æ–¹å¼ã€‚\ntransportå±‚ï¼šå¤„ç†httpã€grpcç­‰é€»è¾‘ã€‚æ¯”å¦‚åœ¨httpä¸­å°±æ˜¯è¿”å›ä¸€ä¸ªhttp.Handlerï¼Œé‡Œé¢åŒ…å«äº†URLå’Œå¯¹åº”å¤„ç†å™¨çš„å…³ç³» endpointå±‚ï¼šç”¨äºæ¥å—è¯·æ±‚ï¼Œå¤„ç†è¯·æ±‚ï¼Œè¿”å›å“åº”ã€‚æ¯ä¸ªæœåŠ¡éƒ½ä¼šåŒ…è£…æˆä¸€ä¸ªendpointï¼Œåœ¨endpointä¸­è°ƒç”¨serviceçš„æ–¹æ³•ï¼Œæœ€åè¿”å›ç»„è£…å¥½çš„responseã€‚ç±»ä¼¼Javaä¸­controllerçš„å†™æ³•ï¼Œä¸è¿‡è¿™é‡Œæ²¡æœ‰æ¶‰åŠURLè·¯å¾„ï¼Œåªæ˜¯æä¾›åŒ…è£…åçš„æœåŠ¡ã€‚ serviceå±‚ï¼šä¸šåŠ¡ä»£ç å®ç°å±‚ï¼Œä¹Ÿå°±æ˜¯å®šä¹‰äº†æœ‰ä»€ä¹ˆæœåŠ¡ï¼ŒæœåŠ¡çš„å…·ä½“å®ç°ã€‚ ä»£ç ä¸­ä½¿ç”¨äº†go-kitçš„å‡½æ•°ï¼Œå½±å“è¾ƒå¤§çš„æ˜¯endpointå±‚å’Œtransportå±‚ã€‚å†™æ³•å’Œæˆ‘ä»¬æ™®é€šåˆ†å±‚å†™ä¸å¤ªä¸€æ ·ï¼Œç”¨äº†å¾ˆå¤šgo-kitçš„APIã€‚ä¸‹é¢æˆ‘ä»¬å…ˆä»serviceå±‚è®²èµ·ã€‚\nserviceå±‚ ä½œä¸ºæœåŠ¡ç«¯ï¼Œå¦‚æœæƒ³è¦ä½¿ç”¨æœåŠ¡æ³¨å†Œå’Œå‘ç°ä¸­å¿ƒï¼Œæ¯”å¦‚consulï¼Œé‚£ä¹ˆæœåŠ¡ç«¯éœ€è¦æœ‰è¿™ä¸‰ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬æŠ½è±¡ä¸ºä¸€ä¸ªæ¥å£ï¼š\ntype DiscoveryClient interface { /** * æœåŠ¡æ³¨å†Œæ¥å£ * @param serviceName æœåŠ¡å * @param instanceId æœåŠ¡å®ä¾‹Id * @param instancePort æœåŠ¡å®ä¾‹ç«¯å£ * @param healthCheckUrl å¥åº·æ£€æŸ¥åœ°å€ * @param instanceHost æœåŠ¡å®ä¾‹åœ°å€ * @param meta æœåŠ¡å®ä¾‹å…ƒæ•°æ® */ Register(serviceName, instanceId, healthCheckUrl string, instanceHost string, instancePort int, meta map[string]string, logger *log.Logger) bool /** * æœåŠ¡æ³¨é”€æ¥å£ * @param instanceId æœåŠ¡å®ä¾‹Id */ DeRegister(instanceId string, logger *log.Logger) bool /** * å‘ç°æœåŠ¡å®ä¾‹æ¥å£ * @param serviceName æœåŠ¡å */ DiscoverServices(serviceName string, logger *log.Logger) []interface{} } Registerç”¨äºæŠŠè‡ªå·±æ³¨å†Œåˆ°consul DeRegisterç”¨äºå‘consulæ³¨é”€è‡ªå·±çš„æœåŠ¡ DiscoverServicesç”¨äºå‘consulè¯·æ±‚åˆ«çš„æœåŠ¡ å¯¹åº”å¯ä»¥æœ‰è‡ªå·±çš„æ¥å£å®ç°ï¼Œæ¯”å¦‚å®šä¹‰MyDiscoverClientç»“æ„ï¼Œç„¶åå®ç°DiscoveryClientæ¥å£ï¼Œå¦‚æ³¨å†Œæ–¹æ³•å¯ä»¥è‡ªå·±å†™httpè¯·æ±‚ï¼Œå‘é€åˆ°consulæ³¨å†Œï¼›æˆ–è€…å®šä¹‰KitDiscoverClientç»“æ„ï¼Œç„¶åå®ç°DiscoveryClientæ¥å£ï¼Œè°ƒç”¨go-kitçš„consul clientè¿›è¡Œå¿«é€Ÿæ³¨å†Œã€‚\nç®€å•è´´ä¸€ä¸ªæ³¨å†Œæ–¹æ³•çš„go-kitå®ç°ï¼š\nfunc (consulClient *KitDiscoverClient) Register(serviceName, instanceId, healthCheckUrl string, instanceHost string, instancePort int, meta map[string]string, logger *log.Logger) bool { // 1. æ„å»ºæœåŠ¡å®ä¾‹å…ƒæ•°æ® serviceRegistration := \u0026amp;api.AgentServiceRegistration{ ID: instanceId, Name: serviceName, Address: instanceHost, Port: instancePort, Meta: meta, Check: \u0026amp;api.AgentServiceCheck{ DeregisterCriticalServiceAfter: \u0026quot;30s\u0026quot;, HTTP: \u0026quot;http://\u0026quot; + instanceHost + \u0026quot;:\u0026quot; + strconv.Itoa(instancePort) + healthCheckUrl, Interval: \u0026quot;15s\u0026quot;, }, } // 2. å‘é€æœåŠ¡æ³¨å†Œåˆ° Consul ä¸­ err := consulClient.client.Register(serviceRegistration) if err != nil { log.Println(\u0026quot;Register Service Error!\u0026quot;) return false } log.Println(\u0026quot;Register Service Success!\u0026quot;) return true } ç¬¬äºŒä¸ªæ¥å£æ˜¯Serviceæ¥å£ï¼ŒåŒ…å«ä½ å¯ä»¥æä¾›ä»€ä¹ˆæœåŠ¡ï¼Œæ¯”å¦‚è¿æ¥å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚å¿ƒè·³æ£€æŸ¥ï¼Œæ¯”å¦‚å‘ç°æœåŠ¡ã€‚å¦‚ï¼š\ntype Service interface { // HealthCheck check service health status HealthCheck() bool // sayHelloService SayHello() string // discovery service from consul by serviceName DiscoveryService(ctx context.Context, serviceName string) ([]interface{}, error) } ç„¶åæä¾›è‡ªå·±çš„ç»“æ„å®ç°ï¼Œå¦‚DiscoveryServiceImplï¼Œè¿™ä¸ªç»“æ„é‡Œä¹Ÿå¯ä»¥åŒ…å«ä¸Šé¢æåˆ°çš„DiscoveryClientå®ä¾‹ï¼Œè¿™æ ·å°±å¯ä»¥å¤ç”¨DiscoveryClientçš„å®ç°äº†ï¼š\n//å®šä¹‰æ¥å£å®ç°çš„ç»“æ„ type DiscoveryServiceImpl struct { discoveryClient discover.DiscoveryClient } //å®šä¹‰å·¥å‚æ–¹æ³•ï¼Œå…¶å®ä¸è¦ä¹Ÿå¯ä»¥ func NewDiscoveryServiceImpl(discoveryClient discover.DiscoveryClient) Service { return \u0026amp;DiscoveryServiceImpl{ discoveryClient:discoveryClient, } } //ä¸‹é¢æ˜¯å®ç°æ¥å£çš„æ–¹æ³• func (*DiscoveryServiceImpl) SayHello() string { return \u0026quot;Hello World!\u0026quot; } func (service *DiscoveryServiceImpl) DiscoveryService(ctx context.Context, serviceName string) ([]interface{}, error) { instances := service.discoveryClient.DiscoverServices(serviceName, config.Logger) if instances == nil || len(instances) == 0 { return nil, ErrNotServiceInstances } return instances, nil } // HealthCheck implement Service method // ç”¨äºæ£€æŸ¥æœåŠ¡çš„å¥åº·çŠ¶æ€ï¼Œè¿™é‡Œä»…ä»…è¿”å›true func (*DiscoveryServiceImpl) HealthCheck() bool { return true } é€šè¿‡ä¸Šé¢çš„å·¥å‚æ–¹æ³•NewDiscoveryServiceImplï¼Œå¯ä»¥æ„å»ºå‡ºä¸€ä¸ªServiceçš„å®ç°ï¼Œç”¨äºè°ƒç”¨è‡ªå·±çš„å„ç§service\n// å£°æ˜å¹¶åˆå§‹åŒ– Service var svc = service.NewDiscoveryServiceImpl(discoveryClient) æ¥ä¸‹æ¥æ˜¯è¦æŠŠæœåŠ¡æš´éœ²å‡ºæ¥ï¼Œä¸€ä¸ªå¾ˆç®€å•çš„æ–¹æ³•æ˜¯é€šè¿‡URLæš´éœ²ï¼Œæ¯”å¦‚å°†GETçš„/say-helloæ˜ å°„åˆ°Serviceçš„sayHelloæ–¹æ³•ä¸Šï¼Œä¹Ÿå°±æ˜¯HTTPæœåŠ¡å™¨é‡Œç”¨å¤„ç†å™¨å»å¤„ç†URLè¯·æ±‚ã€‚ä½†æ˜¯go-kitä½¿ç”¨äº†endpointçš„æ¦‚å¿µï¼ŒæŠŠæœåŠ¡ç§°ä¸ºendpointï¼Œå…¶ä¸­ä¸åŒ…å«å¯¹åº”çš„URLã€‚\nURLå’Œendpointçš„ç»‘å®šæˆ‘ä»¬æ”¾åœ¨äº†transportå±‚å®ç°ã€‚\nendpointå±‚ é¦–å…ˆä»‹ç»endpointå±‚ã€‚æ¯ä¸ªæœåŠ¡éƒ½æ˜¯ä¸€ä¸ªendpointï¼Œæ‰€ä»¥æ„å»ºä¸€ä¸ªæœºæ„ï¼ŒåŒ…å«æ‰€æœ‰çš„æœåŠ¡ï¼ˆendpointï¼‰ï¼š\ntype DiscoveryEndpoints struct { SayHelloEndpoint\tendpoint.Endpoint DiscoveryEndpoint\tendpoint.Endpoint HealthCheckEndpoint endpoint.Endpoint } ä¸Šé¢çš„endpoint.Endpointå…¶å®å°±æ˜¯ä¸€ä¸ªå‡½æ•°åˆ«åï¼š\nfunc(ctx context.Context, request interface{}) (response interface{}, err error) ä¹Ÿå°±æ˜¯è¯´ï¼ŒDiscoveryEndpointsæ˜¯åŒ…å«äº†å‡ ä¸ªå‡½æ•°çš„ç»“æ„ï¼Œè¿™å‡ ä¸ªå‡½æ•°ä¹Ÿå°±æ˜¯æä¾›è¯·æ±‚å“åº”æœåŠ¡çš„ã€‚\nç„¶åéœ€è¦å®šä¹‰æ¯ä¸ªæœåŠ¡çš„è¯·æ±‚ç»“æ„ã€å“åº”ç»“æ„ï¼Œå¦‚ï¼š\nSayHelloEndpoint\u0026ndash;\u0026gt;SayHelloRequestã€SayHelloResponse\nDiscoveryEndpoint\u0026ndash;\u0026gt;DiscoveryRequestã€DiscoveryResponse\næ¯ä¸ªç»“æ„é‡Œå°±æ˜¯ä½ éœ€è¦ä¼ é€’çš„æ•°æ®å­—æ®µï¼Œæ²¡æœ‰çš„è¯å°±ç©ºï¼ŒåŒæ—¶è¦æŒ‡æ˜jsonåºåˆ—åŒ–tagï¼š\n// æ‰“æ‹›å‘¼è¯·æ±‚ç»“æ„ä½“ type SayHelloRequest struct { } // æ‰“æ‹›å‘¼å“åº”ç»“æ„ä½“ type SayHelloResponse struct { Message string `json:\u0026quot;message\u0026quot;` } ç„¶åæ˜¯å†™å‡½æ•°è¿”å›è¿™ä¸ªå…·ä½“çš„endpointï¼Œå¯ä»¥çœ‹åˆ°å°±æ˜¯è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œæœ€åè¿”å›çš„æ˜¯SayHelloResponseï¼š\n// åˆ›å»ºæ‰“æ‹›å‘¼ Endpoint func MakeSayHelloEndpoint(svc service.Service) endpoint.Endpoint { return func(ctx context.Context, request interface{}) (response interface{}, err error) { message := svc.SayHello() return SayHelloResponse{ Message:message, }, nil } } å¦‚æœæœ‰è¯·æ±‚æ•°æ®ï¼Œå¦‚ä½•ä»è¯·æ±‚ä¸­è·å–ï¼Ÿ\nå¯ä»¥ä»requestå¯¹è±¡ä¸­è½¬æˆä½ è¿™ä¸ªendpointå¯¹åº”çš„è¯·æ±‚ç»“æ„ï¼Œå¦‚req := request.(DiscoveryRequest)ï¼Œè¿™æ ·å°±å¯ä»¥ç”¨ç»“æ„é‡Œçš„æ•°æ®äº†ã€‚\n// åˆ›å»ºæœåŠ¡å‘ç°çš„ Endpoint func MakeDiscoveryEndpoint(svc service.Service) endpoint.Endpoint { return func(ctx context.Context, request interface{}) (response interface{}, err error) { req := request.(DiscoveryRequest) instances, err := svc.DiscoveryService(ctx, req.ServiceName) var errString = \u0026quot;\u0026quot; if err != nil{ errString = err.Error() } return \u0026amp;DiscoveryResponse{ Instances:instances, Error:errString, }, nil } } ä½ å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œä¸ºä»€ä¹ˆrequestç›´æ¥å¯ä»¥è½¬æˆå¯¹åº”çš„è¯·æ±‚ç»“æ„ï¼Œæ˜¯å¦‚ä½•è½¬çš„å‘¢ï¼Ÿè¿™åœ¨åé¢ä¼šæåˆ°ï¼Œç³»ç»Ÿä¼šä½¿ç”¨æˆ‘ä»¬æä¾›çš„ååºåˆ—åŒ–æ–¹æ³•ï¼Œå°†è¯·æ±‚decodeä¸ºæˆ‘ä»¬è®¾è®¡çš„è¯·æ±‚ç»“æ„ã€‚åŒç†ï¼Œæœ€åresponseç»“æ„å¦‚ä½•åºåˆ—åŒ–å‘é€ç»™å®¢æˆ·ç«¯ï¼Ÿä¹Ÿæ˜¯è°ƒç”¨äº†æˆ‘ä»¬æä¾›çš„åºåˆ—åŒ–æ–¹æ³•ã€‚\nè‡³æ­¤ï¼Œendpointæ„å»ºå®Œæ¯•\ntransportå±‚ å¦‚åœ¨httpæœåŠ¡ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªå‡½æ•°è¿”å›Handlerã€‚åŒºåˆ«äºç›´æ¥æä¾›ç»™URLä¸€ä¸ªå¤„ç†å™¨æˆ–å¤„ç†å™¨å‡½æ•°ï¼Œè¿™è¾¹æˆ‘ä»¬ä½¿ç”¨kithttpæä¾›çš„å¤„ç†å™¨ã€‚\næˆ‘ä»¬éœ€è¦æä¾›å‡ ä¸ªå‚æ•°å»æ„å»ºè¿™ä¸ªå¤„ç†å™¨ï¼š\nendpointï¼šæœåŠ¡å¤„ç†å‡½æ•°ï¼Œå¦‚endpoints.SayHelloEndpoint è¯·æ±‚è§£ç å‡½æ•°ï¼šå¦‚decodeSayHelloRequest å“åº”ç¼–ç å‡½æ•°ï¼šå¦‚encodeJsonResponse å¤„ç†å™¨é€‰é¡¹ çœ‹çœ‹ç¬¬ä¸€ä¸ªæœåŠ¡æ˜¯å¦‚ä½•æš´éœ²çš„ï¼š\næ˜ å°„GETçš„/say-helloåˆ°ä¸€ä¸ªå¤„ç†å™¨ è¿™ä¸ªå¤„ç†å™¨åŒ…å«endpoints.SayHelloEndpointç”¨äºå¤„ç†è¯·æ±‚ï¼Œå¹¶è¿”å›å“åº” åŒ…å«decodeSayHelloRequestç”¨äºå°†è¯·æ±‚è§£ç åˆ°SayHelloRequest åŒ…å«encodeJsonResponseç”¨äºå°†SayHelloRequestè½¬ä¸ºJSONæ ¼å¼ æœ€ååŒ…å«å‡ ä¸ªé”™è¯¯å¤„ç†çš„æ–¹å¼ seeï¼š\n// MakeHttpHandler make http handler use mux func MakeHttpHandler(ctx context.Context, endpoints endpts.DiscoveryEndpoints, logger log.Logger) http.Handler { r := mux.NewRouter() options := []kithttp.ServerOption{ kithttp.ServerErrorHandler(transport.NewLogErrorHandler(logger)), kithttp.ServerErrorEncoder(encodeError), } r.Methods(\u0026quot;GET\u0026quot;).Path(\u0026quot;/say-hello\u0026quot;).Handler(kithttp.NewServer( endpoints.SayHelloEndpoint, decodeSayHelloRequest, encodeJsonResponse, options..., )) r.Methods(\u0026quot;GET\u0026quot;).Path(\u0026quot;/discovery\u0026quot;).Handler(kithttp.NewServer( endpoints.DiscoveryEndpoint, decodeDiscoveryRequest, encodeJsonResponse, options..., )) // create health check handler r.Methods(\u0026quot;GET\u0026quot;).Path(\u0026quot;/health\u0026quot;).Handler(kithttp.NewServer( endpoints.HealthCheckEndpoint, decodeHealthCheckRequest, encodeJsonResponse, options..., )) return r } å½“ç„¶ä¸Šé¢æåˆ°çš„è¯·æ±‚è§£ç å‡½æ•°å’Œå“åº”ç¼–ç å‡½æ•°éƒ½æ˜¯è‡ªå·±å†™çš„ï¼Œå‡½æ•°ç­¾åè¦éµç…§ä¸åŒæ ¼å¼å“¦ï¼š\n// decodeSayHelloRequest decode request params to struct func decodeSayHelloRequest(_ context.Context, r *http.Request) (interface{}, error) { return endpts.SayHelloRequest{}, nil } // decodeDiscoveryRequest decode request params to struct func decodeDiscoveryRequest(_ context.Context, r *http.Request) (interface{}, error) { serviceName := r.URL.Query().Get(\u0026quot;serviceName\u0026quot;) if serviceName == \u0026quot;\u0026quot;{ return nil, ErrorBadRequest } return endpts.DiscoveryRequest{ ServiceName:serviceName, }, nil } // decodeHealthCheckRequest decode request func decodeHealthCheckRequest(ctx context.Context, r *http.Request) (interface{}, error) { return endpts.HealthRequest{}, nil } // encodeJsonResponse encode response to return func encodeJsonResponse(ctx context.Context, w http.ResponseWriter, response interface{}) error { w.Header().Set(\u0026quot;Content-Type\u0026quot;, \u0026quot;application/json;charset=utf-8\u0026quot;) return json.NewEncoder(w).Encode(response) } mainå‡½æ•°è°ƒç”¨ å¤„ç†æµç¨‹å¦‚ä¸‹\nè¯»å–consulHost, consulPort ç”¨ä¸Šè¿°å‚æ•°æ„å»ºdiscoveryClient ç”¨discoveryClientæ„å»ºservice ç”¨serviceæ„å»ºè‹¥å¹²ä¸ªendpoints ç”¨è‹¥å¹²ä¸ªendpointsæ„å»ºtransportçš„handler å‘consulæ³¨å†Œè‡ªå·± ç”¨handlerå’Œç«¯å£æ„å»ºå¹¶å¼€å¯httpæœåŠ¡ ç›‘å¬åˆ°ç»ˆæ­¢ä¿¡å·åˆ™å‘consulå–æ¶ˆæ³¨å†Œï¼Œå¹¶é€€å‡ºæœåŠ¡ æ³¨å†Œæ—¶å€™æœ‰ä¸ªé—®é¢˜ï¼Œå‘æœåŠ¡ä¸­å¿ƒæ³¨å†Œæ—¶åªè¦æäº¤instanceIdã€serviceNameã€instanceHostã€instancePortç­‰ä¿¡æ¯ï¼Œä½†æ˜¯ä¸åŒ…å«ç»“æ„åŒ–çš„æœ‰ä»€ä¹ˆæœåŠ¡ï¼ŒæœåŠ¡å¯¹åº”çš„URLæ˜¯ä»€ä¹ˆï¼Œåˆ«äººé€šè¿‡æœåŠ¡åæŸ¥è¯¢åˆ°è¯¥å®ä¾‹ï¼ŒçŸ¥é“è¯¥å®ä¾‹çš„hostå’Œportï¼Œä½†æ˜¯æ¥ä¸‹æ¥æ€åšï¼Ÿæˆ‘è¿˜æ˜¯ä¸çŸ¥é“ä½ æä¾›ä»€ä¹ˆæœåŠ¡å•Šï¼Œä¸çŸ¥é“æœåŠ¡åœ¨å“ªä¸ªURLã€‚\nç„¶åè°ƒç”¨åˆ«äººçš„æœåŠ¡ä¹Ÿæ˜¯æ‰‹åŠ¨å‘é€httpè¯·æ±‚å—ã€‚\nå­¦äº†grpcä¹‹åï¼Œæ˜ç™½rpcæ˜¯è§£å†³å¾®æœåŠ¡ä¹‹é—´çš„è°ƒç”¨é—®é¢˜ï¼Œè€ŒæœåŠ¡çš„æ³¨å†Œå’Œå‘ç°æ˜¯è¿™ä¸€ç« è§£å†³çš„ï¼Œå¦‚ä½•å°†äºŒè€…ç»“åˆï¼Ÿæ¯”å¦‚æŸä¸ªrpcæœåŠ¡å‘æœåŠ¡ä¸­å¿ƒæ³¨å†Œï¼Œç„¶åå®¢æˆ·ç«¯æŸ¥è¯¢â€œXXXâ€æœåŠ¡ï¼Œè·å¾—â€œXXXâ€æœåŠ¡çš„åœ°å€å’Œç«¯å£ï¼Œç„¶åå»ºç«‹rpcè¿æ¥ï¼Œç”¨rpcå»è°ƒç”¨ã€‚è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒåˆç†çš„é€»è¾‘ã€‚\nå³æœåŠ¡ä¸­å¿ƒè§£å†³æœåŠ¡åœ¨å“ªçš„é—®é¢˜ï¼ŒRPCè§£å†³æœåŠ¡è°ƒç”¨ã€è¿”å›çš„é—®é¢˜\n","date":"2023-03-01T13:50:07+08:00","permalink":"https://chajiuqqq.github.io/blogs/p/gokit%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E5%92%8Cconsul%E7%BB%93%E5%90%88%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E5%92%8C%E5%8F%91%E7%8E%B0/","title":"Gokité¡¹ç›®ç»“æ„å’ŒConsulç»“åˆå®ç°æœåŠ¡æ³¨å†Œå’Œå‘ç°"},{"content":"gRPCå’Œprotocol buffersé€šå¸¸è¢«ä¸€èµ·ä½¿ç”¨ï¼ŒprotoBufæ˜¯gRPCçš„æ¥å£å®šä¹‰è¯­è¨€ï¼Œä¹Ÿæ˜¯å…¶åº•å±‚æ¶ˆæ¯äº¤æ¢ç»“æ„ã€‚é€šè¿‡gRPCï¼Œä¸€ä¸ªå®¢æˆ·ç«¯å¯ä»¥åƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·è°ƒç”¨æœåŠ¡ç«¯åº”ç”¨çš„æ–¹æ³•ã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å¯ä»¥åœ¨å¤šç§ä¸åŒç¯å¢ƒä¸‹äº’åŠ¨ï¼Œæ¯”å¦‚javaä½œä¸ºæœåŠ¡ç«¯è¯­è¨€ï¼Œè€Œgoã€pythonç­‰ä½œä¸ºå®¢æˆ·ç«¯è¯­è¨€ã€‚\ngRPCä½¿ç”¨protoBufä½œä¸ºç»“æ„åŒ–æ•°æ®çš„åºåˆ—ç®—æ³•ï¼Œå¯ä»¥åœ¨.protoæ–‡ä»¶ä¸­å®šä¹‰æ•°æ®ç»“æ„ï¼Œå¹¶ç”¨protocç”Ÿæˆç›®æ ‡è¯­è¨€çš„å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯ä»£ç ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œæ•°æ®è¢«å®šä¹‰ä¸ºä¸€ä¸ªmessageï¼Œå¹¶åŒ…å«ä¸€ç³»åˆ—çš„åŸŸï¼›ç”¨rpcå’Œæ–¹æ³•åï¼Œå‚æ•°ï¼Œè¿”å›å€¼æ„æˆæœåŠ¡ã€‚\n// The greeter service definition. service Greeter { // Sends a greeting rpc SayHello (HelloRequest) returns (HelloReply) {} } // The request message containing the user's name. message HelloRequest { string name = 1; } // The response message containing the greetings message HelloReply { string message = 1; } åœ¨ç”Ÿæˆå®¢æˆ·ç«¯ã€æœåŠ¡ç«¯ä»£ç åï¼Œè¿˜éœ€è¦è¿›ä¸€æ­¥å¼€å‘ä½¿ç”¨ã€‚\nstring-serviceä¾‹å­ ä¸‹é¢ä»¥ä¸€ä¸ªstring-serviceä½œä¸ºä¾‹å­ä»‹ç»ï¼Œé¦–å…ˆå®šä¹‰protoæ–‡ä»¶ï¼š\nsyntax = \u0026quot;proto3\u0026quot;; package pb; option go_package = \u0026quot;grpc-string-test/pb\u0026quot;; service StringService{ rpc Concat(StringRequest) returns (StringResponse){} rpc Diff(StringRequest) returns (StringResponse){} } message StringRequest{ string A = 1; string B = 2; } message StringResponse{ string Ret = 1; string err = 2; } proto3éœ€è¦åŠ ä¸Šoption go_package = \u0026quot;grpc-string-test/pb\u0026quot;;å‰é¢æ˜¯modelåï¼Œåé¢æ˜¯åŒ…åã€‚è¿™æ ·æ‰èƒ½ç”ŸæˆæˆåŠŸã€‚\nç¼–è¯‘ä»£ç æ˜¯ï¼š\nprotoc --go_out=. --go_opt=paths=source_relative \\ --go-grpc_out=. --go-grpc_opt=paths=source_relative \\ string.proto è¿™ä¸ªå‘½ä»¤éœ€è¦åˆ°protoæ–‡ä»¶çš„ç›®å½•æ‰§è¡Œã€‚æœ€åstring.protoæ˜¯è¦è½¬æ¢çš„protoæ–‡ä»¶åã€‚æœ€åä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶string.pb.goå’Œstring_grpc.pb.goï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½éœ€è¦ç”¨åˆ°è¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚\nserverç«¯ ä¸ºäº†å®ç°å…·ä½“çš„Concatå’ŒDiffæ–¹æ³•ï¼Œéœ€è¦å»ºç«‹ä¸€ä¸ªç»“æ„ï¼Œå¹¶å®ç°StringServiceServeræ¥å£\nä½ é¦–å…ˆå¯ä»¥è¿™ä¹ˆåšï¼š\ntype StringService struct { pb.UnimplementedStringServiceServer } åµŒå…¥UnimplementedStringServiceServerï¼Œè¿™æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ä¸€ä¸ªç»“æ„ï¼Œè¿™æ ·å°±é»˜è®¤å®ç°äº†StringServiceServeræ¥å£ï¼Œç„¶åå†é‡å†™Concatå’ŒDiffæ–¹æ³•ï¼š\nfunc (s *StringService) Concat(ctx context.Context, req *StringRequest) (*StringResponse, error) { log.Println(req) if len(req.A)+len(req.B) \u0026gt; StrMaxSize { response := StringResponse{Ret: \u0026quot;\u0026quot;} return \u0026amp;response, nil } response := StringResponse{Ret: req.A + req.B} return \u0026amp;response, nil } func (s *StringService) Diff(ctx context.Context, req *StringRequest) (*StringResponse, error) { log.Println(req) if len(req.A) \u0026lt; 1 || len(req.B) \u0026lt; 1 { response := StringResponse{Ret: \u0026quot;\u0026quot;} return \u0026amp;response, nil } res := \u0026quot;\u0026quot; if len(req.A) \u0026gt;= len(req.B) { for _, char := range req.B { if strings.Contains(req.A, string(char)) { res = res + string(char) } } } else { for _, char := range req.A { if strings.Contains(req.B, string(char)) { res = res + string(char) } } } response := StringResponse{Ret: res} return \u0026amp;response, nil } æ³¨æ„åˆ°ä¼ å…¥å‚æ•°æ˜¯StringRequestï¼Œè¿”å›StringResponseï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„æ¶ˆæ¯ç»“æ„ã€‚\nå†™å¥½äº†ä¸šåŠ¡åˆ°åº•å¦‚ä½•å®ç°ï¼Œä¸‹é¢è¦å¼€å¯serverå¯¹ç«¯å£çš„ç›‘å¬ï¼Œæ¥å—rpcè¯·æ±‚ï¼Œæµç¨‹å¦‚ä¸‹ï¼š\nè·å–æŸç«¯å£çš„Listener æ–°å»ºgrpc.Serverå’Œä¸Šé¢æˆ‘ä»¬å®šä¹‰çš„StringService è°ƒç”¨RegisterStringServiceServerå‘grpc.Serveræ³¨å†ŒStringService å¼€å¯rpcç›‘å¬ 1 2 3 4 5 6 7 8 9 10 11 12 func main() { lis, err := net.Listen(\u0026#34;tcp\u0026#34;, \u0026#34;127.0.0.1:1234\u0026#34;) if err != nil { log.Fatalf(\u0026#34;failed to listen: %v\u0026#34;, err) } log.Println(\u0026#34;server at 127.0.0.1:1234\u0026#34;) grpcServer := grpc.NewServer() stringService := new(service.StringService) pb.RegisterStringServiceServer(grpcServer, stringService) grpcServer.Serve(lis) } clientç«¯ clientåªè¦å»ºç«‹rpcè¿æ¥ï¼Œç„¶åè°ƒç”¨æœåŠ¡å³å¯ã€‚æµç¨‹å¦‚ä¸‹ï¼š\ngrpc.Dialæ‹¨å·å»ºç«‹rpcè¿æ¥ï¼Œè·å¾—conn ä»connè·å–stringClientï¼Œè¿™ä¸ªå˜é‡å®ç°çš„æ¥å£åŒ…å«æ‰€æœ‰æä¾›çš„æœåŠ¡ ç”±stringClientè°ƒç”¨å„ç§æœåŠ¡ æ³¨æ„ä¼ å…¥å‚æ•°æ˜¯æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„StringRequestï¼Œè¿”å›StringResponseï¼Œéå¸¸å®Œç¾\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 func main() { serviceAddress := \u0026#34;127.0.0.1:1234\u0026#34; conn, err := grpc.Dial(serviceAddress, grpc.WithInsecure()) if err != nil { panic(\u0026#34;connect error\u0026#34;) } defer conn.Close() stringClient := pb.NewStringServiceClient(conn) stringReq := \u0026amp;pb.StringRequest{A: \u0026#34;A\u0026#34;, B: \u0026#34;B\u0026#34;} reply, _ := stringClient.Concat(context.Background(), stringReq) fmt.Printf(\u0026#34;StringService Concat : %s concat %s = %s\\n\u0026#34;, stringReq.A, stringReq.B, reply.Ret) } è‡³æ­¤ï¼Œserverå’Œclientéƒ½å†™å®Œäº†ï¼Œå¼€å¯serverï¼Œç„¶åå¼€å¯clientï¼Œå°±å¯ä»¥è¿›è¡Œrpcè°ƒç”¨ã€‚\nä½¿ç”¨æµçš„string-serviceä¾‹å­ æµæŒ‡çš„æ˜¯è¯·æ±‚æ¶ˆæ¯æµæˆ–å“åº”æ¶ˆæ¯æµï¼Œæ¯ä¸ªå•ä½éƒ½æ˜¯å¯¹åº”çš„è¯·æ±‚ç»“æ„æˆ–å“åº”ç»“æ„ï¼Œå¹¶æŒç»­å‘é€ï¼Œå¥½å¤„æ˜¯å¯ä»¥è¿ç»­å‘é€ï¼Œè¿ç»­å¤„ç†ã€‚è€Œä¸æ˜¯å‘ä¸€ä¸ªè¿”å›ä¸€ä¸ªï¼Œå‘ä¸€ä¸ªè¿”å›ä¸€ä¸ªã€‚\ngrpcæ”¯æŒå•å‘æµæˆ–åŒå‘æµã€‚åœ¨protoæ–‡ä»¶ä¸­ç»™å‚æ•°æ·»åŠ streamå…³é”®å­—å°±å¯ä»¥æŒ‡æ˜è¿™æ˜¯ä»¥æµçš„å½¢å¼å‘é€çš„å‚æ•°ï¼ˆæˆ–ç»“æœï¼‰ï¼š\nservice StringService{ rpc Concat(StringRequest) returns (StringResponse){} rpc Diff(StringRequest) returns (StringResponse){} rpc ConcatServerStream(StringRequest) returns (stream StringResponse){} rpc ConcatClientStream(stream StringRequest) returns (StringResponse){} rpc ConcatDoubleStream(stream StringRequest) returns (stream StringResponse){} } serverå‘æµ è¿™æŒ‡çš„æ˜¯ï¼Œå®¢æˆ·ç«¯å‘ä¸€ä¸ªreqï¼ŒæœåŠ¡ç«¯æµè¿”å›resï¼Œå®¢æˆ·ç«¯è¯»å–resæµã€‚æˆ‘ä»¬è¦å…³æ³¨çš„å°±æ˜¯clientè°ƒç”¨æœåŠ¡ï¼Œæ¥å—æµè¯·æ±‚çš„è¿‡ç¨‹ï¼›å’ŒæœåŠ¡ç«¯å‘é€æµçš„å†™æ³•ã€‚\n//client func streamServerConn(stringClient pb.StringServiceClient) { stringReq := \u0026amp;pb.StringRequest{A: \u0026quot;A\u0026quot;, B: \u0026quot;B\u0026quot;} //æ¥å—æµ stream, _ := stringClient.ConcatServerStream(context.Background(), stringReq) //å¾ªç¯è¯»å–æµ for { item, err := stream.Recv() if err == io.EOF { break } if err != nil { log.Println(\u0026quot;fail to recv:\u0026quot;, err) } fmt.Printf(\u0026quot;StringService Concat : %s concat %s = %s\\n\u0026quot;, stringReq.A, stringReq.B, item.Ret) } } //server func (s *StringService) ConcatServerStream(req *StringRequest, qs StringService_ConcatServerStreamServer) error { response := StringResponse{Ret: req.A + req.B} for i := 0; i \u0026lt; 10; i++ { qs.Send(\u0026amp;response) } return nil } clientå‘æµ //client func streamClientConn(stringClient pb.StringServiceClient) { stream, err := stringClient.ConcatClientStream(context.Background()) //æµå¼å‘é€requset for i := 0; i \u0026lt; 10; i++ { if err != nil { log.Println(\u0026quot;fail to call:\u0026quot;, err) break } stream.Send(\u0026amp;pb.StringRequest{A: strconv.Itoa(i), B: strconv.Itoa(i + 1)}) } //å‘å®Œåè¯»å–ä¸€ä¸ªresponse recv, err := stream.CloseAndRecv() if err != nil { log.Println(\u0026quot;fail to recv:\u0026quot;, err) } fmt.Printf(\u0026quot;Ret is %s\\n\u0026quot;, recv.Ret) } //server func (s *StringService) ConcatClientStream(qs StringService_ConcatClientStreamServer) error { var params []string for { item, err := qs.Recv() //å®¢æˆ·ç«¯å‘å®Œäº†ï¼ŒæœåŠ¡å™¨æ‰å¤„ç†å¹¶è¿”å›ä¸€ä¸ªresponse if err == io.EOF { qs.SendAndClose(\u0026amp;StringResponse{Ret: strings.Join(params, \u0026quot;\u0026quot;)}) return nil } if err != nil { log.Println(\u0026quot;fail to recv:\u0026quot;, err) return err } params = append(params, item.A, item.B) } } åŒå‘æµ //client func doubleStreamConn(stringClient pb.StringServiceClient) { stream, _ := stringClient.ConcatDoubleStream(context.Background()) var i int for { err := stream.Send(\u0026amp;pb.StringRequest{A: strconv.Itoa(i), B: strconv.Itoa(i + 1)}) if err != nil { log.Println(\u0026quot;fail to send:\u0026quot;, err) break } recv, err := stream.Recv() if err != nil { log.Println(\u0026quot;fail to recv:\u0026quot;, err) break } fmt.Printf(\u0026quot;Ret is %s\\n\u0026quot;, recv.Ret) i++ time.Sleep(time.Second) } } //server func (s *StringService) ConcatDoubleStream(qs StringService_ConcatDoubleStreamServer) error { for { in, err := qs.Recv() if err == io.EOF { return nil } if err != nil { log.Println(\u0026quot;fail to recv:\u0026quot;, err) return err } qs.Send(\u0026amp;StringResponse{Ret: in.A + in.B}) } } æ€»ç»“ æµä¼ è¾“ï¼š\nå‘é€ä¸€ä¸ªmessageï¼šstream.send() æ¥å—ä¸€ä¸ªmessageï¼šstream.recv() å‘é€ä¸€ä¸ªmsgï¼Œå¹¶å…³é—­ï¼šstream.SendAndClose() æ¥å—ä¸€ä¸ªmsgï¼Œå¹¶å…³é—­ï¼šstream.CloseAndRecv() åˆ¤æ–­æµæ˜¯å¦ç»“æŸï¼šerr == io.EOF ","date":"2023-02-28T11:28:33+08:00","permalink":"https://chajiuqqq.github.io/blogs/p/%E4%BB%8B%E7%BB%8D%E4%B8%80%E4%B8%8Bgrpc%E7%9A%84%E4%BD%BF%E7%94%A8/","title":"ä»‹ç»ä¸€ä¸‹grpcçš„ä½¿ç”¨"},{"content":"æœ¬æ–‡ä½¿ç”¨go rpcåº“å®ç°æœåŠ¡çš„åˆ›å»ºã€å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚\nserveræä¾›å­—ç¬¦ä¸²æ‹¼æ¥å’Œå­—ç¬¦ä¸²åŒºåˆ«çš„æœåŠ¡ï¼Œè¿è¡Œåœ¨127.0.0.1:1234ã€‚clientå¯ä»¥è°ƒç”¨rpcå‘é€è¯·æ±‚ï¼Œè°ƒç”¨serverä¸Šçš„æœåŠ¡ï¼Œå¹¶è·å–åˆ°ç»“æœã€‚\næ³¨æ„ç‚¹ï¼š\nclientå’Œserveréƒ½è¦ç»´æŠ¤è¯·æ±‚å‚æ•°ç»“æ„å’Œå“åº”å‚æ•°ç»“æ„ï¼Œå¦‚æ‹¼æ¥å­—ç¬¦ä¸²çš„è¯·æ±‚å‚æ•°ï¼š\ntype StringRequest struct { A string B string } å“åº”ç»“æ„è¿™é‡Œç”¨stringå³å¯ï¼Œæ‰€ä»¥æ²¡æœ‰ä¸“é—¨å®šä¹‰ç»“æ„ã€‚\nclientè°ƒç”¨Callæˆ–Goæ–¹æ³•ï¼Œä¼ å…¥è¿œç¨‹æ–¹æ³•åï¼ˆç»“æ„+æ–¹æ³•ï¼Œå¦‚StringService.Concatï¼‰ã€è¯·æ±‚ç»“æ„ã€å“åº”ç»“æ„çš„æŒ‡é’ˆï¼Œç­‰å¾…ç»“æœå®Œæˆå³å¯ã€‚\nç»“æœï¼š\nserverè¿è¡Œï¼š\ngo build \u0026amp;\u0026amp; ./rpc-server 2023/02/25 13:11:20 server at 127.0.0.1:1234 è¿è¡Œclientï¼š\ngo build \u0026amp;\u0026amp; ./rpc-client StringService Concat : A concat B = AB StringService Diff : ABC diff BCD = BC server StringServiceæ˜¯å®ç°äº†Serviceæ¥å£çš„ç»“æ„ã€‚\nserver.go package service import ( \u0026quot;errors\u0026quot; \u0026quot;strings\u0026quot; ) type StringRequest struct{ A string B string } type Service interface { Concat(req StringRequest, ret *string) error Diff(req StringRequest, ret *string) error } type StringService struct { } const ( StrMaxSize = 1024 ) var ( ErrMaxSize = errors.New(\u0026quot;over max size of 1024\u0026quot;) ErrStrValue = errors.New(\u0026quot;maximum size of 1024 bytes exceeded\u0026quot;) ) func (s StringService) Concat(req StringRequest, ret *string) error { if len(req.A)+len(req.B) \u0026gt; StrMaxSize { *ret = \u0026quot;\u0026quot; return ErrMaxSize } *ret = req.A + req.B return nil } func (s StringService) Diff(req StringRequest, ret *string) error { if len(req.A) \u0026lt; 1 || len(req.B) \u0026lt; 1 { *ret = \u0026quot;\u0026quot; return nil } res := \u0026quot;\u0026quot; if len(req.A) \u0026gt;= len(req.B) { for _, char := range req.B { if strings.Contains(req.A, string(char)) { res = res + string(char) } } } else { for _, char := range req.A { if strings.Contains(req.B, string(char)) { res = res + string(char) } } } *ret = res return nil } main.go package main import ( \u0026quot;log\u0026quot; \u0026quot;net\u0026quot; \u0026quot;net/http\u0026quot; \u0026quot;net/rpc\u0026quot; \u0026quot;rpc-server/service\u0026quot; ) func main() { stringService := new(service.StringService) rpc.Register(stringService) rpc.HandleHTTP() l, e := net.Listen(\u0026quot;tcp\u0026quot;, \u0026quot;127.0.0.1:1234\u0026quot;) if e != nil { log.Fatal(\u0026quot;listen error,\u0026quot;, e) } log.Println(\u0026quot;server at 127.0.0.1:1234\u0026quot;) http.Serve(l, nil) } Client server.go package service type StringRequest struct { A string B string } main.go package main import ( \u0026quot;fmt\u0026quot; \u0026quot;log\u0026quot; \u0026quot;net/rpc\u0026quot; \u0026quot;rpc-client/service\u0026quot; ) func main() { client, err := rpc.DialHTTP(\u0026quot;tcp\u0026quot;, \u0026quot;127.0.0.1:1234\u0026quot;) if err != nil { log.Fatal(\u0026quot;dialing:\u0026quot;, err) } stringReq := \u0026amp;service.StringRequest{\u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;} var reply string err = client.Call(\u0026quot;StringService.Concat\u0026quot;, stringReq, \u0026amp;reply) if err != nil { log.Fatal(\u0026quot;Concat err:\u0026quot;, err) } fmt.Printf(\u0026quot;StringService Concat : %s concat %s = %s\\n\u0026quot;, stringReq.A, stringReq.B, reply) stringReq = \u0026amp;service.StringRequest{\u0026quot;ABC\u0026quot;, \u0026quot;BCD\u0026quot;} call := client.Go(\u0026quot;StringService.Diff\u0026quot;, stringReq, \u0026amp;reply, nil) _ = \u0026lt;-call.Done fmt.Printf(\u0026quot;StringService Diff : %s diff %s = %s\\n\u0026quot;, stringReq.A, stringReq.B, reply) } ","date":"2023-02-25T13:14:03+08:00","permalink":"https://chajiuqqq.github.io/blogs/p/%E4%B8%80%E4%B8%AA%E4%BD%BF%E7%94%A8go-rpc%E5%BA%93%E5%AE%9E%E7%8E%B0%E7%9A%84rpc%E4%BE%8B%E5%AD%90/","title":"ä¸€ä¸ªä½¿ç”¨Go Rpcåº“å®ç°çš„RPCä¾‹å­"},{"content":" å¦‚ä½•è¯»å–æ¨¡ç‰ˆå¹¶è¿”å›HTML templateé‡Œçš„åŠ¨ä½œ 1. æ¡ä»¶åŠ¨ä½œ 2. è¿­ä»£åŠ¨ä½œ 3. è®¾ç½®åŠ¨ä½œ 4. åŒ…å«åŠ¨ä½œ å‚æ•° å˜é‡ ç®¡é“ å‡½æ•° ä¸Šä¸‹æ–‡æ„ŸçŸ¥ å–æ¶ˆHTMLè½¬ä¹‰ åµŒå¥—æ¨¡æ¿ å—æ¨¡æ¿ å¦‚ä½•è¯»å–æ¨¡ç‰ˆå¹¶è¿”å›HTML æ¨¡ç‰ˆä¸­çš„åŠ¨ä½œé»˜è®¤ä½¿ç”¨{{å’Œ}}åŒ…å›´ï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œä¿®æ”¹ç•Œå®šç¬¦ã€‚{{.}}æŒ‡çš„æ˜¯ç”¨ä¼ å…¥çš„å€¼æ›¿æ¢è¿™ä¸ªåŠ¨ä½œæœ¬èº«ã€‚\ngo webçš„æ¨¡ç‰ˆå¼•æ“ä½¿ç”¨æ–¹æ³•åˆ†ä¸ºä»¥ä¸‹ä¸¤ä¸ªæ­¥éª¤ï¼š\nè¯»å–æ–‡æœ¬æ¨¡ç‰ˆæ–‡ä»¶ï¼ˆæˆ–ä¸€ä¸ªæ¨¡ç‰ˆå­—ç¬¦ä¸²ï¼‰ï¼Œè¿›è¡Œè¯­æ³•åˆ†æï¼Œåˆ›å»ºä¸€ä¸ªæ¨¡ç‰ˆç»“æ„ã€‚ å°†æ•°æ®ä¼ å…¥ï¼Œæ‰§è¡Œæ¨¡ç‰ˆï¼Œç”ŸæˆHTMLã€‚ ç¬¬ä¸€ä¸ªæ­¥éª¤ï¼š\n//ä»æ–‡ä»¶ä¸­ç”Ÿæˆæ¨¡ç‰ˆ t,_ := template.ParseFiles(\u0026quot;index.html\u0026quot;) //è¯»å–å¤šä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯åªç”Ÿæˆç¬¬ä¸€ä¸ªæ–‡ä»¶çš„æ¨¡æ¿ï¼ˆå› ä¸ºç¬¬ä¸€ä¸ªæ¨¡ç‰ˆå¯èƒ½è°ƒç”¨å…¶ä»–æ¨¡ç‰ˆï¼‰ t,_ := template.ParseFiles(\u0026quot;index.html\u0026quot;,\u0026quot;content.html\u0026quot;,\u0026quot;navbar.html\u0026quot;) //ä»å­—ç¬¦ä¸²ä¸­ç”Ÿæˆæ¨¡ç‰ˆ tmpl := `...` t := template.New(\u0026quot;tmpl.html\u0026quot;) t,_ = t.Parse(tmpl) ç¬¬äºŒä¸ªæ­¥éª¤ï¼š\n// t.Executeç¬¬ä¸€ä¸ªå‚æ•°æ˜¯io.Writerï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¼ å…¥çš„æ•°æ®ã€‚è¿™ä¸ªæ–¹æ³•åªä¼šæ‰§è¡Œç¬¬ä¸€ä¸ªæ¨¡ç‰ˆï¼Œä¹Ÿå°±æ˜¯index.html t,_ := template.ParseFiles(\u0026quot;index.html\u0026quot;,\u0026quot;content.html\u0026quot;,\u0026quot;navbar.html\u0026quot;) t.Execute(w,\u0026quot;hello world\u0026quot;) //å¦‚æœæƒ³è¦æ‰§è¡Œå…¶ä»–æ¨¡æ¿ï¼Œç”¨t.ExecuteTemplate,å¹¶åœ¨ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šæ¨¡ç‰ˆåç§° t,_ := template.ParseFiles(\u0026quot;index.html\u0026quot;,\u0026quot;content.html\u0026quot;,\u0026quot;navbar.html\u0026quot;) t.ExecuteTemplate(w,\u0026quot;content.html\u0026quot;,\u0026quot;hello world\u0026quot;) å¦‚æœä½ åªæ˜¯åœ¨htmlä¸­åŠ å…¥ä¸€äº›{{.}}çš„æŒ‡ä»¤ï¼Œæ¨¡æ¿çš„åç§°å’Œæ–‡ä»¶åç§°ä¸€æ ·ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é‡æ–°å®šä¹‰æ¨¡ç‰ˆçš„åå­—ï¼Œæˆ–åœ¨ä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶ä¸­å®šä¹‰å¤šä¸ªæ¨¡æ¿ã€‚\næ³¨æ„ä¼ å…¥çš„æ•°æ®å»ºè®®æ˜¯æŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯åŠ ä¸Šæ•°æ®çš„å¼•ç”¨ã€‚å¹¶ä¸”åœ¨tmplé‡Œè°ƒç”¨funcæ—¶ï¼Œä¸ä¼šè‡ªåŠ¨æŠŠx.fieldè½¬ä¸º(\u0026amp;x).fieldï¼Œæ‰€ä»¥å¦‚æœä½ å®šäº†ä¸€ä¸ªç»“æ„çš„æŒ‡é’ˆæ¥å—è€…æ–¹æ³•ï¼Œè€Œä¼ å…¥tmplä¸€ä¸ªå€¼çš„æ•°æ®ï¼Œé‚£ä¹ˆæ— æ³•è°ƒç”¨è¯¥æ–¹æ³•ã€‚ä¼šæç¤ºåœ¨è¯¥ç±»å‹ä¸­æ‰¾ä¸åˆ°è¯¥æ–¹æ³•ã€‚\n//t.ExecuteTemplate(w,\u0026quot;content.html\u0026quot;,Thread{}) t.ExecuteTemplate(w,\u0026quot;content.html\u0026quot;,\u0026amp;Thread{}) å†…åµŒçš„fieldå¯ä»¥ç›´æ¥é€šè¿‡.è°ƒç”¨ï¼Œæ¯”å¦‚å®šä¹‰Peopleå’ŒUserï¼š\ntype People struct{ Name string } type User struct{ People Username string Pwd string } åœ¨tmplä¸­ï¼Œä¼ å…¥userï¼Œå¦‚æœç›´æ¥ {{.Name}}æ˜¯å¯ä»¥è·å–çš„ã€‚\nè®²äº†è¿™ä¹ˆå¤šè¿˜ä¸çŸ¥é“æ¨¡ç‰ˆæ–‡ä»¶æ€ä¹ˆå†™å‘¢ã€‚ä¸‹é¢è®²è®²åŠ¨ä½œè¯­æ³•ã€‚\ntemplateé‡Œçš„åŠ¨ä½œ å¦‚æœè¦è®¿é—®ç»“æ„é‡Œçš„fieldï¼Œç”¨ï¼š{{ .Name }}ï¼Œæˆ– {{ .User.Name }}\n1. æ¡ä»¶åŠ¨ä½œ æ¥å—trueæˆ–falseï¼Œä»è€Œå†³å®šæ‰§è¡Œï¼ˆæ˜¾ç¤ºï¼‰å“ªæ¡è¯­å¥ã€‚ä¸‹é¢å¦‚æœä¼ å…¥trueï¼Œåˆ™ä¼šæ˜¾ç¤ºcontent1è¯­å¥ã€‚\n{{ if . }} content1 {{ else }} content2 {{ end }} 2. è¿­ä»£åŠ¨ä½œ å¯å¯¹ä¼ å…¥çš„æ•°ç»„ã€åˆ‡ç‰‡ã€æ˜ å°„ã€æˆ–é€šé“è¿›è¡Œè¿­ä»£ï¼Œè¿­ä»£é‡Œï¼Œ.ä¼šè¢«è®¾ç½®ä¸ºå½“å‰è¿­ä»£çš„å…ƒç´ .elseç”¨äºå½“è¿­ä»£çš„ç»“æ„ä¸ºç©ºæˆ–nilæ—¶æ˜¾ç¤ºå¤‡é€‰ç»“æœã€‚\n{{ range . }} \u0026lt;li\u0026gt;The Elem: {{ . }} \u0026lt;/li\u0026gt; {{ end }} {{ range . }} \u0026lt;li\u0026gt;The Elem: {{ . }} \u0026lt;/li\u0026gt; {{ else }} \u0026lt;li\u0026gt; No elems. \u0026lt;/li\u0026gt; {{ end }} 3. è®¾ç½®åŠ¨ä½œ ç±»ä¼¼ifï¼Œ{{if pipeline}} T1 {{end}},å¦‚æœpipelineä¸ºç©ºï¼ˆfalseï¼Œ0ï¼Œnilï¼Œç©ºçš„array, slice, map,stringï¼‰ï¼Œåˆ™æ‰§è¡ŒT0ï¼Œå¦åˆ™æ‰§è¡ŒT1.åŒæ—¶withé‡Œé¢{{.}}ä¼šè¢«è®¾ç½®ä¸ºpipelineçš„å€¼ã€‚è¿™æ˜¯å’Œifå”¯ä¸€çš„åŒºåˆ«ã€‚\n{{with pipeline}} T1 {{end}} {{with pipeline}} T1 {{else}} T0 {{end}} å¯ä»¥ç”¨æ¥åˆ¤æ–­å½“æŸä¸ªé›†åˆä¸ºç©ºæ—¶ï¼Œæ˜¾ç¤ºxxxè¯ã€‚å½“ä¸ä¸ºç©ºæ—¶ï¼Œåœ¨withé‡Œç”¨dotæ˜¾ç¤ºè¿™ä¸ªé›†åˆé‡Œçš„ä¸œè¥¿ã€‚\n4. åŒ…å«åŠ¨ä½œ å¯ä»¥åœ¨ä¸€ä¸ªæ¨¡æ¿é‡ŒåŒ…å«å¦ä¸€ä¸ªæ¨¡æ¿ï¼Œç”¨åˆ°{{ template \u0026quot;name\u0026quot; }},æˆ–{{template \u0026quot;name\u0026quot; pipeline}}\nç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ¨¡æ¿çš„åå­—ï¼ˆå¦‚æœæ²¡å®šä¹‰ï¼Œé‚£å°±æ˜¯æ¨¡æ¿æ–‡ä»¶åç§°ï¼‰ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¦ä¼ ç»™è¿™ä¸‹ä¸€ä¸ªæ¨¡æ¿çš„å‚æ•°ã€‚\né€šå¸¸è¿™ä¹ˆç”¨ï¼š{{template \u0026quot;name\u0026quot; . }}\nå‚æ•° ä¸Šè¿°çš„ifåè¾¹è·Ÿçš„å°±æ˜¯argå‚æ•°ï¼Œè¿™è¾¹ä¼ äº†dotè¿‡å»ã€‚\n{{ if . }} content1 {{ else }} content2 {{ end }} argå¯ä»¥æ˜¯ä¸€ä¸ªå€¼ï¼Œä¸€ä¸ªå˜é‡ï¼Œæˆ–ä¸€ä¸ªè¿”å›ä¸€ä¸ªå€¼çš„å‡½æ•°ã€‚\nå¦‚ï¼š\n{{ if . }} content1 {{ end }} {{ if $key }} content1 {{ end }} {{ if .IsExist }} content1 {{ end }} å˜é‡ å¯ä»¥åœ¨åŠ¨ä½œä¸­è®¾ç½®å˜é‡ï¼š$key := something,å¦‚ï¼š\n{{ range $key, $value := . }} \u0026lt;li\u0026gt;{{ $key }} : {{ $value }} \u0026lt;/li\u0026gt; {{ end }} ç®¡é“ ç®¡é“å¯ä»¥ä¸²è”å‚æ•°å’Œå‡½æ•°ã€æ–¹æ³•ã€‚å¦‚\n{{ p1 | p2 | p3 }} è¿™ä¸‰è€…éƒ½æ˜¯å‚æ•°ã€‚\n{{ 123.456 | printf \u0026quot;%.2f\u0026quot; }} å°†123.456ä¼ ç»™æ¨¡æ¿å†…ç½®printfå‡½æ•°\nå½“ç„¶å‡½æ•°ä¹Ÿå¯ä»¥é€šè¿‡åç½®å‚æ•°è°ƒç”¨ï¼š\n{{ printf \u0026quot;%.2f\u0026quot; 123.456 }} å‡½æ•° æ¨¡æ¿å¼•æ“é‡Œçš„å†…ç½®å‡½æ•°è™½ç„¶å¯ä»¥æ¥å—å¤šä¸ªå‚æ•°ï¼Œä½†æ˜¯åªèƒ½è¿”å›ä¸€ä¸ªå€¼ï¼Œæˆ–è¿”å›ä¸€ä¸ªå€¼+ä¸€ä¸ªé”™è¯¯ã€‚å†…ç½®å‡½æ•°åˆ—è¡¨è§ https://pkg.go.dev/text/template#hdr-Functions\nç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰å‡½æ•°å¹¶ä¼ å…¥æ¨¡æ¿ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š\nåˆ›å»ºä¸€ä¸ªFuncMapï¼Œå¹¶ä¼ å…¥å‡½æ•°åç§°ï¼šçœŸçš„å‡½æ•°åï¼Œåé¢æ¨¡æ¿é‡Œå°±ç”¨å‡½æ•°åç§°è¿›è¡Œè°ƒç”¨ å°†FuncMapå’Œæ¨¡æ¿ç»‘å®š è°ƒç”¨ï¼š\n{{ . | fdate }} æˆ– {{ fdate . }} è¿˜æœ‰äº›å‚æ•°ã€å˜é‡ã€ç®¡é“å’Œå‡½æ•°è¿™é‡Œå…ˆç•¥è¿‡ã€‚\nä¸Šä¸‹æ–‡æ„ŸçŸ¥ goæ¨¡æ¿é‡ŒåŠ¨ä½œçš„è¾“å‡ºä¼šæ ¹æ®æ‰€å¤„çš„ä¸Šä¸‹æ–‡æ”¹å˜è¾“å‡ºå½¢æ€ï¼Œå¦‚\n{{ . }}åœ¨HTMLå¤„ï¼Œä¼šå°†è¾“å‡ºè¿›è¡Œhtmlè½¬è¯‘åè¾“å‡º {{ . }}åœ¨hrefæˆ–srcå¤„ï¼Œä¼šå°†è¾“å‡ºè¿›è¡ŒURLè½¬è¯‘åè¾“å‡º è¿™ä¸»è¦ç”¨äºå®ç°è‡ªåŠ¨é˜²å¾¡ç¼–ç¨‹ï¼Œå¯ä»¥æŠµå¾¡XSSæ”»å‡»ã€‚\nå–æ¶ˆHTMLè½¬ä¹‰ ä½¿ç”¨template.HTML()åŒ…è£¹å€¼å¹¶ä¼ å…¥æ¨¡æ¿å³å¯ã€‚å¦‚template.HTML(r.FormValue(\u0026quot;comment\u0026quot;))\nåµŒå¥—æ¨¡æ¿ é€šå¸¸æˆ‘ä»¬ä¼šåœ¨ç½‘ç«™å¼€å‘ä¸­å¤ç”¨æŸå¥—layoutï¼Œå¦‚æœ‰å¯¼èˆªæ ï¼ŒæœåŠ¡å™¨çŠ¶æ€ï¼Œç‰ˆæƒå£°æ˜ã€‚ç„¶åä¸­é—´æ˜¯å±•ç¤ºçš„å†…å®¹ã€‚å¦‚æœè¦å®ç°å†…å®¹æ›¿æ¢è€Œå…¶ä»–ä¸œè¥¿å¤ç”¨ï¼Œæˆ‘ä»¬å°±ä¸èƒ½ä½¿ç”¨é»˜è®¤çš„æ¨¡æ¿åå­—ã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªlauout.html\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt; \u0026lt;meta http-equiv=\u0026quot;X-UA-Compatible\u0026quot; content=\u0026quot;IE=9\u0026quot;\u0026gt; \u0026lt;meta name=\u0026quot;viewport\u0026quot; content=\u0026quot;width=device-width, initial-scale=1\u0026quot;\u0026gt; \u0026lt;title\u0026gt;ChitChat\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; {{ template \u0026quot;content.html\u0026quot; }} \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; è¿™é‡ŒåµŒå¥—äº†\u0026quot;content.html\u0026quot;æ¨¡æ¿ã€‚é—®é¢˜æ˜¯åªæœ‰å”¯ä¸€ä¸€ä¸ª\u0026quot;content.html\u0026quot;ï¼Œè¿™ä¹ˆå†™é™¤äº†æŠŠä¸€ä¸ªæ–‡ä»¶æ‹†æˆä¸¤ä¸ªæ–‡ä»¶ï¼Œæ— æ³•å¤ç”¨layout.htmlã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥å®šä¹‰æ¨¡æ¿åç§°ï¼Œè€Œä¸æ˜¯ç”¨é»˜è®¤çš„æ–‡ä»¶åï¼š\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt; \u0026lt;meta http-equiv=\u0026quot;X-UA-Compatible\u0026quot; content=\u0026quot;IE=9\u0026quot;\u0026gt; \u0026lt;meta name=\u0026quot;viewport\u0026quot; content=\u0026quot;width=device-width, initial-scale=1\u0026quot;\u0026gt; \u0026lt;title\u0026gt;ChitChat\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; {{ template \u0026quot;content\u0026quot; }} \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; ç„¶ååœ¨index.htmlä¸­å®šä¹‰ä¸€ä¸ªæ¨¡æ¿ä¸ºcontentï¼š\n{{ define \u0026quot;content\u0026quot; }} \u0026lt;p class=\u0026quot;lead\u0026quot;\u0026gt; \u0026lt;a href=\u0026quot;/thread/new\u0026quot;\u0026gt;Start a thread\u0026lt;/a\u0026gt; or join one below! \u0026lt;/p\u0026gt; {{ end }} parseFilesæ—¶ä¼ å…¥layout.htmlå’Œindex.htmlï¼Œå°±å¯ä»¥å®ç°æ¨¡æ¿åµŒå…¥ã€‚\nåŒç†ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å®šä¹‰å¦ä¸€ä¸ªlogin.html,å¹¶åœ¨å…¶ä¸­å®šä¹‰contentï¼š\n{{ define \u0026quot;content\u0026quot; }} \u0026lt;a href=\u0026quot;/login\u0026quot;\u0026gt;Loginï¼\u0026lt;/a\u0026gt; {{ end }} parseFilesæ—¶ä¼ å…¥layout.htmlå’Œlogin.htmlï¼Œå°±å¯ä»¥å®ç°å¦ä¸€ä¸ªæ¨¡æ¿çš„åµŒå…¥ã€‚\nå¦‚æœæ¨¡æ¿åå­—ä¸åŒï¼Œä¹Ÿå¯ä»¥åœ¨åŒä¸€ä¸ªæ–‡ä»¶é‡Œå®šä¹‰å¤šä¸ªä¸åŒçš„æ¨¡æ¿ï¼›å¯ä»¥åœ¨å¤šä¸ªæ–‡ä»¶é‡Œå®šä¹‰åŒåæ¨¡æ¿ã€‚\nå—æ¨¡æ¿ è¿™æ˜¯å¦ä¸€ç§å®šä¹‰æ¨¡æ¿çš„æ–¹æ³•ã€‚ä¸»è¦ç”¨äºç›´æ¥åœ¨ä¸€ä¸ªæ¨¡æ¿ä¸­å®šä¹‰æ–°çš„æ¨¡æ¿ï¼Œå¹¶ä¸”ä½œä¸ºç¼ºçœæ¨¡æ¿ä½¿ç”¨ã€‚\n{{ define \u0026quot;layout\u0026quot; }} hello {{ block \u0026quot;content\u0026quot; . }} \u0026lt;p\u0026gt;someone!\u0026lt;/p\u0026gt; {{ end }} {{ end }} å¦‚æœåœ¨parseFilesæ—¶æ²¡æœ‰ä¼ å…¥é¢å¤–çš„contentæ¨¡æ¿ï¼Œåˆ™ä¼šä½¿ç”¨layouté‡Œå®šä¹‰çš„contentå—ä½œä¸ºç¼ºçœä½¿ç”¨ã€‚\n","date":"2023-02-23T15:24:58+08:00","permalink":"https://chajiuqqq.github.io/blogs/p/golang%E4%B8%AD%E7%9A%84template%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/","title":"Golangä¸­çš„Templateæ¨¡æ¿å¼•æ“"},{"content":"æœ¬æ–‡è®°å½•äº†ä¸€ä¸‹å†…å®¹ï¼š\ngolangçš„å•å…ƒæµ‹è¯•ã€åŸºå‡†æµ‹è¯•ã€httpæµ‹è¯• æµ‹è¯•æ›¿èº«å’Œä¾èµ–æ³¨å…¥ ç¬¬ä¸‰æ–¹Goæµ‹è¯•åº“ï¼Œgocheckï¼Œginkgo ç›®å½•ï¼š\ngoåº”ç”¨æµ‹è¯•æ¦‚è¿° å•å…ƒæµ‹è¯• è·³è¿‡æµ‹è¯•ç”¨ä¾‹ è®¾ç½®å¹¶è¡Œè¿è¡Œçš„å•å…ƒæµ‹è¯•æ•°é‡ åŸºå‡†æµ‹è¯• å¦‚ä½•æµ‹è¯•http ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼ˆæˆ‘è‡ªå·±å–çš„åå­—ï¼‰ æµ‹è¯•æ›¿èº«å’Œä¾èµ–æ³¨å…¥ ç¬¬ä¸‰æ–¹goæ£€æµ‹åº“ gocheck ginkgo goåº”ç”¨æµ‹è¯•æ¦‚è¿° goçš„testingåŒ…ç”¨äºæµ‹è¯•ï¼Œnet/http/httptestç”¨äºæµ‹è¯•webç¨‹åºã€‚å¯¹äºæºç æ–‡ä»¶server.goï¼Œå¯ä»¥åœ¨åŒç›®å½•ä¸‹åˆ›å»ºserver_test.goæ–‡ä»¶ï¼Œå®šä¹‰func TestXxx(*testing.T)å‡½æ•°ã€‚å‡½æ•°å†…éƒ¨ä½¿ç”¨Errorã€Failç­‰æ–¹æ³•è¡¨ç¤ºæµ‹è¯•å¤±è´¥ï¼Œå¦‚æœæµ‹è¯•æ—¶æ²¡æœ‰å‡ºç°ä»»ä½•å¤±è´¥ï¼Œåˆ™è¡¨ç¤ºæµ‹è¯•é€šè¿‡ã€‚\nç¼–å†™å®Œæµ‹è¯•æ–‡ä»¶åï¼Œåœ¨å½“å‰ç›®å½•ä¸‹ç”¨go testæµ‹è¯•æ‰€æœ‰æµ‹è¯•æ–‡ä»¶ã€‚\nå•å…ƒæµ‹è¯• å¦‚æœä¸€ä¸ªéƒ¨åˆ†èƒ½ç‹¬ç«‹è¿›è¡Œæµ‹è¯•ï¼Œé‚£è¢«ç§°ä¸ºâ€œå•å…ƒâ€ã€‚å‘å•å…ƒè¾“å…¥æ•°æ®ï¼Œå¹¶æ£€æŸ¥è¾“å‡ºæ˜¯å¦ç¬¦åˆé¢„æœŸå°±æ˜¯å•å…ƒæµ‹è¯•ã€‚\ntesting.Tä¸­çš„æœ‰ç”¨çš„æ–¹æ³•ï¼š\nLogï¼ŒLogfï¼šæŠŠæ–‡æœ¬è®°å½•åˆ°é”™è¯¯æ—¥å¿—ä¸­ï¼Œä¸ç»ˆæ­¢æµ‹è¯• Failï¼šæ ‡è®°å½“å‰æµ‹è¯•å•å…ƒâ€œå¤±è´¥â€ FailNowï¼šæ ‡è®°å½“å‰æµ‹è¯•å‡½æ•°â€œå¤±è´¥â€ï¼Œå¹¶ç»ˆæ­¢å½“å‰æµ‹è¯•å•å…ƒ Error,Errorf,Fatal,Fatalfæ˜¯ä¸Šè¿°å‡½æ•°çš„å¤åˆï¼Œè§ä¸‹è¡¨ã€‚\nLog Logf Fail Error Errorf FailNow Fatal Fatalf è¿™äº›æ–¹æ³•åªå¯¹å½“å‰å•å…ƒæœ‰æ•ˆã€‚\nå•å…ƒæµ‹è¯•ä¸­çš„å‘½ä»¤ï¼š\n-vè·å–è¯¦ç»†æµ‹è¯•ä¿¡æ¯ -coverè¾“å‡ºä»£ç è¦†ç›–ç‡ å¦‚go test -v -cover\nè·³è¿‡æµ‹è¯•ç”¨ä¾‹ å¦‚æœåœ¨å•å…ƒæµ‹è¯•ä¸­è°ƒç”¨t.Skip()å‡½æ•°ï¼Œåˆ™ä¼šåœ¨æ‰§è¡Œåˆ°è¿™ä¸€è¡Œæ—¶è·³è¿‡è¯¥æµ‹è¯•å•å…ƒçš„å…¶ä½™éƒ¨åˆ†ã€‚\nå‘½ä»¤ä¸­ä¹Ÿæä¾›è¿™ä¹ˆä¸ªflagï¼Œç”¨äºé€»è¾‘åˆ¤æ–­ï¼š-shortï¼Œå½“è®¾ç½®äº†-shortæ—¶ï¼ˆå¦‚go test -v -cover -shortï¼‰ï¼Œä»£ç ä¸­è°ƒç”¨testing.Short()è¿”å›true.\nå°†-shortå’Œt.Skip()ç»“åˆä½¿ç”¨ï¼Œå¯å®ç°å‘½ä»¤è¡Œæ§åˆ¶æ˜¯å¦è·³è¿‡æŸäº›æµ‹è¯•å‡½æ•°ï¼Œå¦‚ï¼š\nfunc TestXxxx(t *testing.T){ if testing.Short(){ t.Skip(\u0026quot;skip for short flag.\u0026quot;) } ... } è®¾ç½®å¹¶è¡Œè¿è¡Œçš„å•å…ƒæµ‹è¯•æ•°é‡ åˆ©ç”¨-parallel nè®¾ç½®å¹¶è¡Œè¿è¡Œçš„å•å…ƒæµ‹è¯•æ•°é‡ã€‚å¦‚go test -v -parallel 3è¡¨ç¤ºæœ€å¤šå¹¶è¡Œè¿è¡Œ3ä¸ªå•å…ƒæµ‹è¯•ã€‚\nåŸºå‡†æµ‹è¯• åˆ©ç”¨-bench [å‡½æ•°åçš„æ­£åˆ™è¡¨è¾¾å¼]flagï¼Œæ‰§è¡Œ*_test.goä¸­å®šä¹‰çš„åŸºå‡†å‡½æ•°çš„æµ‹è¯•ï¼Œç”¨äºè¯„ä¼°å‡½æ•°çš„æ€§èƒ½ã€‚åŸºå‡†å‡½æ•°æ ¼å¼ï¼š\nfunc BenchmarkXxx(*testing.B){...} é€šå¸¸åœ¨å…¶ä¸­æ·»åŠ å¾ªç¯ï¼Œæ‰§è¡Œb.Næ¬¡ç¨‹åºï¼Œä»¥æ­¤è§‚å¯Ÿç¨‹åºæ€§èƒ½ï¼š\nfunc BenchmarkXxx(b *testing.B){ for i:=0;i\u0026lt;b.N;i++{ ... } } æ‰§è¡Œæ‰€æœ‰å•å…ƒæµ‹è¯•å’ŒåŸºå‡†å‡½æ•°ï¼šgo test -v -bench .\nå¦‚è¦å¿½ç•¥å•å…ƒæµ‹è¯•ï¼Œä½¿ç”¨-run [å‡½æ•°åçš„æ­£åˆ™è¡¨è¾¾å¼]æ¥æŒ‡å®šè¦è¿è¡Œçš„å•å…ƒæµ‹è¯•ã€‚è®¾ç½®ä¸º-run noneåˆ™ä¼šå¿½ç•¥æ‰€æœ‰å•å…ƒæµ‹è¯•ã€‚ç»“åˆä¸€ä¸‹ï¼Œgo test -v -run none -bench .å°±åªä¼šæ‰§è¡ŒåŸºå‡†æµ‹è¯•äº†ã€‚\nå¦‚ä½•æµ‹è¯•http æµ‹è¯•httpå°±æ˜¯åœ¨æµ‹è¯•å¤„ç†å™¨å‡½æ•°ï¼Œè¿™ç§å‡½æ•°æ¥å—http.ResponseWriterå’Œ*http.Request.é—®é¢˜åœ¨äºå¦‚ä½•æä¾›è¿™ä¸¤ä¸ªå‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥åœ¨æµ‹è¯•å‡½æ•°ä¸­ä¼ªé€ http serverã€httpè¯·æ±‚ï¼Œå¹¶æŠŠresponseè®°å½•ä¸‹æ¥ï¼Œå®ç°ä¼ªé€ httpæ•´ä¸ªæµç¨‹ï¼Œä»è€Œå®ç°æµ‹è¯•ã€‚\nä¸‹é¢ä»£ç å®ç°äº†å¯¹å¤„ç†å™¨å‡½æ•°çš„æµ‹è¯•ï¼š\nä¼ªé€ ä¸€ä¸ªhttp server æŒ‡å®šè¦æµ‹è¯•çš„å¤„ç†å™¨å‡½æ•°å’Œè·¯å¾„ ä¼ªé€ GETè¯·æ±‚ æŠŠresponseè®°å½•åœ¨httptest.ResponseRecorderä¸­ è¯»å–responseï¼Œçœ‹ç¨‹åºæ˜¯å¦ç¬¦åˆé¢„æœŸ func TestHandleGet(t *testing.T) { mux := http.NewServeMux() mux.HandleFunc(\u0026quot;/post/\u0026quot;, handleRequest) writer := httptest.NewRecorder() req, _ := http.NewRequest(\u0026quot;GET\u0026quot;, \u0026quot;/post/1\u0026quot;, nil) mux.ServeHTTP(writer, req) if writer.Code != 200 { t.Errorf(\u0026quot;response code is %d\u0026quot;, writer.Code) } var post data.Post json.Unmarshal(writer.Body.Bytes(), \u0026amp;post) if post.Id != 1 { t.Error(\u0026quot;can't retrieve JSON post\u0026quot;) } } ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼ˆæˆ‘è‡ªå·±å–çš„åå­—ï¼‰ ä¸ºäº†åœ¨æµ‹è¯•å‰ã€æµ‹è¯•åç»Ÿä¸€æ‰§è¡Œä¸€äº›å…±æœ‰çš„ä»£ç ï¼Œå¯ä»¥åˆ©ç”¨ç”Ÿå‘½å‘¨æœŸå‡½æ•°å®ç°ã€‚é¦–å…ˆå®šä¹‰å‡½æ•°TestMain\nfunc TestMain(m *testing.M) { setUp() code := m.Run() tearDown() os.Exit(code) } setUp()å’ŒtearDown()éƒ½æ˜¯ä¸ºæ‰€æœ‰æµ‹è¯•ç”¨ä¾‹å®šä¹‰çš„å‡½æ•°ï¼Œm.Run()ä¼šè°ƒç”¨æµ‹è¯•æ¡ˆä¾‹ï¼Œæ‰€ä»¥setUp()åœ¨æµ‹è¯•å‰æ‰§è¡Œï¼ŒtearDown()åœ¨æµ‹è¯•åæ‰§è¡Œã€‚å¹¶ä¸”åœ¨æ•´ä¸ªæµ‹è¯•ä¸­åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚\nä¸Šè¿°TestHandleGetæ–¹æ³•æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¼˜åŒ–ä¸ºï¼š\nvar mux *http.ServeMux var writer *httptest.ResponseRecorder func TestMain(m *testing.M) { setUp() code := m.Run() os.Exit(code) } func setUp() { mux = http.NewServeMux() mux.HandleFunc(\u0026quot;/post/\u0026quot;, handleRequest) writer = httptest.NewRecorder() } func TestHandleGet(t *testing.T) { req, _ := http.NewRequest(\u0026quot;GET\u0026quot;, \u0026quot;/post/1\u0026quot;, nil) mux.ServeHTTP(writer, req) if writer.Code != 200 { t.Errorf(\u0026quot;response code is %d\u0026quot;, writer.Code) } var post data.Post json.Unmarshal(writer.Body.Bytes(), \u0026amp;post) if post.Id != 1 { t.Error(\u0026quot;can't retrieve JSON post\u0026quot;) } } è¿™æ ·å°±æŠŠmuxå’Œwriterä½œä¸ºå…¨å±€å˜é‡ã€‚æµ‹è¯•å¼€å§‹å‰è¿›è¡Œåˆå§‹åŒ–è®¾ç½®ã€‚\næµ‹è¯•æ›¿èº«å’Œä¾èµ–æ³¨å…¥ ä¸ºäº†ä¸åœ¨æµ‹è¯•ä¸­æ‰§è¡ŒçœŸå®çš„æ“ä½œï¼Œå¦‚æµ‹è¯•é‚®ä»¶å‘é€ä¸å¸Œæœ›çœŸçš„å‘é€é‚®ä»¶ï¼›æµ‹è¯•æ•°æ®åº“ä¸å¸Œæœ›çœŸçš„ä¿®æ”¹æ•°æ®åº“ï¼ˆæŸäº›åœºæ™¯ä¸‹ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦ç”¨æ¥å£æ¥å®ç°ä¾èµ–æ³¨å…¥ï¼ˆæ›¿æ¢å®é™…å¯¹è±¡ï¼‰ï¼Œç”±ä¾èµ–å…³ç³»ä»£æ›¿å®é™…çš„æ“ä½œï¼Œå®ç°å±‚çš„è§£è€¦ã€‚\nç¬¬ä¸‰æ–¹goæ£€æµ‹åº“ gocheck è¿™æ˜¯ä¸€ä¸ªåŸºäºtestingæ„å»ºçš„æµ‹è¯•æ¡†æ¶ã€‚å®‰è£…ï¼šgo get gopkg.in/check.v1\næœ‰å‡ ä¸ªç‰¹ç‚¹ï¼š\nä»¥suiteä¸ºå•ä½åˆ†ç»„æµ‹è¯•ï¼ˆæµ‹è¯•æŸä¸ªç»“æ„é‡Œçš„æ‰€æœ‰æµ‹è¯•æ–¹æ³•ï¼‰ suiteæˆ–å•ä¸ªæµ‹è¯•ç”¨ä¾‹ç²’åº¦çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼ˆæµ‹è¯•å¤¹å…·ï¼‰ ã€‚ã€‚ã€‚ ä½¿ç”¨ä¾‹å­ï¼Œåªæœ‰æ³¨å†Œè¿‡çš„Suiteæ‰ä¼šè¢«æµ‹è¯•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 import( . \u0026#34;gopkg.in/check.v1\u0026#34; ) //å®šä¹‰suite type XxxSuite struct{} //æ³¨å†Œsuite,åªæœ‰æ³¨å†Œè¿‡çš„Suiteæ‰ä¼šè¢«æµ‹è¯• func init(){ Suite(\u0026amp;XxxSuite{}) } //å®šä¹‰suiteé‡Œçš„æµ‹è¯•æ–¹æ³• func (x *XxxSuite) TestHandleGet(c *C){ ... c.Check(code,Equals,200) ... } go test -check.vv ä¼šæ˜¾ç¤ºæ›´è¯¦ç»†çš„æ—¥å¿—\næµ‹è¯•å¤¹å…·ï¼ˆé¢„å®šä¹‰çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼‰ï¼š\nsuiteç²’åº¦ï¼ˆå½“å‰å¥—ä»¶æ‰§è¡Œå‰åè°ƒç”¨ï¼‰ SetUpSuite TearDownSuite æµ‹è¯•ç”¨ä¾‹ç²’åº¦ï¼ˆå½“å‰å¥—ä»¶çš„æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹æ‰§è¡Œå‰åè°ƒç”¨ï¼‰ SetUpTest TearDownTest æ³¨æ„è¿™å‡ ä¸ªå‡½æ•°éœ€è¦å®šä¹‰åœ¨suiteå†…ï¼Œå¦‚ï¼šfunc (x *XxxSuite) SetUpSuite(c *C){} func (x *XxxSuite) SetUpTest(c *C){}\nginkgo ä¸€ä¸ªè¡Œä¸ºé©±åŠ¨å¼€å‘ï¼ˆBDDï¼‰é£æ ¼çš„Goæµ‹è¯•æ¡†æ¶ã€‚ä¸»è¦ç”¨äºå®ç°BDDï¼Œä½†æ˜¯è¿™é‡Œåªç”¨ä½œæµ‹è¯•æ¡†æ¶ä½¿ç”¨ã€‚\nBDDï¼Œè½¯ä»¶ç”±ç›®æ ‡è¡Œä¸ºå®šä¹‰ã€‚è¿™äº›è¡Œä¸ºä¹Ÿå°±æ˜¯ä¸šåŠ¡éœ€æ±‚ï¼Œå¦‚ï¼š\n1ã€ç”¨ginkgoè½¬æ¢å·²å­˜åœ¨çš„æµ‹è¯•ç”¨ä¾‹ä¸ºBDDé£æ ¼\nåœ¨åŒ…å«æµ‹è¯•æ–‡ä»¶çš„ç›®å½•ä¸‹æ‰§è¡Œginkgo convert .ï¼Œä¼šç”Ÿæˆxxx_suite_test.goï¼ˆç›¸å½“äºåŸæ¥testingçš„å…¥å£ï¼‰ï¼Œå¹¶å¯¹åŸxxx_test.goè¿›è¡Œä¿®æ”¹ï¼Œå› æ­¤æ³¨æ„å¤‡ä»½ã€‚\n2ã€è‡ªå·±ç¼–å†™ginkgoç”¨ä¾‹\nç”¨åˆ°2ä¸ªå‘½ä»¤ï¼š\nginkgo bootstrap:åˆ›å»ºå¼•å¯¼æ–‡ä»¶ï¼ˆæˆ‘å–çš„åå­—ï¼‰ï¼Œç±»ä¼¼xxx_suite_test.go ginkgo generate:åˆ›å»ºæµ‹è¯•ç”¨ä¾‹æ–‡ä»¶çš„éª¨æ¶ï¼š è¿™é‡Œé¦–å…ˆå†å¯¼å…¥ä¸€ä¸ªæ–­è¨€åŒ…Gomegaï¼Œä¸ºå•¥è¦ç”¨è¿™ä¸ªå‘¢ï¼Œå¯èƒ½åŠŸèƒ½æ›´å¼ºå¤§å§ã€‚\ngo get github.com/onsi/gomega\næ¥ä¸‹æ¥å°±åœ¨è¿™ä¸ªDescribeå‡½æ•°é‡Œæè¿°ç”¨æˆ·æ•…äº‹ã€æƒ…æ™¯ã€‚ä¹Ÿå°±æ˜¯ç”¨ä»–ç»™å®šçš„æ ¼å¼å†™æµ‹è¯•ä»£ç ã€‚\nå½“ç„¶ginkgoçš„æµ‹è¯•å¤¹å…·ï¼ˆé¢„å®šä¹‰çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼‰ä¹Ÿä¸å¯å°‘ï¼ŒBeforeEach()ä¼šåœ¨æ¯ä¸ªæƒ…æ™¯å‰æ‰§è¡Œ(ä¹Ÿå°±æ˜¯æ¯ä¸ªcontextå‡½æ•°å‰æ‰§è¡Œ)ï¼š\n","date":"2023-02-15T11:31:41+08:00","permalink":"https://chajiuqqq.github.io/blogs/p/golang%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8%E6%B5%8B%E8%AF%95/","title":"Golangä¸­çš„åº”ç”¨æµ‹è¯•"},{"content":"Golangä¸­çš„æ•°æ®å­˜å‚¨æœ‰ä¸‰ç§æ–¹æ¡ˆï¼š\nåˆ©ç”¨å®¹å™¨çš„å†…å­˜å­˜å‚¨ï¼ˆéå†…å­˜æ•°æ®åº“ï¼‰ åˆ©ç”¨æ–‡ä»¶è¯»å†™çš„å­˜å‚¨ï¼ˆæ–‡æœ¬æ–‡ä»¶å¦‚csvã€äºŒè¿›åˆ¶æ–‡ä»¶å¦‚gobï¼‰ æ•°æ®åº“å­˜å‚¨ æœ¬æ–‡ç®€è¿°åé¢ä¸¤ç§ã€‚\næ–‡ä»¶å­˜å‚¨ csvè¯»å†™ gobè¯»å†™ åˆ©ç”¨database/sqlè¿æ¥æ•°æ®åº“å¹¶æ‰§è¡ŒCRUD go orm å…³ç³»æ˜ å°„å™¨ å®‰è£… è¿æ¥æ•°æ®åº“ æ¨¡å‹å£°æ˜ é¢„åŠ è½½ å…³è”æ¨¡å¼ æ–‡ä»¶å­˜å‚¨ ä¸‹é¢å±•ç¤ºäº†golangä¸­è¯»å†™æ–‡ä»¶çš„å¸¸ç”¨æ–¹å¼ã€‚\nioutilçš„å‡½æ•°è¯»å†™æ–‡ä»¶ osåˆ›å»ºFileï¼Œå†è¯»å†™æ–‡ä»¶ code:\npackage main import ( \u0026quot;fmt\u0026quot; \u0026quot;io/ioutil\u0026quot; \u0026quot;os\u0026quot; ) func main() { //ioutilè¯»å†™æ–‡ä»¶ data := []byte(\u0026quot;hello world!\u0026quot;) err := ioutil.WriteFile(\u0026quot;data1\u0026quot;, data, 0644) if err != nil { panic(err) } read1, _ := ioutil.ReadFile(\u0026quot;data1\u0026quot;) fmt.Println(string(read1)) //osè¯»å†™æ–‡ä»¶ file1, _ := os.Create(\u0026quot;data2\u0026quot;) defer file1.Close() nbytes, _ := file1.Write(data) fmt.Printf(\u0026quot;wrote %d bytes to file\\n\u0026quot;, nbytes) file2, _ := os.Open(\u0026quot;data2\u0026quot;) defer file2.Close() read2 := make([]byte, len(data)) nbytes, _ = file2.Read(read2) fmt.Printf(\u0026quot;Read %d bytes from file\\n\u0026quot;, nbytes) fmt.Println(string(read2)) } // hello world! wrote 12 bytes to file Read 12 bytes from file hello world! csvè¯»å†™ åˆ©ç”¨\u0026quot;encoding/csv\u0026quot;å¯å®ç°csvè¯»å†™ï¼Œä¸‹é¢æ˜¯å°ä¾‹å­ã€‚å°†Fileä¼ ç»™csv.NewWriter()æˆ–csv.NewReader()\npackage main import ( \u0026quot;encoding/csv\u0026quot; \u0026quot;fmt\u0026quot; \u0026quot;os\u0026quot; \u0026quot;strconv\u0026quot; ) type Post struct { Id int Content string Author string } func main() { csvFile, err := os.Create(\u0026quot;posts.csv\u0026quot;) if err != nil { panic(err) } defer csvFile.Close() allPosts := []Post{ Post{1, \u0026quot;hello world 1\u0026quot;, \u0026quot;Jack1\u0026quot;}, Post{2, \u0026quot;hello world 2\u0026quot;, \u0026quot;Jack2\u0026quot;}, Post{3, \u0026quot;hello world 3\u0026quot;, \u0026quot;Jack3\u0026quot;}, Post{4, \u0026quot;hello world 4\u0026quot;, \u0026quot;Jack4\u0026quot;}, Post{5, \u0026quot;hello world 5\u0026quot;, \u0026quot;Jack5\u0026quot;}, } writer := csv.NewWriter(csvFile) for _, post := range allPosts { line := []string{strconv.Itoa(post.Id), post.Content, post.Author} if err := writer.Write(line); err != nil { panic(err) } } writer.Flush() file, err := os.Open(\u0026quot;posts.csv\u0026quot;) if err != nil { panic(err) } defer file.Close() reader := csv.NewReader(file) reader.FieldsPerRecord = -1 records, err := reader.ReadAll() if err != nil { panic(err) } var posts []Post for _, item := range records { id, _ := strconv.Atoi(item[0]) post := Post{id, item[1], item[2]} posts = append(posts, post) } fmt.Println(posts[0].Id) fmt.Println(posts[0].Content) fmt.Println(posts[0].Author) } ç”Ÿæˆposts.csv:\n1,hello world 1,Jack1 2,hello world 2,Jack2 3,hello world 3,Jack3 4,hello world 4,Jack4 5,hello world 5,Jack5 gobè¯»å†™ åˆ©ç”¨\u0026quot;encoding/gob\u0026quot;åŒ…ï¼Œgob.NewEncoder()æ¥å—ä¸€ä¸ªio.Writer; gob.NewDecoder()æ¥å—ä¸€ä¸ªio.Reader.\nä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥æä¾›ä¸€ä¸ªbufferï¼Œä¾›ç¼–ç æ—¶å­˜å‚¨ç»“æœï¼›ä¾›è§£ç æ—¶å­˜å‚¨è¾“å…¥ã€‚\næœ€åä¼ å…¥\u0026amp;postRecordæ‰èƒ½ä¿®æ”¹åŸå˜é‡å†…å®¹ã€‚\npackage main import ( \u0026quot;bytes\u0026quot; \u0026quot;encoding/gob\u0026quot; \u0026quot;fmt\u0026quot; \u0026quot;io/ioutil\u0026quot; ) type Post struct { Id int Content string Author string } func store(data interface{}, filename string) { buffer := new(bytes.Buffer) encoder := gob.NewEncoder(buffer) err := encoder.Encode(data) if err != nil { panic(err) } err = ioutil.WriteFile(filename, buffer.Bytes(), 0600) if err != nil { panic(err) } } func load(data interface{}, filename string) { raw, err := ioutil.ReadFile(filename) if err != nil { panic(err) } buffer := bytes.NewBuffer(raw) decoder := gob.NewDecoder(buffer) err = decoder.Decode(data) if err != nil { panic(err) } } func main() { post := Post{1, \u0026quot;hello world\u0026quot;, \u0026quot;jack\u0026quot;} store(post, \u0026quot;post1\u0026quot;) var postRecord Post load(\u0026amp;postRecord, \u0026quot;post1\u0026quot;) fmt.Println(postRecord) } åˆ©ç”¨database/sqlè¿æ¥æ•°æ®åº“å¹¶æ‰§è¡ŒCRUD é¦–å…ˆéœ€è¦æ³¨å…¥å¯¹åº”çš„æ•°æ®åº“é©±åŠ¨ï¼Œå¦‚postgreså¸¸ç”¨github.com/lib/pqé©±åŠ¨ã€‚åœ¨mainåŒ…ä¸­æ³¨å…¥ï¼š\nimport( _ \u0026quot;github.com/lib/pq\u0026quot; ) æ•°æ®åº“è¿æ¥ï¼Œä½¿ç”¨sql.Open(æ•°æ®åº“åç§°ï¼Œæ•°æ®æºå­—ç¬¦ä¸²)ï¼Œå…¶ä¸­æ•°æ®æºå­—ç¬¦ä¸²éœ€è¦ç¬¦åˆå¯¹åº”é©±åŠ¨çš„æ ¼å¼ï¼Œå¦‚pqçš„è¯ï¼Œæœ‰è¿™ä¹ˆå‡ ç§åˆæ³•çš„æ ¼å¼ï¼š\n\u0026ldquo;user=pqgotest dbname=pqgotest sslmode=verify-full\u0026rdquo; \u0026ldquo;postgres://pqgotest:password@localhost/pqgotest?sslmode=verify-full\u0026rdquo; è§ https://pkg.go.dev/github.com/lib/pq\nCRUDæ€»ç»“ï¼š\né¢„å¤„ç†è¯­å¥ï¼šä½¿ç”¨sql.Stmtç»“æ„\nstmt,err := db.Prepare(\u0026quot;...\u0026quot;) æ‰§è¡Œè¯­å¥å¹¶è·å–ä¸€ä¸ªsql.Row,ä¸€èˆ¬åè·ŸScan(),ç”¨äºæŠŠè¿™ä¸€è¡Œè¯»å–åˆ°æŸäº›å˜é‡ä¸­\ndb.QueryRow(\u0026quot;...\u0026quot;, , ) æˆ– stmt.QueryRow( , ) æ‰§è¡Œå¹¶è·å–å¤šä¸ªsql.Row:\nrows,err := db.Query(\u0026quot;...\u0026quot;, , ) rows.Next() rows.Scan() ç›´æ¥æ‰§è¡Œè¯­å¥ï¼Œåªè¿”å›æœ€åæ’å…¥ID(å¦‚æœinsert)ã€å½±å“çš„è¡Œæ•°ï¼ˆinsertã€updateã€deleteï¼‰ï¼Œä¸è¿”å›æŸ¥è¯¢ç»“æœï¼š\nres,err := db.Exec(\u0026quot;...\u0026quot;, , ) go orm å…³ç³»æ˜ å°„å™¨ ORM æ€æƒ³æ˜¯å°†æ•°æ®ç»“æ„å’Œè¡¨ç»“æ„ç›¸å¯¹åº”ã€‚Gormæ˜¯goé‡Œæœ€æ£’çš„ORMã€‚ä¸‹é¢ä»‹ç»Gormçš„å¤§æ¦‚ç”¨æ³•ï¼Œå…·ä½“å¯è§æ–‡æ¡£ https://gorm.io/zh_CN/docs/index.html\nå®‰è£… éœ€è¦å®‰è£…gormå’Œå¯¹åº”çš„æ•°æ®åº“é©±åŠ¨\ngo get -u gorm.io/gorm go get -u gorm.io/driver/postgres è¿æ¥æ•°æ®åº“ ä¸€èˆ¬åœ¨initä¸­æ‰§è¡Œè¿æ¥å’Œæ•°æ®åº“è‡ªåŠ¨è¿ç§»ï¼š\nfunc init() { var err error dsn := \u0026quot;user=postgres password=mkQ445683 dbname=chitchat sslmode=disable\u0026quot; Db, err = gorm.Open(postgres.Open(dsn), \u0026amp;gorm.Config{}) if err != nil { log.Fatal(err) } Db.AutoMigrate(\u0026amp;Post{}, \u0026amp;Thread{}, \u0026amp;Session{}, \u0026amp;User{}) } è¿ç§»ï¼šDb.AutoMigrate()ï¼ŒAutoMigrate ä¼šåˆ›å»ºè¡¨ã€ç¼ºå¤±çš„å¤–é”®ã€çº¦æŸã€åˆ—å’Œç´¢å¼•ï¼Œå‡ºäºä¿æŠ¤æ‚¨æ•°æ®çš„ç›®çš„ï¼Œå®ƒä¸ä¼šåˆ é™¤æœªä½¿ç”¨çš„åˆ—\ndb.AutoMigrate(\u0026amp;User{})\ndb.AutoMigrate(\u0026amp;User{}, \u0026amp;Product{}, \u0026amp;Order{})\næ¨¡å‹å£°æ˜ Gormé»˜è®¤ç”¨IDä½œä¸ºä¸»é”®ï¼Œä½¿ç”¨ç»“æ„ä½“åçš„ è›‡å½¢å¤æ•° ä½œä¸ºè¡¨åï¼Œå­—æ®µåçš„ è›‡å½¢ ä½œä¸ºåˆ—åï¼Œå¹¶ä½¿ç”¨ CreatedAtã€UpdatedAt å­—æ®µè¿½è¸ªåˆ›å»ºã€æ›´æ–°æ—¶é—´\nå¦‚ï¼šMemberNumber \u0026ndash;\u0026gt; member_number; CreatedAt \u0026ndash;\u0026gt; created_at\né€šå¸¸å°†gorm.ModelåµŒå…¥è‡ªå·±çš„ç»“æ„ä½“ä¸­ï¼Œå¦‚ï¼š\nUser struct { gorm.Model Uuid string Name string Email string Password string } gorm.ModelåŒ…æ‹¬å­—æ®µ IDã€CreatedAtã€UpdatedAtã€DeletedAtï¼Œæ‰€ä»¥ä½ çš„ç»“æ„ä½“ä¹Ÿä¼šåŒ…å«è¿™äº›å­—æ®µã€‚å¯¹äºåŒ…å«çš„fieldï¼Œä¹Ÿå¯ä»¥ç”¨æ ‡ç­¾embeddedåµŒå…¥ï¼š\ntype Blog struct { ID int Author Author `gorm:\u0026quot;embedded\u0026quot;` Upvotes int32 } é¢„åŠ è½½ é¦–å…ˆæˆ‘ä»¬å®šä¹‰Userã€Orderã€City. Userå’ŒOrderæ˜¯ä¸€å¯¹å¤šå…³ç³»ï¼ŒUserå’ŒCityæ˜¯ä¸€å¯¹ä¸€å…³ç³»ã€‚\ntype User struct { gorm.Model Username string Orders []Order City City } type Order struct { gorm.Model UserID uint Price float64 } type City struct{ gorm.Model UserID uint Name string } è¿™ç§å…³ç³»ç”±å¤–é”®å®šä¹‰ï¼ŒGormé»˜è®¤ä¼šå°†ç±»ä¼¼UserIDè¯†åˆ«ä¸ºUserçš„å¤–é”®ã€‚æ‰€ä»¥ä¸Šè¿°å…³ç³»ä¼šè¢«Gormå»ºç«‹ã€‚\nåŒæ—¶æˆ‘ä»¬å¯ä»¥åœ¨Useré‡ŒåŒ…å«[]Orderå’ŒCityï¼Œè¿™å¾ˆæ–¹ä¾¿æˆ‘ä»¬è·å–å’ŒUserç›¸å…³è”çš„å¯¹è±¡ã€‚å¦‚æœä»…ä»…é€šè¿‡\nusers := []User{} db.Find(\u0026amp;users) æ— æ³•åŠ è½½[]Orderå’ŒCityã€‚ä¸€ä¸ªåŠ è½½å†…åœ¨å…³è”çš„å¯¹è±¡çš„æ–¹æ³•æ˜¯é¢„åŠ è½½Preloadï¼š\nusers := []User{} db.Preload(\u0026quot;Orders\u0026quot;).Preload(\u0026quot;City\u0026quot;).Find(\u0026amp;users) é€šè¿‡åœ¨Preloadé‡ŒæŒ‡å®šç»“æ„å­—æ®µåï¼Œå†æŸ¥è¯¢ï¼ŒGormä¼šè‡ªåŠ¨åŠ è½½å¯¹åº”å…³è”çš„å¯¹è±¡ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è·å¾—Userå’Œä¸å…¶åŒ¹é…çš„Orderså’ŒCityã€‚\n1ã€æ¡ä»¶é¢„åŠ è½½\nä¸Šè¿°Preloadä¼šåŒ¹é…æ‰€æœ‰UserIDç¬¦åˆçš„Orderï¼Œå¦‚æœæƒ³è¿›ä¸€æ­¥æ·»åŠ çº¦æŸæ¡ä»¶ï¼Œå¦‚å·²å®Œæˆçš„Orderï¼Œå¦‚ä½•å®ç°ï¼Ÿå¯ä»¥ç”¨æ¡ä»¶é¢„åŠ è½½ï¼š\ndb.Preload(\u0026quot;Orders\u0026quot;, \u0026quot;state=?\u0026quot;, \u0026quot;completed\u0026quot;).Find(\u0026amp;users) // SELECT * FROM users; // SELECT * FROM orders WHERE user_id IN (1,2,3,4) AND state NOT IN ('cancelled'); db.Where(\u0026quot;state = ?\u0026quot;, \u0026quot;active\u0026quot;).Preload(\u0026quot;Orders\u0026quot;, \u0026quot;state NOT IN (?)\u0026quot;, \u0026quot;cancelled\u0026quot;).Find(\u0026amp;users) // SELECT * FROM users WHERE state = 'active'; // SELECT * FROM orders WHERE user_id IN (1,2) AND state NOT IN ('cancelled'); ç¬¬ä¸€ä¸ªæ˜¯åœ¨æŸ¥æ‰¾Orderæ—¶æ·»åŠ çº¦æŸï¼Œç¬¬äºŒä¸ªæ˜¯åœ¨æŸ¥æ‰¾Useræ—¶æ·»åŠ whereï¼Œç„¶åæŸ¥æ‰¾Orderæ—¶æ·»åŠ çº¦æŸ\n2ã€åµŒå¥—é¢„åŠ è½½\nå‡è®¾Orderé‡ŒåˆåŒ…å«has oneå…³ç³»ï¼Œå¯¹åº”ä¸€ä¸ªäº§å“ï¼ŒæŸ¥Useræ—¶èƒ½æŠŠOrders.ProductæŸ¥å‡ºæ¥å—ï¼Ÿ\ntype User struct { gorm.Model Username string Orders []Order City City } type Order struct { gorm.Model UserID uint Price float64 ProductID uint Product Product } type Product struct { gorm.Model Name string Price float64 } æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯è¦ç”¨åµŒå¥—é¢„åŠ è½½ï¼ŒæŒ‡å®šåŠ è½½Orders.Product\ndb.Preload(\u0026quot;Orders.Product\u0026quot;).Preload(\u0026quot;City\u0026quot;).Find(\u0026amp;users) å…³è”æ¨¡å¼ ç”±äºå…³ç³»çš„å­˜åœ¨ï¼ˆbelongs toï¼Œhas oneï¼Œhas manyï¼Œmany to manyï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…³ç³»è¿›è¡ŒCRUDã€‚\næ¯”å¦‚å‡è®¾ä¸€ä¸ªäººæœ‰å¤šå¼ å¡ï¼ŒUserå’ŒCreditCardæ˜¯ä¸€å¯¹å¤šå…³ç³»ï¼Œæƒ³ç»™Useræ·»åŠ ä¸€å¼ æ–°çš„å¡ï¼Œä¸€ä¸ªæ–¹æ³•æ˜¯ç›´æ¥æ“ä½œCreditCardè¡¨ï¼Œè®¾ç½®å¡å±æ€§ã€UserIDï¼Œå†ä¿å­˜ã€‚\nå¦ä¸€ä¸ªæ–¹æ³•æ˜¯é€šè¿‡Userå’ŒCreditCardçš„ä¸€å¯¹å¤šå…³ç³»æ“ä½œï¼Œç»™User Appendä¸€å¼ å¡ï¼š\ndb.Model(\u0026amp;user).Association(\u0026quot;CreditCard\u0026quot;).Append(\u0026amp;CreditCard{Number: \u0026quot;411111111111\u0026quot;}) ä¸Šè¿°ä»£ç æŒ‡æ˜äº†Useræ˜¯è°ï¼ˆ\u0026amp;userï¼Œæºæ¨¡å‹ï¼Œä¸»é”®ä¸èƒ½ä¸ºç©ºï¼‰ï¼ŒæŒ‡æ˜å“ªä¸ªå…³ç³»ï¼ˆCreditCardï¼Œç»“æ„å­—æ®µåï¼‰ï¼Œæ“ä½œæ˜¯ä»€ä¹ˆï¼ˆappend+å¡ä¿¡æ¯ï¼‰ï¼Œæ³¨æ„æ­¤å¤„å¡ä¸éœ€è¦å£°æ˜UserIDï¼Œå› ä¸ºè¿™ä¸ªå…³ç³»å·²ç»ç»™å‡ºäº†ã€‚\nè¿™æ˜¯é€šè¿‡å…³è”æ¨¡å¼çš„æ·»åŠ åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å…³ç³»å®ç°å®Œæ•´çš„CRUDã€‚\n// to be continuing\n","date":"2023-02-12T08:47:06+08:00","permalink":"https://chajiuqqq.github.io/blogs/p/golang%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/","title":"Golangä¸­çš„æ•°æ®å­˜å‚¨"},{"content":" go-in-actioné‡Œçš„ä¸€ä¸ªdemoï¼Œç»™å®šéœ€è¦åŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œåœ¨æœç´¢æºï¼ˆå¦‚rssï¼‰ä¸­æ‰¹é‡æŸ¥è¯¢æœ€æ–°æ–‡ç« ï¼Œè¿”å›ç»“æœï¼ˆå¦‚ç›¸åŒ¹é…çš„titleå’Œdescriptionï¼‰\nå…³é”®å­—ï¼šgoroutineå¹¶å‘ï¼Œjson/xmlååºåˆ—åŒ–ï¼Œç½‘ç»œè¯·æ±‚\né¡¹ç›®åœ°å€ï¼šhttps://github.com/chajiuqqq/go-rss-matcher\næ•ˆæœï¼šæœç´¢â€œChinaâ€ï¼Œå‘ç°äº†è¿‘æœŸå’ŒChinaç›¸å…³çš„æ–‡ç« ï¼Œå¦‚ä¸­å›½æ°”çƒè¯¯å…¥ç¾å›½:\n$ ./rss-matcher 2023/02/04 12:04:33 title China says balloon spotted over U.S. is a 'civilian airship' that blew astray 2023/02/04 12:04:33 description The State Department announced Secretary of State Antony Blinken will not go ahead with a planned trip to China, after the surveillance balloon was detected over U.S. airspace Thursday. 2023/02/04 12:04:33 title Tensions continue to increase between the United States and China 2023/02/04 12:04:34 HTTP Response Error: http://www.npr.org/rss/rss.php?id=43 code 404 2023/02/04 12:04:34 HTTP Response Error: http://www.npr.org/rss/rss.php?id=1021 code 404 2023/02/04 12:04:34 title Perspective: Jiang Zemin's passing marks the end of an era for China 2023/02/04 12:04:34 description As China holds a memorial service for its late leader Jiang Zemin, an NPR correspondent who met Jiang reflects on the figure and his transforming country. 2023/02/04 12:04:34 title Blinken postpones China trip after discovery of surveillance balloon 2023/02/04 12:04:34 description Secretary of State Antony Blinken has postponed his trip to China after the discovery of what the Pentagon alleges to be a Chinese surveillance balloon. China's government says it's a weather balloon. 2023/02/04 12:04:34 title China says balloon spotted over U.S. is a 'civilian airship' that blew astray 2023/02/04 12:04:34 description The State Department announced Secretary of State Antony Blinken will not go ahead with a planned trip to China, after the surveillance balloon was detected over U.S. airspace Thursday. 2023/02/04 12:04:34 description China's foreign ministry described the balloon as \u0026quot;a civilian airship\u0026quot; for meteorological research that had blown far off course by winds. The Pentagon suspects it's collecting sensitive information. é¡¹ç›®ç»“æ„è®¾è®¡ä¸Šæ”¯æŒå¤šç§æœç´¢æºï¼Œå¦‚rssç­‰ï¼Œåªè¦è®¾è®¡å¯¹åº”çš„matcherå°±å¯ä»¥è¿›è¡Œæœç´¢åŒ¹é…ã€‚\nç¨‹åºæµç¨‹å¦‚ä¸‹ï¼š\nè¯»å–data.jsoné‡Œçš„æœç´¢æºï¼ˆfeedsï¼‰ï¼Œå¹¶ååºåˆ—åŒ–ä¸ºå¯¹è±¡ä¾›åé¢è®¿é—® ç»™æ¯ä¸ªfeedå¯»æ‰¾å·²æ³¨å†Œçš„matcheråŒ¹é…å™¨ï¼Œå¹¶å¼€å¯goroutineåŒ¹é…ã€‚åŒ¹é…ç»“æœå†™å…¥é€šé“ã€‚ åŒ¹é…è¿‡ç¨‹é¦–å…ˆè¯·æ±‚feedçš„URLï¼Œè·å¾—XML è§£æxmlï¼Œååºåˆ—åŒ–åˆ°å¯¹è±¡ å¯¹å¯¹è±¡é‡Œçš„å­—æ®µè¿›è¡ŒåŒ¹é… å¾ªç¯è¯»å–é€šé“å†…çš„ç»“æœï¼Œå¹¶æ‰“å° å¦‚æœåŒ¹é…ç»“æŸï¼Œå…³é—­é€šé“ï¼Œä¸»ç¨‹åºç»“æŸ å‡ ä¸ªè®¾è®¡ä¸Šçš„äº®ç‚¹ï¼š\nè®¾è®¡Matcheræ¥å£ï¼Œæ‰€æœ‰çš„matcheréƒ½å¯ä»¥è°ƒç”¨Searchè¿›è¡Œæœç´¢ è®¾è®¡matcherMapï¼Œä¸åŒç±»å‹çš„Matcheræ³¨å†Œåä¿å­˜åœ¨è¿™é‡Œï¼Œæ–¹ä¾¿ä¸åŒæ•°æ®æºåŒ¹é…å’Œæ•°æ®æºç±»å‹æ‹“å±• æ¯ä¸ªgoroutineæ‰§è¡Œä¸€ä¸ªfeedçš„æœç´¢ï¼Œå¹¶å‘æ‰§è¡Œï¼Œæé«˜æ€§èƒ½ æŸ¥è¯¢ç»“æœåï¼Œgoroutineé€šè¿‡æ— ç¼“å†²chanæŠŠæ•°æ®å‘é€ä¸»çº¿ç¨‹å±•ç¤ºï¼ŒåŒæ­¥è·å–å¹¶å±•ç¤ºï¼Œåˆ©ç”¨äº†è¯­è¨€ç‰¹æ€§ ","date":"2023-02-07T12:01:09+08:00","permalink":"https://chajiuqqq.github.io/blogs/p/%E4%B8%80%E4%B8%AAgolang-rss%E5%86%85%E5%AE%B9%E5%8C%B9%E9%85%8D%E5%99%A8/","title":"ä¸€ä¸ªGolang RSSå†…å®¹åŒ¹é…å™¨"},{"content":"æ ‡å‡†åº“çš„logåŒ…æ— æ³•å®ç°æ—¥å¿—åˆ†çº§å¤„ç†ï¼Œè¿™ä¸ªdemoå¯ä»¥å®ç°æ—¥å¿—çš„å¤šçº§å¤„ç†ã€‚åŸç†æ˜¯å®šä¹‰å¤šä¸ªlogå¯¹è±¡ï¼Œå¹¶æŒ‡å®šä¸åŒçš„è¾“å‡ºï¼Œå®ç°ä¸åŒç­‰çº§æ—¥å¿—ä¸åŒè¾“å‡ºã€‚\nmlogåŒ…ä»£ç å¦‚ä¸‹ï¼š\n// mlog.go package mlog import ( \u0026quot;io\u0026quot; \u0026quot;log\u0026quot; \u0026quot;os\u0026quot; ) var ( Trace *log.Logger Info *log.Logger Warning *log.Logger Error *log.Logger ) func init() { file, err := os.OpenFile(\u0026quot;error.txt\u0026quot;, os.O_CREATE|os.O_WRONLY|os.O_APPEND, 0666) if err != nil { log.Fatalln(\u0026quot;Fail to open error file:\u0026quot;, err) } Trace = log.New(io.Discard, \u0026quot;TRACE: \u0026quot;, log.Ldate|log.Ltime|log.Lshortfile) Info = log.New(os.Stdout, \u0026quot;INFO: \u0026quot;, log.Ldate|log.Ltime|log.Lshortfile) Warning = log.New(os.Stdout, \u0026quot;WARNING: \u0026quot;, log.Ldate|log.Ltime|log.Lshortfile) Error = log.New(file, \u0026quot;ERROR: \u0026quot;, log.Ldate|log.Ltime|log.Lshortfile) } è°ƒç”¨æµ‹è¯•ï¼š\npackage main import \u0026quot;github.com/chajiu/go-example/mlog\u0026quot; func main() { mlog.Trace.Println(\u0026quot;trace...\u0026quot;) mlog.Info.Println(\u0026quot;Info...\u0026quot;) mlog.Warning.Println(\u0026quot;warning...\u0026quot;) mlog.Error.Println(\u0026quot;error...\u0026quot;) } error.txtä¼šåœ¨mainç›®å½•ä¸‹ç”Ÿæˆã€‚\nERROR: 2023/02/07 10:56:13 main.go:9: error... ERROR: 2023/02/07 10:56:23 main.go:9: error... Infoå’ŒWarningåˆ™æ˜¯ç›´æ¥è¾“å‡ºåˆ°stdoutï¼š\nINFO: 2023/02/07 10:56:23 main.go:7: Info... WARNING: 2023/02/07 10:56:23 main.go:8: warning... ","date":"2023-02-07T11:03:38+08:00","permalink":"https://chajiuqqq.github.io/blogs/p/%E4%B8%80%E4%B8%AAgolang%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95%E5%99%A8/","title":"ä¸€ä¸ªgolangè‡ªå®šä¹‰æ—¥å¿—è®°å½•å™¨"},{"content":"å®éªŒå®¤äºŒæ¬¡å¼€å‘ä¸€ä¸ªblocklyå¹³å°ï¼Œè¿™æ˜¯ä¸€ä¸ªç§¯æœ¨åŒ–ç¼–ç¨‹å¹³å°ï¼Œå¯ä»ç§¯æœ¨ç”Ÿæˆå„ç§è¯­è¨€ä»£ç ï¼Œå¦‚Pythonã€‚ç•Œé¢å¦‚ä¸‹ï¼Œç§¯æœ¨åˆ°ä»£ç ç”±åŸblocklyåº“æä¾›ï¼Œä¸éš¾ã€‚ è€Œè¿è¡Œpythonä»£ç åˆšå¼€å§‹æ˜¯æ”¾åœ¨jupyter notebookï¼Œæ‰‹åŠ¨å¤åˆ¶è¿‡å»è¿è¡Œã€‚ è¿›ä¸€æ­¥ä¼˜åŒ–çš„æ–¹æ¡ˆå°±æ˜¯åœ¨çº¿è¿è¡Œï¼ˆåœ¨æµè§ˆå™¨ï¼‰Pythonä»£ç ã€‚åŸºæœ¬åº“çš„æµè§ˆå™¨åŒ–ä¸éš¾ï¼Œä½†æ˜¯ä¹‹å‰ä¸€ç›´æ²¡æ‰¾åˆ°å¯ä»¥è¿è¡Œç¬¬ä¸‰æ–¹åº“å¦‚pandasçš„jsåº“ã€‚è¿™æ¬¡çœ‹åˆ°pyodideï¼Œå¯ä»¥å®ç°ç¬¬ä¸‰æ–¹åº“çš„å¯¼å…¥ã€‚äºæ˜¯å¼€å§‹æŠ˜è…¾ã€‚\nåˆæ­¥è¿è¡Œpyodide ç›´æ¥çœ‹å®˜ç½‘çš„ä¾‹å­ï¼Œå¯ä»¥ç›´æ¥è·‘pythonåŸºç¡€åº“ï¼š\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;script src=\u0026quot;https://cdn.jsdelivr.net/pyodide/v0.21.3/full/pyodide.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt; You can execute any Python code. Just enter something in the box below and click the button. \u0026lt;/p\u0026gt; \u0026lt;input id=\u0026quot;code\u0026quot; value=\u0026quot;sum([1, 2, 3, 4, 5])\u0026quot; /\u0026gt; \u0026lt;button onclick=\u0026quot;evaluatePython()\u0026quot;\u0026gt;Run\u0026lt;/button\u0026gt; \u0026lt;br /\u0026gt; \u0026lt;br /\u0026gt; \u0026lt;div\u0026gt;Output:\u0026lt;/div\u0026gt; \u0026lt;textarea id=\u0026quot;output\u0026quot; style=\u0026quot;width: 100%;\u0026quot; rows=\u0026quot;6\u0026quot; disabled\u0026gt;\u0026lt;/textarea\u0026gt; \u0026lt;script\u0026gt; const output = document.getElementById(\u0026quot;output\u0026quot;); const code = document.getElementById(\u0026quot;code\u0026quot;); function addToOutput(s) { output.value += \u0026quot;\u0026gt;\u0026gt;\u0026gt;\u0026quot; + code.value + \u0026quot;\\n\u0026quot; + s + \u0026quot;\\n\u0026quot;; } output.value = \u0026quot;Initializing...\\n\u0026quot;; // init Pyodide async function main() { let pyodide = await loadPyodide(); output.value += \u0026quot;Ready!\\n\u0026quot;; return pyodide; } let pyodideReadyPromise = main(); async function evaluatePython() { let pyodide = await pyodideReadyPromise; try { let output = pyodide.runPython(code.value); addToOutput(output); } catch (err) { addToOutput(err); } } \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; printé—®é¢˜ åŸºæœ¬åº“pythonä»£ç å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯è¿è¡Œprint('abc')å‡½æ•°æ—¶ï¼Œå‘ç°æ‰“å°çš„ä¸œè¥¿ä¸åœ¨è¿”å›çš„ç»“æœé‡Œï¼Œè€Œæ˜¯åœ¨consoleé‡Œã€‚å¹¸è¿çš„æ˜¯è¿™ä¸ªé—®é¢˜ä¹Ÿæœ‰issueã€‚\nè¿™ä¸ªissueä¸‹é¢çš„è¿™ä¸ªå›ç­”æä¾›äº†ä¸€ç§æ–¹æ³•ï¼Œå¯ä»¥å°†æ‰§è¡Œçš„ä»£ç çš„è¾“å‡ºè½¬åˆ°è¿”å›ç»“æœï¼Œè€Œä¸æ˜¯consoleã€‚\n\u0026lt;script type=\u0026quot;text/javascript\u0026quot;\u0026gt; // set the pyodide files URL (packages.json, pyodide.asm.data etc) window.languagePluginUrl = 'https://cdn.jsdelivr.net/pyodide/v0.16.1/full/'; \u0026lt;/script\u0026gt; \u0026lt;script src=\u0026quot;https://cdn.jsdelivr.net/pyodide/v0.16.1/full/pyodide.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; function setup_pyodide() { // setup pyodide environment to run code blocks as needed var setup_code = ` import sys, io, traceback namespace = {} # use separate namespace to hide run_code, modules, etc. def run_code(code): \u0026quot;\u0026quot;\u0026quot;run specified code and return stdout and stderr\u0026quot;\u0026quot;\u0026quot; out = io.StringIO() oldout = sys.stdout olderr = sys.stderr sys.stdout = sys.stderr = out try: # change next line to exec(code, {}) if you want to clear vars each time exec(code, namespace) except: traceback.print_exc() sys.stdout = oldout sys.stderr = olderr return out.getvalue() ` pyodide.runPython(setup_code) } function runPython() { // run code currently stored in editor pyodide.globals.code_to_run = editor.getValue() document.getElementById(\u0026quot;output\u0026quot;).value = pyodide.runPython('run_code(code_to_run)') } // run setup_pyodide() when pyodide finishes loading languagePluginLoader.then(setup_pyodide) \u0026lt;/script\u0026gt; æ³¨æ„ä»–ç”¨çš„æ˜¯v0.16.1ç‰ˆæœ¬pyodideï¼Œæœ€æ–°çš„0.21.3ä¼šæŠ¥é”™ã€‚ä½†æ˜¯æ€è·¯å¾ˆå¥½ï¼Œè´´ä¸€ä¸‹æˆ‘è‡ªå·±ä¿®æ”¹çš„0.21.3ç‰ˆæœ¬ä»£ç ,åŸç†å°±æ˜¯æŠŠè¿è¡Œçš„ä»£ç å½“ä½œå‚æ•°è¾“å…¥é¢„å…ˆè¿è¡Œçš„run_codeå‡½æ•°ï¼š\n\u0026lt;script src=\u0026quot;https://cdn.jsdelivr.net/pyodide/v0.21.3/full/pyodide.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; const output = document.getElementById(\u0026quot;output\u0026quot;); const pyplotfigure = document.getElementById(\u0026quot;pyplotfigure\u0026quot;); function addToOutput(s) { output.value += \u0026quot;\u0026gt;\u0026gt;\u0026gt; \u0026quot; + s + \u0026quot;\\n\u0026quot;; } output.value = \u0026quot;Initializing...\\n\u0026quot;; function clearOutput() { output.value = 'Ready!\\n' pyplotfigure.src='' } let pyodide async function runPython() { // run code currently stored in editor let code_to_run = editor.getValue() await pyodide.loadPackagesFromImports(code_to_run); pyodide.globals.set('code_to_run',code_to_run); addToOutput(pyodide.runPython('run_code(code_to_run)')); } async function main(){ pyodide = await loadPyodide(); // await pyodide.loadPackage(['pandas','matplotlib']); var setup_code = ` import sys, io, traceback namespace = {} # use separate namespace to hide run_code, modules, etc. def run_code(_code): \u0026quot;\u0026quot;\u0026quot;run specified code and return stdout and stderr\u0026quot;\u0026quot;\u0026quot; namespace={} _out = io.StringIO() _oldout = sys.stdout _olderr = sys.stderr sys.stdout = sys.stderr = _out try: # change next line to exec(code, {}) if you want to clear vars each time exec(_code,namespace) except: traceback.print_exc() sys.stdout = _oldout sys.stderr = _olderr return _out.getvalue() ` pyodide.runPython(setup_code) output.value += 'Ready!\\n' } main() \u0026lt;/script\u0026gt; ç”»å›¾æ˜¾ç¤ºé—®é¢˜ è¿™ä¸‹printæ²¡é—®é¢˜äº†ï¼Œä¸‹é¢è§£å†³ç”»å›¾çš„é—®é¢˜ã€‚ä¸Šé¢çš„\nawait pyodide.loadPackagesFromImports(code_to_run); ä¼šè‡ªåŠ¨è¯†åˆ«importå¹¶å¯¼å…¥å¯¹åº”pythonåº“çš„jsç‰ˆæœ¬ã€‚ä½†æ˜¯matplotlabç”»å›¾æ²¡æ³•ç›´æ¥å‡ºæ¥ã€‚æˆ‘æ‰¾äº†ä¸¤ä¸ªè§£å†³æ–¹æ³•\nä¿®æ”¹matplotlabçš„backendsï¼Œå¯ä»¥æŠŠå›¾ç‰‡è¾“å‡ºæˆcanvasåœ¨é¡µé¢ä¸­æ˜¾ç¤º ä¿å­˜å›¾ç‰‡çš„base64ç¼–ç ï¼Œç„¶åhtmlä¸­çš„imgè¯»å–base64ç¼–ç æ˜¾ç¤ºå›¾ç‰‡ ç¬¬ä¸€ä¸ªæ–¹æ³•å‚è€ƒè¿™ä¸ªblogï¼Œé‡Œé¢æåˆ°çš„è¿™ä¸ªdemoç”¨å¤„å¾ˆå¤§ï¼Œç›´æ¥æ˜¾ç¤ºäº†å¦‚ä½•ä»matplotlabæ˜¾ç¤ºå›¾åƒåˆ°ç½‘é¡µã€‚\nä½¿ç”¨æ–¹æ³•å°±æ˜¯åœ¨è¿è¡Œçš„pythonä»£ç é‡Œï¼Œæœ€å‰é¢åŠ ä¸Š\nimport matplotlib matplotlib.use(\u0026quot;module://matplotlib.backends.html5_canvas_backend\u0026quot;) æŒ‡å®šmatplotlabçš„backendä¸ºhtml5_canvas_backendï¼Œå°±å¯ä»¥ç”Ÿæˆcanvasäº†ï¼Œä½†æ˜¯æœ‰ä¸ªé—®é¢˜æ˜¯æˆ‘ä¸çŸ¥é“å¦‚ä½•æ§åˆ¶è¿™ä¸ªcanvasçš„ä½ç½®ï¼Œäºæ˜¯ä½¿ç”¨ç¬¬äºŒä¸ªæ–¹æ³•ã€‚\nç¬¬äºŒä¸ªæ–¹æ³•å‚è€ƒè¿™ä¸ªç½‘é¡µï¼Œè™½ç„¶å®ƒçš„pyodide.jsé“¾æ¥å¤±æ•ˆäº†çœ‹ä¸å‡ºæ•ˆæœï¼Œä½†æ˜¯å¯ä»¥ä¿®æ”¹ä¸€ä¸‹ï¼Œçœ‹åˆ°matplotlabä½œå›¾å‡ºç°åœ¨htmlä¸Šäº†ï¼š\nä»£ç å¦‚ä¸‹ï¼š\n\u0026lt;!doctype html\u0026gt; \u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt; \u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;Demo\u0026lt;/title\u0026gt; \u0026lt;script src=\u0026quot;https://cdn.jsdelivr.net/pyodide/v0.16.1/full/pyodide.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;script type=\u0026quot;text/javascript\u0026quot;\u0026gt; languagePluginLoader.then(() =\u0026gt; { pyodide.loadPackage(['matplotlib']).then(() =\u0026gt; { pyodide.runPython(` import matplotlib.pyplot as plt import io, base64 fig, ax = plt.subplots() ax.plot([1,3,2]) buf = io.BytesIO() fig.savefig(buf, format='png') buf.seek(0) img_str = 'data:image/png;base64,' + base64.b64encode(buf.read()).decode('UTF-8')` ); document.getElementById(\u0026quot;pyplotfigure\u0026quot;).src=pyodide.globals.img_str });}); \u0026lt;/script\u0026gt; \u0026lt;div id=\u0026quot;textfield\u0026quot;\u0026gt;A matplotlib figure:\u0026lt;/div\u0026gt; \u0026lt;div id=\u0026quot;pyplotdiv\u0026quot;\u0026gt;\u0026lt;img id=\u0026quot;pyplotfigure\u0026quot;/\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;html\u0026gt; æ•´åˆ æŠŠè§£å†³printçš„æ–¹æ³•å’Œç¬¬äºŒä¸ªè¾“å‡ºå›¾ç‰‡çš„æ–¹æ³•ç»“åˆèµ·æ¥æœ‰ç‚¹å°æ’æ›²ï¼Œä¸€å¼€å§‹ä¿®æ”¹runPython()\nasync function runPython() { // run code currently stored in editor let code_to_run = editor.getValue() await pyodide.loadPackagesFromImports(code_to_run); pyodide.globals.set('code_to_run',code_to_run); addToOutput(pyodide.runPython('run_code(code_to_run)')); let a = pyodide.globals.get('img_str') if(a){ pyplotfigure.src=a } } ä½†æ˜¯let a = pyodide.globals.get('img_str')ä¸€å¼€å§‹æç¤ºæ— æ³•æ‰¾åˆ°img_strï¼Œåæ¥å‘ç°æ˜¯namespaceçš„é”…ï¼š\nexec(_code,namespace) è¿™ä¸ªä¼šåœ¨ä¸€ä¸ªæ–°çš„namespaceé‡Œæ‰§è¡Œï¼Œæ‰€ä»¥åœ¨å¤–é¢æ‰¾ä¸åˆ°é‡Œé¢å®šä¹‰çš„img_strï¼Œæ”¹ä¸º\nexec(_code,globals()) ä½¿ç”¨å…¨å±€çš„namespaceï¼Œå°±å¯ä»¥çœ‹åˆ°å›¾ç‰‡äº†\næœ€åä»£ç ï¼š\njsï¼š\n\u0026lt;script src=\u0026quot;https://cdn.jsdelivr.net/pyodide/v0.21.3/full/pyodide.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; const output = document.getElementById(\u0026quot;output\u0026quot;); const pyplotfigure = document.getElementById(\u0026quot;pyplotfigure\u0026quot;); function addToOutput(s) { output.value += \u0026quot;\u0026gt;\u0026gt;\u0026gt; \u0026quot; + s + \u0026quot;\\n\u0026quot;; } output.value = \u0026quot;Initializing...\\n\u0026quot;; function clearOutput() { output.value = 'Ready!\\n' pyplotfigure.src='' } let pyodide async function runPython() { // run code currently stored in editor let code_to_run = editor.getValue() await pyodide.loadPackagesFromImports(code_to_run); pyodide.globals.set('code_to_run',code_to_run); addToOutput(pyodide.runPython('run_code(code_to_run)')); let a = pyodide.globals.get('img_str') if(a){ pyplotfigure.src=a } } async function main(){ pyodide = await loadPyodide(); // await pyodide.loadPackage(['pandas','matplotlib']); var setup_code = ` import sys, io, traceback namespace = {} # use separate namespace to hide run_code, modules, etc. def run_code(_code): \u0026quot;\u0026quot;\u0026quot;run specified code and return stdout and stderr\u0026quot;\u0026quot;\u0026quot; _out = io.StringIO() _oldout = sys.stdout _olderr = sys.stderr sys.stdout = sys.stderr = _out try: # change next line to exec(code, {}) if you want to clear vars each time exec(_code,globals()) except: traceback.print_exc() sys.stdout = _oldout sys.stderr = _olderr return _out.getvalue() ` pyodide.runPython(setup_code) output.value += 'Ready!\\n' } main() \u0026lt;/script\u0026gt; htmlè¦åŠ ä¸Šæ”¾å›¾ç‰‡çš„åœ°æ–¹ï¼š\n\u0026lt;div id=\u0026quot;pyplotdiv\u0026quot;\u0026gt;\u0026lt;img id=\u0026quot;pyplotfigure\u0026quot; style=\u0026quot;width: 100% ;\u0026quot;/\u0026gt;\u0026lt;/div\u0026gt; æœ€åå±•ç¤ºä¸€ä¸‹ï¼š\n","date":"2022-10-31T22:19:10+08:00","permalink":"https://chajiuqqq.github.io/blogs/p/blockly2python-web-edition%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B/","title":"Blockly2python Web Editionå¼€å‘æµç¨‹"},{"content":" åŸæ–‡æ ‡é¢˜ï¼šStrings, bytes, runes and characters in Go\nåŸæ–‡åœ°å€ï¼šhttps://go.dev/blog/strings\nè¯‘è€…ï¼šz\nä»‹ç» å‰æ–‡ä»‹ç»äº†sliceå¦‚ä½•å·¥ä½œï¼Œç”¨ä¸€äº›ä¾‹å­å±•ç¤ºäº†èƒŒåå®ç°åŸç†ã€‚åŸºäºé‚£æ ·çš„èƒŒæ™¯ä¸‹ï¼Œè¿™ç¯‡æ–‡ç« å°†è®¨è®ºGoä¸­çš„stringsâ€”â€”å­—ç¬¦ä¸²ã€‚ä¸€å¼€å§‹ä½ å¯èƒ½è§‰å¾—å¯¹äºä¸€ä¸ªblogçš„ä¸»é¢˜æ¥è¯´å­—ç¬¦ä¸²å¤ªè¿‡äºç®€å•ï¼Œä½†æ˜¯æƒ³è¦å¾ˆå¥½åœ°ä½¿ç”¨å®ƒä»¬ä¸ä»…éœ€è¦ç†è§£å®ƒä»¬çš„å·¥ä½œåŸç†ï¼Œä¹Ÿè¦æ˜ç™½byteã€characterã€runeé—´çš„åŒºåˆ«ï¼Œunicodeå’ŒUTF-çš„åŒºåˆ«ï¼Œå­—ç¬¦ä¸²å’Œå­—ç¬¦ä¸²å­—é¢å€¼çš„åŒºåˆ«ï¼Œå¯èƒ½è¿˜æœ‰å…¶ä»–æ›´ç»†å¾®ä¹‹å¤„çš„åŒºåˆ«ã€‚\nå¼€å§‹è¿™ä¸ªä¸»é¢˜çš„ä¸€ä¸ªæ–¹æ³•æ˜¯æ€è€ƒè¿™ä¹ˆä¸€ä¸ªç»å¸¸è¢«æåŠçš„é—®é¢˜ï¼šâ€œå½“æˆ‘åœ¨Goä¸­è·å–å­—ç¬¦ä¸²åœ¨nä½ç½®çš„ä¸œè¥¿æ—¶ï¼Œä¸ºä»€ä¹ˆæˆ‘æ²¡æœ‰è·å–åˆ°ç¬¬nä¸ªå­—ç¬¦ï¼Ÿâ€ï¼Œæ­£å¦‚ä½ æ‰€è§ï¼Œè¿™ä¸ªé—®é¢˜å¯ä»¥è®©æˆ‘ä»¬æ€è€ƒå…³äºå­—ç¬¦ä¸²å¦‚ä½•å·¥ä½œçš„æ›´å¤šç»†èŠ‚é—®é¢˜ã€‚\nä¸€ä¸ªå¾ˆæ£’çš„ï¼Œä¸å±€é™äºGoè¯­è¨€çš„å›ç­”æ˜¯Joel Spolskyçš„è‘—åblogï¼š The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses!)ã€‚è¿™ç¯‡æ–‡ç« ä¼šé‡è¿°ä»–çš„ä¸€äº›è§‚ç‚¹ã€‚\nä»€ä¹ˆæ˜¯å­—ç¬¦ä¸² è®©æˆ‘ä»¬ä»åŸºç¡€å¼€å§‹å§ã€‚\nGoä¸­ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²å®é™…ä¸Šåªæ˜¯åªè¯»çš„byte sliceè€Œå·²ã€‚å¦‚æœä½ å®Œå…¨ä¸ç†è§£ä»€ä¹ˆæ˜¯byteçš„sliceæˆ–è€…å…¶å·¥ä½œåŸç†ï¼Œè¯·è¯»ä¹‹å‰è¿™ç¯‡blogã€‚è¿™é‡Œæˆ‘ä»¬é»˜è®¤ä½ å·²ç»è¯»è¿‡äº†ã€‚\né¦–å…ˆè¦å£°æ˜çš„å¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œå­—ç¬¦ä¸²å¯ä»¥åŒ…æ‹¬ä»»æ„ä¸ªæ•°çš„å­—èŠ‚ã€‚ä¸ä¸€å®šè¦åŒ…å«unicodeæ ¼å¼æ–‡æœ¬ã€UTF-8æ ¼å¼æ–‡æœ¬ã€æˆ–å…¶ä»–é¢„å®šä¹‰æ ¼å¼çš„æ–‡æœ¬ã€‚å¦‚æœåªè€ƒè™‘å­—ç¬¦ä¸²çš„å†…å®¹ï¼Œå®ƒå…¶å®å°±æ˜¯ç­‰åŒäºbyte sliceã€‚\nè¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å­—é¢å€¼ï¼ˆåé¢ä¼šæœ‰æ›´å¤šï¼‰ï¼Œå®ƒä½¿ç”¨\\xNNç¬¦å·å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡ï¼Œå®ƒä¼šåŒ…å«å„ç§å¥‡æ€ªçš„byteï¼ˆå½“ç„¶ï¼ŒbyteèŒƒå›´æ˜¯ä»16è¿›åˆ¶çš„00åˆ°FFï¼Œä¸åŒ…æ‹¬FFï¼‰\nconst sample = \u0026quot;\\xbd\\xb2\\x3d\\xbc\\x20\\xe2\\x8c\\x98\u0026quot; æ‰“å°å­—ç¬¦ä¸² ç”±äºä¸¾ä¾‹çš„å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—èŠ‚æ˜¯éASCIIå­—ç¬¦ï¼Œç”šè‡³ä¸æ˜¯UTF-8ï¼Œç›´æ¥æ‰“å°å­—ç¬¦ä¸²ä¼šäº§ç”Ÿä¸å¥½çœ‹çš„è¾“å‡ºï¼Œæ‰“å°è¯­å¥å¦‚ä¸‹ï¼š\nfmt.Println(sample) ä¼šäº§ç”Ÿè¿™æ ·ä¸€å †ä¸œè¥¿ï¼ˆç¯å¢ƒä¸åŒæ˜¾ç¤ºçš„ä¸œè¥¿ä¹Ÿä¸åŒï¼‰\nï¿½ï¿½=ï¿½ âŒ˜ ä¸ºäº†æ‰¾å‡ºå­—ç¬¦ä¸²åˆ°åº•åŒ…å«ä»€ä¹ˆï¼Œæˆ‘ä»¬éœ€è¦æŠŠå®ƒåˆ†å¼€ï¼Œå¹¶å•ç‹¬æ£€éªŒæ¯ä¸€å—ã€‚æœ‰ä¸€äº›æ–¹æ³•å¯ä»¥åšåˆ°ï¼Œæœ€æ˜æ˜¾çš„å°±æ˜¯éå†ä»–çš„å†…å®¹ï¼Œå¹¶æŠŠæ¯ä¸ªå­—èŠ‚å•ç‹¬è¾“å‡ºï¼Œçœ‹è¿™ä¸ªforå¾ªç¯ï¼š\nfor i := 0; i \u0026lt; len(sample); i++ { fmt.Printf(\u0026quot;%x \u0026quot;, sample[i]) } å¦‚ä¸Šé¢å±•ç¤ºçš„ï¼Œé€šè¿‡ç´¢å¼•å¯ä»¥è·å–åˆ°å­—ç¬¦ä¸²çš„æ¯ä¸ªå­—èŠ‚ï¼Œè€Œä¸æ˜¯å­—ç¬¦ã€‚ä¸‹é¢æˆ‘ä»¬å†ç»†è‡´çš„çœ‹çœ‹å¾ªç¯è¾“å‡ºçš„å­—èŠ‚ï¼š\nbd b2 3d bc 20 e2 8c 98 æ³¨æ„ä¸€ä¸‹æ¯ä¸ªå­—èŠ‚æ˜¯å¦‚ä½•å’Œä¸å­—ç¬¦ä¸²ä¸­å®šä¹‰çš„16è¿›åˆ¶å€¼å¯¹åº”çš„ã€‚\nä¸€ä¸ªæ›´çŸ­çš„äº§ç”Ÿå¯è§‚è¾“å‡ºçš„æ–¹æ³•æ˜¯ä½¿ç”¨fmtçš„%Xï¼ˆ16è¿›åˆ¶ï¼‰æ ¼å¼ã€‚å®ƒä¼šä»¥16è¿›åˆ¶è¾“å‡ºå­—ç¬¦ä¸²çš„å­—èŠ‚åºåˆ—ï¼Œæ¯ä¸ªå­—èŠ‚æ˜¯ä¸¤ä½ï¼š\nfmt.Printf(\u0026quot;%x\\n\u0026quot;, sample) å®ƒçš„è¾“å‡ºæ˜¯ï¼š\nbdb23dbc20e28c98 ä¸€ä¸ªå°æŠ€å·§æ˜¯åœ¨%å’Œxä¸­é—´æ·»åŠ ç©ºæ ¼ï¼Œæ¯”è¾ƒä¸€ä¸‹åŒºåˆ«ï¼š\nfmt.Printf(\u0026quot;% x\\n\u0026quot;, sample) æ³¨æ„ä¸‹å­—èŠ‚é—´å¦‚ä½•æ‰“å°ç©ºæ ¼çš„ï¼š\nbd b2 3d bc 20 e2 8c 98 ä½¿ç”¨%qå¯ä»¥è½¬ä¹‰è¾“å‡ºæ— æ³•æ˜¾ç¤ºçš„å­—èŠ‚ï¼Œè¿™æ ·è¾“å‡ºå°±ä¼šå¾ˆæ¸…æ™°ï¼š\nfmt.Printf(\u0026quot;%q\\n\u0026quot;, sample) å½“å¤§å¤šæ•°å­—ç¬¦ä¸²éƒ½å¾ˆæ­£å¸¸è€Œæœ‰ä¸€äº›åŒ…å«äº†ç‰¹æ®Šç¬¦å·éœ€è¦å‰”é™¤æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•å¾ˆæ–¹ä¾¿ï¼Œå®ƒä¼šäº§ç”Ÿï¼š\n\u0026quot;\\xbd\\xb2=\\xbc âŒ˜\u0026quot; å¦‚æœæˆ‘ä»¬ä»”ç»†çœ‹å®ƒï¼Œä¼šå‘ç°åœ¨ä¹±ç ä¸­æœ‰ä¸€ä¸ªASCIIçš„ç­‰å·ï¼Œè¿˜æœ‰ä¸€ä¸ªæ­£å¸¸çš„ç©ºæ ¼ï¼Œæœ€åæœ‰ä¸ªå¾ˆè‘—åçš„â€œPlace of Interestâ€ ç¬¦å·ã€‚è¿™ä¸ªç¬¦å·çš„unicodeç¼–ç æ˜¯U+2318ï¼Œåœ¨ç©ºæ ¼ï¼ˆ16è¿›åˆ¶å€¼æ˜¯20ï¼‰åé¢ç”¨UTF-8ç¼–ç ï¼še2 8c 98.\nå¦‚æœæˆ‘ä»¬ä¸ç†Ÿæ‚‰æˆ–è¢«å­—ç¬¦ä¸²ä¸­çš„å¥‡æ€ªä¸œè¥¿ç»•æ™•äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨+å·ç»“åˆ%qã€‚è¿™ä¸ªç»„åˆä¼šè¾“å‡ºä¸å¯æ‰“å°çš„å­—ç¬¦çš„è½¬ä¹‰æ ¼å¼ï¼Œä»¥åŠéASCIIå­—ç¬¦çš„è½¬ä¹‰æ ¼å¼ï¼Œè¿™äº›æ ¼å¼éƒ½æ˜¯UTF-8çš„. éASCIIæ•°æ®ä¼šä»¥åˆé€‚çš„UTF-8ç¼–ç æ‰“å°å‡ºæ¥ï¼š\nfmt.Printf(\u0026quot;%+q\\n\u0026quot;, sample) è¿™ç§æ ¼å¼ä¸‹ï¼Œunicodeæ ¼å¼çš„â€œPlace of Interestâ€ ç¬¦å·ä¼šè¢«å±•ç¤ºä¸ºå¸¦\\uè½¬ä¹‰åºåˆ—ï¼š\n\u0026quot;\\xbd\\xb2=\\xbc \\u2318\u0026quot; è¿™ç§æ‰“å°çš„æ–¹æ³•éå¸¸é€‚åˆå­—ç¬¦ä¸²å†…å®¹çš„debugï¼Œä¸‹é¢è®¨è®ºçš„æ—¶å€™ä¹Ÿä¼šå¾ˆæ–¹ä¾¿ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ‰€æœ‰è¿™äº›æ–¹æ³•åº”ç”¨åœ¨å­—èŠ‚sliceæˆ–å­—ç¬¦ä¸²ä¸­æ—¶è¡¨ç°ä¸€è‡´ã€‚\nè¿™æ˜¯æˆ‘ä»¬æåŠçš„æ‰€æœ‰æ‰“å°æ–¹æ³•ï¼Œä½ å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¯•è¯•è¿è¡Œï¼š\npackage main import \u0026quot;fmt\u0026quot; func main() { const sample = \u0026quot;\\xbd\\xb2\\x3d\\xbc\\x20\\xe2\\x8c\\x98\u0026quot; fmt.Println(\u0026quot;Println:\u0026quot;) fmt.Println(sample) fmt.Println(\u0026quot;Byte loop:\u0026quot;) for i := 0; i \u0026lt; len(sample); i++ { fmt.Printf(\u0026quot;%x \u0026quot;, sample[i]) } fmt.Printf(\u0026quot;\\n\u0026quot;) fmt.Println(\u0026quot;Printf with %x:\u0026quot;) fmt.Printf(\u0026quot;%x\\n\u0026quot;, sample) fmt.Println(\u0026quot;Printf with % x:\u0026quot;) fmt.Printf(\u0026quot;% x\\n\u0026quot;, sample) fmt.Println(\u0026quot;Printf with %q:\u0026quot;) fmt.Printf(\u0026quot;%q\\n\u0026quot;, sample) fmt.Println(\u0026quot;Printf with %+q:\u0026quot;) fmt.Printf(\u0026quot;%+q\\n\u0026quot;, sample) } UTF-8å’Œå­—ç¬¦ä¸²å­—é¢å€¼ å¦‚æˆ‘ä»¬æ‰€è§ï¼Œç´¢å¼•ä¸€ä¸ªå­—ç¬¦ä¸²ä¼šè·å¾—å®ƒçš„å­—èŠ‚ï¼Œè€Œä¸æ˜¯å­—ç¬¦ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²åªæ˜¯ä¸€ä¸²çš„å­—èŠ‚è€Œå·²ã€‚è¿™æ„å‘³ç€å½“æˆ‘ä»¬åœ¨å­—ç¬¦ä¸²ä¸­å­˜å‚¨ä¸€ä¸ªå­—ç¬¦æ—¶ï¼Œæˆ‘ä»¬åŒæ—¶å­˜äº†å®ƒçš„å­—èŠ‚è¡¨ç¤ºã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªæ›´ç»†è‡´çš„ä¾‹å­ï¼š\nè¿™æ˜¯ä¸€ä¸ªå°ç¨‹åºï¼Œå®ƒæŒ‰ç…§ä¸‰ç§ä¸åŒçš„æ–¹å¼æ‰“å°äº†åªæœ‰ä¸€ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œä¸€ç§æŒ‰ç…§å­—ç¬¦ä¸²æ‰“å°ï¼Œä¸€ç§åªæ‰“å°ASCIIå­—ç¬¦ï¼Œä¸€ç§æŒ‰ç…§16è¿›åˆ¶æ‰“å°æ¯ä¸€ä¸ªå­—èŠ‚ã€‚ä¸ºäº†é¿å…æ··æ·†ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåŸå§‹å­—ç¬¦ä¸²ï¼Œç”±åå¼•å·å›´èµ·æ¥ï¼Œè¿™æ ·å®ƒå°±åªèƒ½åŒ…å«å­—é¢å€¼ï¼ˆå¦‚æœæ˜¯æ™®é€šçš„å­—ç¬¦ä¸²ï¼Œç”±äºè¢«åŒå¼•å·åŒ…å›´ï¼Œå¯èƒ½ä¼šåŒ…å«ä¸Šé¢æåˆ°çš„è½¬ä¹‰åºåˆ—ï¼‰\nfunc main() { const placeOfInterest = `âŒ˜` fmt.Printf(\u0026quot;plain string: \u0026quot;) fmt.Printf(\u0026quot;%s\u0026quot;, placeOfInterest) fmt.Printf(\u0026quot;\\n\u0026quot;) fmt.Printf(\u0026quot;quoted string: \u0026quot;) fmt.Printf(\u0026quot;%+q\u0026quot;, placeOfInterest) fmt.Printf(\u0026quot;\\n\u0026quot;) fmt.Printf(\u0026quot;hex bytes: \u0026quot;) for i := 0; i \u0026lt; len(placeOfInterest); i++ { fmt.Printf(\u0026quot;%x \u0026quot;, placeOfInterest[i]) } fmt.Printf(\u0026quot;\\n\u0026quot;) } è¾“å‡ºæ˜¯ï¼š\nplain string: âŒ˜ quoted string: \u0026quot;\\u2318\u0026quot; hex bytes: e2 8c 98 è¿™æé†’äº†æˆ‘ä»¬U+2318æ˜¯â€œPlace of Interestâ€ ç¬¦å· âŒ˜çš„unicodeç¼–å·ï¼Œå¹¶ä¸”ç”±å­—èŠ‚è¡¨ç¤ºä¸ºe2 8c 98ï¼Œè¿™äº›å­—èŠ‚æ˜¯16è¿›åˆ¶æ•°2318æŒ‰ç…§UTF-8ç¼–ç åçš„å­—èŠ‚è¡¨ç¤ºã€‚\nä¾èµ–äºä½ å¯¹UTF-8çš„ç†Ÿæ‚‰ç¨‹åº¦ï¼Œä½ å¯èƒ½å¾ˆæ¸…æ¥šè¿™äº›æˆ–è€…æœ‰ç‚¹æ¨¡ç³Šï¼Œä½†æ˜¯èŠ±ç‚¹æ—¶é—´è§£é‡Šä¸€ä¸‹UTF-8æ˜¯å¦‚ä½•è¡¨ç¤ºæˆ‘ä»¬åˆ›å»ºçš„å­—ç¬¦ä¸²æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚æœ€ç®€å•çš„äº‹å®æ˜¯ï¼šå½“æºç å†™å…¥æ—¶ï¼Œå®ƒå°±åˆ›å»ºå‡ºæ¥äº†ã€‚\næºç åœ¨Goä¸­è¢«å®šä¹‰ä¸ºUTF-8æ–‡æœ¬ï¼Œå¹¶ä¸”ä¸å…è®¸å…¶ä»–æ ¼å¼çš„è¡¨ç¤ºã€‚è¿™æ„å‘³ç€åœ¨æºç ä¸­ï¼Œå½“æˆ‘ä»¬è¾“å…¥ï¼š âŒ˜ æ—¶ï¼Œæ–‡æœ¬ç¼–è¾‘å™¨ä¼šæŠŠâŒ˜ç¬¦å·çš„UTF-8ç¼–ç å­˜å…¥æºç ä¸­ï¼Œå½“æˆ‘ä»¬è¾“å‡º16è¿›åˆ¶å­—èŠ‚æ—¶ï¼Œæˆ‘ä»¬åªæ˜¯å¤åˆ¶è¾“å‡ºäº†æ–‡ä»¶ä¸­ç¼–è¾‘å™¨æ”¾å…¥çš„æ•°æ®ã€‚\næ›´ç²¾ç®€ç‚¹æ¥è¯´ï¼ŒGoè¯­è¨€æºç æ˜¯UTF-8ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²å­—é¢é‡çš„æºç å°±æ˜¯UTF-8æ–‡æœ¬ã€‚å¦‚æœå­—ç¬¦ä¸²å­—é¢å€¼ä¸åŒ…å«è½¬ä¹‰åºåˆ—ï¼ˆåå¼•å·æ„å»ºçš„åŸå§‹å­—ç¬¦ä¸²ä¸èƒ½åŒ…å«è½¬ä¹‰å­—ç¬¦ï¼‰ï¼Œæ„é€ å‡ºæ¥çš„å­—ç¬¦ä¸²å¼•å·ä¸­é—´çš„æ–‡æœ¬å°±æ˜¯æºç æ–‡æœ¬ã€‚å› æ­¤åŸå§‹å­—ç¬¦ä¸²æ€»æ˜¯ä¼šåŒ…å«åˆæ³•çš„UTF-8æ–‡æœ¬ã€‚ç±»ä¼¼çš„ï¼Œæ™®é€šå­—ç¬¦ä¸²ç»å¸¸ç”±åˆæ³•çš„UTF-8æ–‡æœ¬ç»„æˆï¼Œé™¤éå®ƒåŒ…å«ä¸Šé¢æåˆ°çš„ä¸åœ¨UTF-8ç¼–ç ä¸­çš„è½¬ä¹‰åºåˆ—ã€‚\nè¯‘æ³¨ï¼š\nåå¼•å· `` ç»„æˆçš„å­—ç¬¦ä¸²ä¸ä¼šè¿›è¡Œè½¬ä¹‰å¤„ç†ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²å†…å®¹=å­˜å…¥çš„æºç \næ™®é€šå­—ç¬¦ä¸² \u0026quot;\u0026quot; ä¼šè¿›è¡Œè½¬ä¹‰å¤„ç†ï¼Œæ¯”å¦‚\\x2bä¼šè¯†åˆ«æˆä¸€ä¸ª16è¿›åˆ¶æ•°æ®å­˜å…¥ï¼Œè€Œä¸æ˜¯å­˜å…¥\\ã€xã€2ã€bã€‚å¦‚æœè¿™ä¸ª16è¿›åˆ¶æ•°ä¸åœ¨UTF-8ç¼–ç ä¸­ï¼Œé‚£å°±æ˜¯éæ³•çš„UTF-8ç¼–ç ï¼Œæ— æ³•è¢«æ‰“å°å‡ºæ¥ã€‚\nä¸€äº›äººè®¤ä¸ºGoå­—ç¬¦ä¸²æ€»æ˜¯UTF-8ç¼–ç ï¼Œå…¶å®ä¸æ˜¯ï¼šåªæœ‰å­—ç¬¦ä¸²å­—é¢å€¼æ˜¯UTF-8ç¼–ç .æ­£å¦‚æˆ‘ä»¬ä¸Šé¢æåˆ°çš„ï¼Œå­—ç¬¦ä¸²å€¼å¯ä»¥åŒ…å«ä»»æ„çš„å­—èŠ‚ï¼›å­—ç¬¦ä¸²å­—é¢å€¼åªè¦æ²¡æœ‰å­—èŠ‚ç­‰çº§çš„è½¬ä¹‰å°±æ€»æ˜¯UTF-8æ–‡æœ¬ã€‚\næ€»ç»“æ¥è¯´ï¼Œå­—ç¬¦ä¸²å¯ä»¥åŒ…å«ä»»æ„å­—èŠ‚ï¼Œä½†æ˜¯ä»å­—é¢å€¼æ„å»ºæ—¶ï¼Œè¿™äº›å­—èŠ‚é€šå¸¸éƒ½æ˜¯UTF-8ç¼–ç çš„ã€‚\nCode pointsã€å­—ç¬¦ã€runes ç›®å‰ä¸ºæ­¢æˆ‘ä»¬éƒ½å¾ˆå°å¿ƒåœ°ä½¿ç”¨å•è¯â€œå­—èŠ‚â€å’Œâ€œå­—ç¬¦â€ã€‚ä¸€éƒ¨åˆ†åŸå› æ˜¯å› ä¸ºå­—ç¬¦ä¸²åŒ…å«å­—èŠ‚ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯å› ä¸ºå­—ç¬¦è¿™ä¸ªæ¦‚å¿µæœ‰ç‚¹éš¾ä»¥å®šä¹‰ã€‚Unicodeæ ‡å‡†ä½¿ç”¨â€œCode pointâ€å®šä¹‰å•ä¸€å€¼è¡¨ç¤ºçš„ä¸œè¥¿ï¼Œæ¯”å¦‚Code points U+2318ï¼Œ16è¿›åˆ¶å€¼2318ï¼Œä»£è¡¨äº†âŒ˜ç¬¦å·ï¼ˆæ›´å¤šCode pointå‚è€ƒUnicode pageï¼‰\nä¸€ä¸ªæ›´æ™®é€šåœ°ä¾‹å­æ˜¯Unicode Code point U+0061æ˜¯å°å†™å­—æ¯ï¼ša\nä½†æ˜¯å°å†™é‡éŸ³å­—æ¯Ã å¦‚ä½•è¡¨ç¤ºï¼Ÿè¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Œä¹Ÿæ˜¯Code point U+00E0ï¼Œä½†æ˜¯å®ƒæœ‰å…¶ä»–è¡¨ç¤ºæ–¹æ³•ã€‚æ¯”å¦‚æˆ‘ä»¬å¯ä»¥ç»“åˆé‡éŸ³Code pointï¼ŒU+0300ï¼Œé™„åŠ åˆ°å°å†™å­—æ¯aï¼ŒU+0061ä¸Šï¼Œæ„å»ºå‡ºåŒæ ·çš„å­—ç¬¦Ã ã€‚é€šå¸¸æ¥è¯´ä¸€ä¸ªå­—ç¬¦å¯ä»¥è¢«å¤šç§ä¸åŒçš„Code pointç»„åˆè¡¨ç¤ºï¼Œå› æ­¤æœ‰ä¸åŒçš„UTF-8å­—èŠ‚åºåˆ—ã€‚\nå› æ­¤è®¡ç®—æœºçš„å­—ç¬¦æ¦‚å¿µæ˜¯æ¨¡ç³Šçš„ï¼Œæˆ–è€…å®¹æ˜“æ··æ·†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°å¿ƒä½¿ç”¨ã€‚ä¸ºäº†è®©ä»–æ›´å¯é ï¼Œæœ‰ä¸€äº›æ ‡å‡†åŒ–æŠ€æœ¯å¯ä»¥ä¿è¯ä¸€ä¸ªå­—ç¬¦åªæœ‰ä¸€ç§Code pointçš„è¡¨ç¤ºæ–¹å¼ï¼Œä½†æ˜¯è¿™ä¸ªä¸»é¢˜ä¸åœ¨æˆ‘ä»¬è®¨è®ºçš„èŒƒå›´å†…ï¼Œä¹‹åä¼šæœ‰ä¸€ä¸ªæ–°çš„blogä»‹ç»Goåº“æ˜¯å¦‚ä½•å¤„ç†æ ‡å‡†åŒ–çš„ã€‚\nâ€œCode pointâ€æœ‰ç‚¹ç»•å£ï¼Œä¸ºæ­¤åœ¨Goä¸­æœ‰ä¸ªæ›´çŸ­çš„æœ¯è¯­ï¼šruneã€‚è¿™ä¸ªæœ¯è¯­ä¼šåœ¨åº“å’Œæºç ä¸­å‡ºç°ï¼Œå’ŒCode pointæ„æ€ç›¸åŒï¼Œä½†æœ‰ä¸€ä¸ªæ–°çš„ç‰¹ç‚¹ã€‚\nGoè¯­è¨€ä¸­runeæ˜¯ç±»å‹int32çš„åˆ«åï¼Œæ‰€ä»¥ç¨‹åºå¯ä»¥ç†è§£ä¸€ä¸ªintç±»å‹çš„æ•°å€¼è¡¨ç¤ºä¸ºCode pointçš„çŠ¶å†µã€‚é™¤æ­¤ä»¥å¤–ï¼Œä¸€ä¸ªå­—ç¬¦å¸¸é‡åœ¨Goä¸­å…¶å®è¢«ç§°ä¸ºä¸€ä¸ªruneå¸¸é‡ã€‚\n'âŒ˜' è¿™ä¸ªç¬¦å·çš„ç±»å‹æ˜¯runeï¼Œå€¼æ˜¯æ•´å‹çš„0x2318.\næ€»çš„æ¥è¯´ï¼Œè¿™æ˜¯å‡ ä¸ªé‡ç‚¹ï¼š\nGoæºç æ€»æ˜¯UTF-8çš„ ä¸€ä¸ªå­—ç¬¦ä¸²å¯ä»¥åŒ…å«ä»»æ„å­—èŠ‚ ä¸€ä¸ªå­—ç¬¦ä¸²å­—é¢å€¼å¦‚æœæ²¡æœ‰å­—èŠ‚å±‚é¢çš„è½¬ä¹‰ï¼Œé‚£å°±æ˜¯åˆæ³•çš„UTF-8åºåˆ—ã€‚ è¿™äº›åºåˆ—ä»£è¡¨äº†unicodeçš„Code pointï¼Œä¹Ÿå°±æ˜¯runeã€‚ æ— æ³•ä¿è¯Goä¸­å­—ç¬¦ä¸²çš„å­—ç¬¦æ˜¯æ ‡å‡†åŒ–è¿‡çš„ã€‚ for rangeå¾ªç¯ é™¤äº†ä¸è¨€è‡ªæ˜çš„ä¸€ä¸ªç»†èŠ‚â€”â€”goæºç æ˜¯UTF-8ç¼–ç çš„ï¼Œåªæœ‰åœ¨ä¸€ç§æƒ…å†µä¸‹ï¼Œgoä¼šç‰¹æ®Šå¤„ç†UTF-8ç¼–ç ï¼Œé‚£å°±æ˜¯å½“ä½ å¯¹å­—ç¬¦ä¸²ä½¿ç”¨for rangeå¾ªç¯çš„æ—¶å€™ã€‚\næˆ‘ä»¬çŸ¥é“æ™®é€šçš„forå¾ªç¯ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œå¯¹äºfor rangeå¾ªç¯ï¼Œæ¯æ¬¡éå†æ—¶éƒ½ä¼šè§£ç ä¸€ä¸ªUTF-8çš„runeã€‚æ¯æ¬¡å¾ªç¯æ—¶ï¼Œä¸‹æ ‡æ˜¯å½“å‰runeçš„å¼€å§‹ä½ç½®ï¼Œæµ‹é‡å•ä½æ˜¯å­—èŠ‚ï¼Œcode pointå°±æ˜¯ä»–çš„å€¼ã€‚è¿™ä¸ªä¾‹å­ä½¿ç”¨äº†å¦ä¸€ä¸ªæ‰“å°æ ¼å¼%#Uï¼Œå¯ä»¥æ‰“å°unicodeç¼–ç å’Œä»£è¡¨çš„å­—ç¬¦ï¼š\nconst nihongo = \u0026quot;æ—¥æœ¬èª\u0026quot; for index, runeValue := range nihongo { fmt.Printf(\u0026quot;%#U starts at byte position %d\\n\u0026quot;, runeValue, index) } è¾“å‡ºä¼šæ˜¾ç¤ºæ¯ä¸ªcode pointå æ®äº†å¤šä¸ªå­—èŠ‚ï¼š\nU+65E5 'æ—¥' starts at byte position 0 U+672C 'æœ¬' starts at byte position 3 U+8A9E 'èª' starts at byte position 6 æ ‡å‡†åº“ Goçš„æ ‡å‡†åº“å¯¹è§£é‡ŠUTF-8æ–‡æœ¬æä¾›äº†å¼ºå¤§æ”¯æŒã€‚å¦‚æœfor rangeå¾ªç¯å¯¹ä½ æ¥è¯´ä¸å¤Ÿç”¨ï¼Œé‚£ä¹ˆå¯ä»¥è¯•è¯•åº“é‡Œçš„åŒ…ã€‚\næœ€é‡è¦çš„åŒ…æ˜¯unicode/utf8ï¼Œæä¾›äº†UTF-8å­—ç¬¦ä¸²çš„éªŒè¯ã€æ‹†åˆ†ã€ç»„è£…æ–¹æ³•ã€‚è¿™ä¸ªç¨‹åºç­‰åŒäºä¸Šé¢çš„for rangeå¾ªç¯ï¼Œä½†æ˜¯ä½¿ç”¨äº†DecodeRuneInStringæ–¹æ³•å®ç°ã€‚è¿”å›å€¼æ˜¯runeå’Œä»–çš„UTF-8ç¼–ç å­—èŠ‚ä¸ªæ•°ã€‚\nconst nihongo = \u0026quot;æ—¥æœ¬èª\u0026quot; for i, w := 0, 0; i \u0026lt; len(nihongo); i += w { runeValue, width := utf8.DecodeRuneInString(nihongo[i:]) fmt.Printf(\u0026quot;%#U starts at byte position %d\\n\u0026quot;, runeValue, i) w = width } è¿è¡Œå¯ä»¥çœ‹åˆ°ç»“æœç›¸åŒã€‚for rangeå¾ªç¯å’ŒDecodeRuneInString æ–¹æ³•ä¼šäº§ç”Ÿç›¸åŒçš„è¿­ä»£ç»“æœã€‚\nè¿™ä¸ªåŒ…çš„å…¶ä»–æ–¹æ³•è¯·æŸ¥çœ‹unicode/utf8æ–‡æ¡£\nç»“è®º å›ç­”ä¸€ä¸‹æ–‡ç« å¼€å§‹æå‡ºçš„é—®é¢˜ï¼šå­—ç¬¦ä¸²ç”±å­—èŠ‚ç»„æˆï¼Œå› æ­¤ç´¢å¼•å­—ç¬¦ä¸²ä¼šè·å¾—å­—èŠ‚ï¼Œè€Œä¸æ˜¯å­—ç¬¦ã€‚ä¸€ä¸ªå­—ç¬¦ä¸²ç”šè‡³å¯èƒ½ä¸åŒ…å«å­—ç¬¦ã€‚å®é™…ä¸Šâ€œå­—ç¬¦â€çš„å®šä¹‰å°±æ˜¯æ¨¡ç³Šçš„ï¼Œå¦‚æœä½ æŠŠå­—ç¬¦ä¸²å®šä¹‰ä¸ºç”±å­—ç¬¦ç»„æˆï¼Œä½ å¯èƒ½ä¼šé‡åˆ°ä¸€äº›æ¨¡ç³Šæ€§é—®é¢˜ã€‚\nè¿˜æœ‰å¾ˆå¤šå…³äºunicodeï¼ŒUTF-8å’Œå¤šè¯­è¨€æ–‡æœ¬å¤„ç†çš„ä¸œè¥¿å¯ä»¥è®²ï¼Œä½†æ˜¯è¯·ç­‰ä¸‹ä¸€ä¸ªblogå§ï¼Œç°åœ¨æˆ‘å¸Œæœ›ä½ æ›´ç†è§£Goçš„å­—ç¬¦ä¸²å¦‚ä½•å‘ˆç°çš„äº†ï¼Œå³ä½¿å®ƒä»¬å¯èƒ½åŒ…å«ä»»æ„çš„å­—èŠ‚ï¼Œå®ƒçš„æ ¸å¿ƒè®¾è®¡çš„ä¸€éƒ¨åˆ†ä»æ—§æ˜¯UTF-8ç¼–ç .\n","date":"2022-10-07T12:16:11+08:00","permalink":"https://chajiuqqq.github.io/blogs/p/golang%E4%B8%AD%E7%9A%84strings-bytes-runes%E5%92%8Ccharacters/","title":"GoLangä¸­çš„Strings, bytes, runeså’Œcharacters"},{"content":"Cloudflare Tunnelå¯ä»¥å®ç°é€šè¿‡åŸŸåè®¿é—®æœ¬åœ°æš´éœ²çš„æœåŠ¡åŠŸèƒ½ï¼Œç±»ä¼¼frpåšçš„éš§é“ï¼Œä½†æ˜¯ä¸ç”¨è‡ªå·±æ­å»ºæœåŠ¡ç«¯ï¼Œåªè¦é…ç½®å¥½å®¢æˆ·ç«¯å³å¯ã€‚doc link\nä¸‹é¢è¯´ä¸€ä¸‹é…ç½®æ–¹å¼ã€‚\n1ã€Dashboardåˆ›å»ºtunnel é¦–å…ˆç»™å‡ºå®˜æ–¹æ•™ç¨‹ï¼Œç†Ÿæ‚‰è‹±æ–‡çš„å¯ä»¥ç›´æ¥çœ‹ link\nå»åˆ° Zero Trust dashboardï¼Œåœ¨Access \u0026gt; Tunnelsåˆ›å»ºtunnelã€‚\nå…ˆå–ä¸ªåå­— public hostname é‡Œæ·»åŠ è‡ªå®šä¹‰subdomainï¼Œdomainé€‰æ‹©åœ¨cloudflareç»‘å®šè¿‡çš„åŸŸåã€‚ å¦‚æœcloudflareæ²¡æœ‰åˆ›å»ºè¿‡websiteï¼Œåœ¨è¿™é‡Œåˆ›å»ºã€‚éœ€è¦è‡ªè¡Œç”³è¯·ä¸€ä¸ªåŸŸåï¼Œæ¨èfreenomï¼Œç„¶åä¿®æ”¹åŸŸånameserverä¸ºcloudflareçš„ï¼Œè¿™æ ·è¿™ä¸ªåŸŸåå°±å¯ä»¥ç”±cloudflareç®¡ç†äº†ã€‚\nserviceé€‰æ‹©ä½ è¦çš„æœåŠ¡ï¼Œä¸€èˆ¬æ˜¯httpï¼Œç„¶ååœ°å€ä¸€èˆ¬æ˜¯å†™127.0.0.1+æœ¬åœ°æœåŠ¡ç«¯å£å·ï¼Œå¦‚127.0.0.1:5000ã€‚ä¿å­˜åè¿™ä¸ªwebsiteè‡ªåŠ¨æ·»åŠ dnsè§£æåˆ°ä½ çš„æœ¬åœ°æœºå™¨ã€‚ è¿™é‡Œä¸å†éœ€è¦å»åŸŸådnså¤„æ‰‹åŠ¨æ·»åŠ äº†ï¼Œä»–è‡ªåŠ¨æ·»åŠ å¥½äº†\n2ã€è¿è¡Œcloudflaredå®¢æˆ·ç«¯ æˆ‘ä½¿ç”¨çš„æ˜¯ç¾¤æ™–nas+dockerç‰ˆï¼Œä¸»è¦æ˜¯å›¾å½¢åŒ–çš„dockeræ€ä¹ˆè¿è¡Œcloudflaredã€‚\nä¸‹è½½dockerå¥—ä»¶ åœ¨æ³¨å†Œè¡¨é‡Œæœç´¢cloudflaredå¹¶ä¸‹è½½ å¼€å¯å®¹å™¨ï¼Œéœ€è¦é…ç½®ä¸¤ä¸ªåœ°æ–¹ ç¯å¢ƒå˜é‡æ·»åŠ TUNNEL_TRANSPORT_PROTOCOLï¼Œå€¼ä¸ºhttp2ï¼Œå› ä¸ºé»˜è®¤çš„quicåè®®å›½å†…ä¸æ”¯æŒï¼Œéœ€è¦æ”¹æˆhttp2 ä¸‹æ–¹å‘½ä»¤è¾“å…¥åˆ›å»ºtunnelæ—¶dockerä¸‹çš„æç¤ºéƒ¨åˆ†ï¼Œå¦‚docker run cloudflare/cloudflared:latest tunnel --no-autoupdate run --token eyJhIjoiZjYyMDUyMjxxxxxä½ å°±å¤åˆ¶tunnel --no-autoupdate run --token eyJhIjoiZjYyMDUyMjxxxxxè¿›å» Zero Trust dashboardçš„tunnelé‡Œçœ‹åˆ°activeå°±è¯´æ˜è¿ä¸Šäº† 3ã€è®¿é—®subdominå°±ä¼šä»£ç†åˆ°ä½ æœ¬åœ°çš„æœåŠ¡ å¦‚æˆ‘çš„nasåŸŸåè®¾ç½®äº†https://nas.ipppz.tk/ï¼Œå¹¶è½¬å‘åˆ°nasçš„5000ç«¯å£ï¼Œæ¥ä¸‹æ¥å°±ç›´æ¥ç”¨åŸŸåè®¿é—®å³å¯ï¼Œä¹Ÿæ˜¯æ”¯æŒhttpsçš„ã€‚\n","date":"2022-10-01T13:31:05+08:00","permalink":"https://chajiuqqq.github.io/blogs/p/%E4%BD%BF%E7%94%A8cloudflare-tunnel%E5%AE%9E%E7%8E%B0%E6%9C%AC%E5%9C%B0%E6%9C%8D%E5%8A%A1%E6%9A%B4%E9%9C%B2/","title":"ä½¿ç”¨Cloudflare Tunnelå®ç°æœ¬åœ°æœåŠ¡æš´éœ²"},{"content":"åº”è¯¥ç®—æ˜¯ç¬¬ä¸€ç¯‡æ¯”è¾ƒæ­£å¼çš„blogå§ï¼Œå‰å‡ å¤©æŠŠbolgæ­èµ·æ¥äº†ï¼Œä»Šå¤©åˆå®ç°äº†æŒç»­é›†æˆï¼Œå¯ä»¥å®ç°ä¸€ä¸ªä»“åº“ä¿å­˜blogså’Œç½‘ç«™é¡µé¢ï¼Œå¹¶åœ¨æ›´æ–°çš„æ—¶å€™è‡ªåŠ¨æ„å»º+éƒ¨ç½²ç½‘ç«™ã€‚è¿™ç§æ„å»ºæ–¹å¼æœ€å¤§çš„å¥½å¤„æ˜¯å…è´¹+èµ„æ–™æŒæ¡+è‡ªåŠ¨éƒ¨ç½²ï¼Œé‚£ä¸‹é¢å°±æ¥ä»‹ç»ä¸€ä¸‹æ€ä¹ˆå®ç°ã€‚\nä½¿ç”¨æµç¨‹ åœ¨å¤šå°è®¾å¤‡ä¸Šå¯cloneä¸€ä¸ªä»“åº“ï¼Œä½¿ç”¨hugoæˆ–æ‰‹åŠ¨åœ¨content/postä¸‹æ–°å»ºmdæ–‡ä»¶æ”¥å†™æ–‡ç« ï¼Œå®Œæˆågitæäº¤å¹¶æ¨é€è¿œç¨‹ä»“åº“ï¼Œè¿œç¨‹ä»“åº“ä¼šè‡ªåŠ¨æ„å»ºç½‘ç«™ï¼Œç”¨æˆ·ç­‰ä¸€ä¼šå°±å¯ä»¥çœ‹åˆ°ç½‘ç«™æ›´æ–°äº†ã€‚\nç¼–å†™ç¯å¢ƒåªè¦æœ‰gitå³å¯å®Œæˆç¼–å†™+éƒ¨ç½²æµç¨‹ï¼ˆå½“ç„¶æ·»åŠ äº†hugoåœ¨åˆ›å»ºæ–‡ç« æ—¶ä¼šæ›´æ–¹ä¾¿å•¦ï¼Œè€Œä¸”å¯ä»¥æœ¬åœ°çœ‹åˆ°æ•ˆæœï¼‰ã€‚\næ­å»ºé€»è¾‘ åšå®¢å¯ä»¥æ˜¯é™æ€çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯åŠ¨æ€çš„ã€‚é™æ€çš„å°±æ˜¯ä¸€å †ç”±HTMLå’ŒCSSã€JSç»„æˆçš„æ–‡ä»¶ç›´æ¥è¢«æµè§ˆå™¨è®¿é—®ï¼Œæ²¡æœ‰åå°ç¨‹åºæä¾›ä¸šåŠ¡æ”¯æŒï¼Œå¥½å¤„æ˜¯ä¸åƒèµ„æºï¼Œè®¿é—®åªå—ç½‘ç»œå¸¦å®½é™åˆ¶ï¼Œåå¤„æ˜¯æ²¡æ³•åšä¸šåŠ¡å¤„ç†äº†ï¼›\nåŠ¨æ€æŒ‡çš„æ˜¯ç”±å‰ç«¯+åç«¯ç»„åˆæ”¯æŒçš„ç½‘ç«™ï¼Œå¥½å¤„æ˜¯å¯ä»¥åšè‡ªç”±çš„ä¸šåŠ¡å’Œç®¡ç†ï¼Œåå¤„æ˜¯éƒ¨ç½²éº»çƒ¦ï¼Œå¯¹èµ„æºéœ€æ±‚å¤§ï¼Œå¹¶å‘è®¿é—®å—åˆ°æœåŠ¡å™¨æ€§èƒ½é™åˆ¶ã€‚\nä¸ºäº†ä¾¿äºç»´æŠ¤ï¼Œæœ¬æ–‡æ­å»ºçš„æ˜¯é™æ€ç½‘ç«™ã€‚\né‡‡ç”¨æŠ€æœ¯æ˜¯\nMarkdownï¼šæ–‡ç« ç¼–å†™è¯­æ³• Hugoï¼šé™æ€ç½‘ç«™ç¼–è¯‘å·¥å…· GitHub Pageï¼šç½‘é¡µæ‰˜ç®¡ GitHub Actionï¼šè‡ªåŠ¨æ„å»ºæœåŠ¡ Hugoçš„ä½¿ç”¨é€»è¾‘æ˜¯ï¼Œæˆ‘ä»¬ç¼–å†™markdownæ ¼å¼æ–‡ç« ï¼Œå¹¶é™„åŠ æŸç§æ ¼å¼çš„æ•°æ®ï¼Œå†™å¥½åäº¤ç»™Hugoå·¥å…·â€œæ„å»ºâ€ç”Ÿæˆé™æ€çš„HTMLå’ŒCSSã€JSç»„æˆçš„æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶ç»Ÿä¸€æ”¾åœ¨publicæ–‡ä»¶å¤¹ä¸‹ï¼Œæ­¤æ—¶éƒ¨ç½²publicå°±å¯ä»¥çœ‹åˆ°ä½ çš„ç½‘ç«™äº†ã€‚\nå…¶ä¸­ä¸€ä¸ªç¼ºç‚¹æ˜¯æ¯æ¬¡éœ€è¦Hugoçš„ç¯å¢ƒæ¥â€œæ„å»ºâ€ï¼Œå¹¶éœ€è¦ç»´æŠ¤ä¸¤å¥—ä»£ç ï¼šæ–‡ç« æºä»£ç å’Œç½‘ç«™ä»£ç \nå½“ç»“åˆGithub Actionæ—¶ï¼Œå¯ä»¥æŠŠè¿™ä¸ªæ„å»ºè¿‡ç¨‹äº¤ç»™äº‘ç«¯å¤„ç†ã€‚æ¯æ¬¡ä¸»åˆ†æ”¯æ¨é€æ—¶éƒ½ä¼šè§¦å‘è¿™ä¸ªâ€œæ„å»ºâ€ï¼ŒåŒæ—¶æŠŠpublicä¸‹çš„æ–‡ä»¶æ¨é€åˆ°gh-pageåˆ†æ”¯ï¼Œåˆ©ç”¨Github PageæŒ‚è½½ä½ çš„ç½‘ç«™ï¼Œè¿™æ ·ç½‘ç«™å°±æ›´æ–°å¥½å¹¶å¯ä»¥æµè§ˆäº†ã€‚\næ­å»ºæ­¥éª¤ 1ã€å®‰è£…hugo Hugoæ²¡æœ‰ä¸€é”®å®‰è£…åŒ…ï¼Œå¯ä»¥ä½¿ç”¨åŒ…ç®¡ç†å·¥å…·å®‰è£…ï¼ŒMacOSç”¨brewï¼ŒWindowsç”¨chocolateyã€‚å„ä¸ªç³»ç»Ÿå®‰è£…çœ‹è¿™\n1 2 3 4 5 MacOS: brew install hugo Windows: choco install hugo -confirm å®‰è£…å®Œæˆåä½¿ç”¨hugo new site quickstartåˆ›å»ºquickstartæ–‡ä»¶å¤¹ä½œä¸ºç½‘ç«™ä¸»ç›®å½•ã€‚\nè¿›å…¥ç›®å½•ï¼Œä½¿ç”¨hugo new posts/my-first-post.mdåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ç« ã€‚ç„¶åæŠŠdraft: trueåˆ é™¤æˆ–è€…æ”¹ä¸ºdraft: falseï¼Œè¿™æ ·å°±å…¬å¼€æ–‡ç« å’¯ã€‚\nä½¿ç”¨hugo serverå¯ä»¥åœ¨æœ¬åœ°éƒ¨ç½²ç½‘ç«™ï¼Œè®¿é—® http://localhost:1313/ å°±å¯ä»¥çœ‹åˆ°ç½‘ç«™å’¯ï¼\næ›´å¤šHugoä½¿ç”¨æ•™ç¨‹å‚è€ƒè¿™ä¸ªã€‚\n2ã€æ·»åŠ Github Action å®˜æ–¹æ–‡æ¡£é‡Œæœ‰è¯´æ˜,è¿™é‡Œæ¦‚è¿°ä¸€ä¸‹ï¼š\nåœ¨ä½ çš„é¡¹ç›®ä¸‹åˆ›å»º.github/workflows/gh-pages.ymlè¿™ä¸ªè·¯å¾„çš„æ–‡ä»¶ å¤åˆ¶è¿™ä¸€æ®µè¿›å»,æ³¨æ„ä¸‹é¢ä¸¤ä¸ªmainçš„åœ°æ–¹ï¼Œå¦‚æœä½ ç”¨masterï¼Œåˆ™æ”¹æˆmaster 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 name: github pages on: push: branches: - main # Set a branch to deploy pull_request: jobs: deploy: runs-on: ubuntu-20.04 steps: - uses: actions/checkout@v2 with: submodules: true # Fetch Hugo themes (true OR recursive) fetch-depth: 0 # Fetch all history for .GitInfo and .Lastmod - name: Setup Hugo uses: peaceiris/actions-hugo@v2 with: hugo-version: \u0026#39;latest\u0026#39; # extended: true - name: Build run: hugo --minify - name: Deploy uses: peaceiris/actions-gh-pages@v3 if: github.ref == \u0026#39;refs/heads/main\u0026#39; with: github_token: ${{ secrets.GITHUB_TOKEN }} publish_dir: ./public 3ã€æ·»åŠ ä»“åº“ åˆå§‹åŒ–å¥½ç½‘ç«™åï¼Œä½¿ç”¨gitåˆå§‹åŒ–ä»“åº“ï¼Œå¹¶æäº¤ã€‚\n1 2 3 git init git add . git commit -m \u0026#34;init\u0026#34; åœ¨githubä¸Šåˆ›å»ºæ–°ä»“åº“ï¼Œè¿™ä¸ªä»“åº“åç§°å¯ä»¥æ˜¯ç”¨æˆ·å.github.ioï¼Œæˆ–è€…åˆ«çš„ã€‚æœ€åè®¿é—®åœ°å€æ˜¯ç”¨æˆ·å.github.ioæˆ–è€…ç”¨æˆ·å.github.io/ä»“åº“å.ä¸éœ€è¦readmeã€‚ç„¶åæœ¬åœ°ä»“åº“æ·»åŠ è¿œç¨‹ä»“åº“ï¼Œå¹¶æ¨é€ã€‚\næ¨é€æˆåŠŸåï¼ŒActionä¼šè‡ªåŠ¨buildç½‘ç«™å¹¶æ¨é€åˆ°gh-pagesåˆ†æ”¯ã€‚å› æ­¤æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªä»“åº“çš„ä¸åŒåˆ†æ”¯æ¥ç®¡ç†æ–‡ç« æºä»£ç å’Œç½‘ç«™ä»£ç ã€‚\n3ã€è®¾ç½®GitHub Page åœ¨é¡¹ç›®è®¾ç½®é‡Œé€‰æ‹©Pagesï¼Œåˆæ¬¡æ„å»ºéœ€è¦æŒ‡å®šå“ªä¸ªåˆ†æ”¯çš„ä»£ç ç”¨ä½œPageï¼Œé€‰æ‹©gh-pagesåˆ†æ”¯å¹¶ä¿å­˜å³å¯ï¼Œä¸Šæ–¹ä¼šç»™å‡ºå¯ä»¥è®¿é—®çš„åœ°å€ã€‚æˆ‘çš„ä»“åº“åç§°æ˜¯blogsï¼Œå› æ­¤åœ°å€æ˜¯ https://chajiuqqq.github.io/blogs/ ï¼Œè¯•è¯•è®¿é—®ä½ çš„ç½‘ç«™ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ç¯‡æ–‡ç« å’¯ã€‚\nå¦‚æœçœ‹å¾—åˆ°ç½‘ç«™ï¼Œä½†æ˜¯æ–‡ç« ç‚¹ä¸è¿›å»ï¼Œè¯·ä¿®æ”¹config.yamlï¼Œå°†baseurlæ¢æˆä½ çš„ç½‘ç«™åœ°å€å³å¯ï¼è¿™æ˜¯çº¿ä¸Šéƒ¨ç½²ç½‘ç«™å¿…è¦çš„æ­¥éª¤ï¼\nå¦‚ï¼š\n1 baseurl: https://chajiuqqq.github.io/blogs/ å¦‚æœæ²¡æœ‰config.yamlå’‹åŠï¼ŸæŠŠåŸæ¥çš„config.xxxåˆ äº†ï¼Œè‡ªå·±åˆ›å»ºconfig.yamlå³å¯ï¼hugoä¼šè¯†åˆ«åˆ°è¿™ä¸ªé…ç½®æ–‡ä»¶å“¦ï¼\n5ã€å†å‘å¸ƒä¸€ç¯‡æ–°æ–‡ç«  è¿›å…¥ç½‘ç«™ç›®å½•ï¼Œæ–°å»ºæ–‡ç« \n1 hugo new posts/second-post.md åœ¨vscodeæˆ–å…¶ä»–markdownç¼–è¾‘å™¨ä¸­ç¼–å†™æ–‡ç« ï¼Œè®°å¾—æŠŠdraftå–æ¶ˆå“¦\ngitæäº¤å¹¶æ¨é€\nç­‰å¾…ç½‘ç«™è‡ªåŠ¨æ„å»º\nè®¿é—®ç½‘ç«™\næ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿å‘¢\næœ€å hugoæä¾›äº†å¾ˆå¤šå¥½çœ‹çš„ä¸»é¢˜ï¼Œå‚è€ƒä¸»é¢˜æŒ‡å—è¿›è¡Œæ›´æ¢å“¦ï¼Œæ¯”å¦‚æˆ‘ä½¿ç”¨çš„hugo-theme-stack\né…ç½®æ–¹æ³•å°±æ˜¯åœ¨ç½‘ç«™ç›®å½•ä¸‹æ·»åŠ è¿™ä¸ªåº“\n1 git submodule add https://github.com/CaiJimmy/hugo-theme-stack themes/hugo-theme-stack å¹¶ä¿®æ”¹config.yamlï¼Œè¿™ä¸ªå¯ä»¥ç›´æ¥å¤åˆ¶hugo-theme-stackä¸‹examplesiteçš„config.yamlå†ä¿®æ”¹å“¦ã€‚æœ€ä¸»è¦çš„å°±æ˜¯baseurlæ¢æˆä½ çš„ç½‘ç«™åœ°å€å³å¯ï¼ä¸‹é¢è´´ä¸Šæˆ‘çš„é…ç½®.\nThe End\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 baseurl: https://chajiuqqq.github.io/blogs/ languageCode: en-us theme: hugo-theme-stack paginate: 5 title: èŒ¶é…’çš„å°ç«™ languages: en: languageName: English title: Chajiu\u0026#39;s blog weight: 1 zh-cn: languageName: ä¸­æ–‡ title: èŒ¶é…’çš„å°ç«™ weight: 2 ar: languageName: Ø¹Ø±Ø¨ÙŠ languagedirection: rtl title: Ù…ÙˆÙ‚Ø¹ ØªØ¬Ø±ÙŠØ¨ÙŠ weight: 3 # Change it to your Disqus shortname before using disqusShortname: hugo-theme-stack # GA Tracking ID googleAnalytics: # Theme i18n support # Available values: ar, bn, ca, de, el, en, es, fr, hu, id, it, ja, ko, nl, pt-br, th, uk, zh-cn, zh-hk, zh-tw DefaultContentLanguage: zh-cn # Set hasCJKLanguage to true if DefaultContentLanguage is in [zh-cn ja ko] # This will make .Summary and .WordCount behave correctly for CJK languages. hasCJKLanguage: true permalinks: post: /p/:slug/ page: /:slug/ params: mainSections: - post featuredImageField: image rssFullContent: true favicon: footer: since: 2020 customText: dateFormat: published: Jan 02, 2006 lastUpdated: Jan 02, 2006 15:04 MST sidebar: emoji: ğŸ¥ subtitle: ä¸€ä¸ªå¹´è½»çš„å°ç«™ avatar: enabled: true local: true src: img/avatar.jpeg article: math: false toc: true readingTime: true license: enabled: true default: Licensed under CC BY-NC-SA 4.0 comments: enabled: true provider: disqus disqusjs: shortname: apiUrl: apiKey: admin: adminLabel: utterances: repo: issueTerm: pathname label: remark42: host: site: locale: vssue: platform: owner: repo: clientId: clientSecret: autoCreateIssue: false # Waline client configuration see: https://waline.js.org/en/reference/component.html waline: serverURL: lang: pageview: emoji: - https://unpkg.com/@waline/emojis@1.0.1/weibo requiredMeta: - name - email - url locale: admin: Admin placeholder: twikoo: envId: region: path: lang: # See https://cactus.chat/docs/reference/web-client/#configuration for description of the various options cactus: defaultHomeserverUrl: \u0026#34;https://matrix.cactus.chat:8448\u0026#34; serverName: \u0026#34;cactus.chat\u0026#34; siteName: \u0026#34;\u0026#34; # You must insert a unique identifier here matching the one you registered (See https://cactus.chat/docs/getting-started/quick-start/#register-your-site) giscus: repo: repoID: category: categoryID: mapping: lightTheme: darkTheme: reactionsEnabled: 1 emitMetadata: 0 gitalk: owner: admin: repo: clientID: clientSecret: cusdis: host: id: widgets: homepage: - type: search - type: archives params: limit: 5 - type: categories params: limit: 10 - type: tag-cloud params: limit: 10 page: - type: toc opengraph: twitter: # Your Twitter username site: # Available values: summary, summary_large_image card: summary_large_image defaultImage: opengraph: enabled: false local: false src: colorScheme: # Display toggle toggle: true # Available values: auto, light, dark default: auto imageProcessing: cover: enabled: true content: enabled: true ### Custom menu ### See https://docs.stack.jimmycai.com/configuration/custom-menu.html ### To remove about, archive and search page menu item, remove `menu` field from their FrontMatter menu: main: [] social: - identifier: github name: GitHub url: https://github.com/chajiuqqq params: icon: brand-github - identifier: twitter name: Twitter url: https://twitter.com params: icon: brand-twitter related: includeNewer: true threshold: 60 toLower: false indices: - name: tags weight: 100 - name: categories weight: 200 markup: goldmark: renderer: ## Set to true if you have HTML content inside Markdown unsafe: false tableOfContents: endLevel: 4 ordered: true startLevel: 2 highlight: noClasses: false codeFences: true guessSyntax: true lineNoStart: 1 lineNos: true lineNumbersInTable: true tabWidth: 4 ","date":"2022-08-24T16:32:10+08:00","permalink":"https://chajiuqqq.github.io/blogs/p/hugo--gitpages%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%8C%87%E5%8D%97/","title":"Hugo + GitPagesåšå®¢æ­å»ºæŒ‡å—"},{"content":"æ­£æ–‡ ä½ å¥½ï¼Œæµ‹è¯•\nè¿™æ˜¯2æœµç¾ä¸½çš„èŠ±ï¼š\nç«–æ’ï¼š\nç¬¬äºŒæ®µ ä¼šè®®\n","date":"2022-08-18T15:20:49+08:00","image":"https://chajiuqqq.github.io/blogs/p/say-hello/butterfly-7353884_1920_hue396b29070a692a4e28129944f8b6538_270095_120x120_fill_q75_box_smart1.jpeg","permalink":"https://chajiuqqq.github.io/blogs/p/say-hello/","title":"Say Hello"},{"content":"æ­£æ–‡æµ‹è¯• è€Œè¿™äº›å¹¶ä¸æ˜¯å®Œå…¨é‡è¦ï¼Œæ›´åŠ é‡è¦çš„é—®é¢˜æ˜¯ï¼Œ å¸¦ç€è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æ¥å®¡è§†ä¸€ä¸‹å­¦ç”Ÿä¼šé€€ä¼šã€‚ æ—¢ç„¶å¦‚ä½•ï¼Œ å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œå­¦ç”Ÿä¼šé€€ä¼šä¸ä»…ä»…æ˜¯ä¸€ä¸ªé‡å¤§çš„äº‹ä»¶ï¼Œè¿˜å¯èƒ½ä¼šæ”¹å˜æˆ‘çš„äººç”Ÿã€‚ æˆ‘ä»¬ä¸å¾—ä¸é¢å¯¹ä¸€ä¸ªéå¸¸å°´å°¬çš„äº‹å®ï¼Œé‚£å°±æ˜¯ï¼Œ å¯æ˜¯ï¼Œå³ä½¿æ˜¯è¿™æ ·ï¼Œå­¦ç”Ÿä¼šé€€ä¼šçš„å‡ºç°ä»ç„¶ä»£è¡¨äº†ä¸€å®šçš„æ„ä¹‰ã€‚ å­¦ç”Ÿä¼šé€€ä¼šï¼Œå‘ç”Ÿäº†ä¼šå¦‚ä½•ï¼Œä¸å‘ç”Ÿåˆä¼šå¦‚ä½•ã€‚ ç»è¿‡ä¸Šè¿°è®¨è®ºï¼Œ ç”Ÿæ´»ä¸­ï¼Œè‹¥å­¦ç”Ÿä¼šé€€ä¼šå‡ºç°äº†ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸è€ƒè™‘å®ƒå‡ºç°äº†çš„äº‹å®ã€‚ å­¦ç”Ÿä¼šé€€ä¼šï¼Œåˆ°åº•åº”è¯¥å¦‚ä½•å®ç°ã€‚ è¿™æ ·çœ‹æ¥ï¼Œ åœ¨è¿™ç§å›°éš¾çš„æŠ‰æ‹©ä¸‹ï¼Œæœ¬äººæ€æ¥æƒ³å»ï¼Œå¯é£Ÿéš¾å®‰ã€‚ å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œå­¦ç”Ÿä¼šé€€ä¼šä¸ä»…ä»…æ˜¯ä¸€ä¸ªé‡å¤§çš„äº‹ä»¶ï¼Œè¿˜å¯èƒ½ä¼šæ”¹å˜æˆ‘çš„äººç”Ÿã€‚ å°±æˆ‘ä¸ªäººæ¥è¯´ï¼Œå­¦ç”Ÿä¼šé€€ä¼šå¯¹æˆ‘çš„æ„ä¹‰ï¼Œä¸èƒ½ä¸è¯´éå¸¸é‡å¤§ã€‚ èå£«æ¯”äºšæ›¾ç»æåˆ°è¿‡ï¼Œäººçš„ä¸€ç”Ÿæ˜¯çŸ­çš„ï¼Œä½†å¦‚æœå‘åŠ£åœ°è¿‡è¿™ä¸€ç”Ÿï¼Œå°±å¤ªé•¿äº†ã€‚è¿™ä¼¼ä¹è§£ç­”äº†æˆ‘çš„ç–‘æƒ‘ã€‚ è«æ‰ç‰¹è¯´è¿‡ä¸€å¥å¯Œæœ‰å“²ç†çš„è¯ï¼Œè°å’Œæˆ‘ä¸€æ ·ç”¨åŠŸï¼Œè°å°±ä¼šå’Œæˆ‘ä¸€æ ·æˆåŠŸã€‚è¿™å¯å‘äº†æˆ‘ï¼Œ å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œå­¦ç”Ÿä¼šé€€ä¼šä¸ä»…ä»…æ˜¯ä¸€ä¸ªé‡å¤§çš„äº‹ä»¶ï¼Œè¿˜å¯èƒ½ä¼šæ”¹å˜æˆ‘çš„äººç”Ÿã€‚ å­¦ç”Ÿä¼šé€€ä¼šï¼Œåˆ°åº•åº”è¯¥å¦‚ä½•å®ç°ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œ ä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œ è¿™ç§äº‹å®å¯¹æœ¬äººæ¥è¯´æ„ä¹‰é‡å¤§ï¼Œç›¸ä¿¡å¯¹è¿™ä¸ªä¸–ç•Œä¹Ÿæ˜¯æœ‰ä¸€å®šæ„ä¹‰çš„ã€‚ åœ¨è¿™ç§å›°éš¾çš„æŠ‰æ‹©ä¸‹ï¼Œæœ¬äººæ€æ¥æƒ³å»ï¼Œå¯é£Ÿéš¾å®‰ã€‚ äº†è§£æ¸…æ¥šå­¦ç”Ÿä¼šé€€ä¼šåˆ°åº•æ˜¯ä¸€ç§æ€ä¹ˆæ ·çš„å­˜åœ¨ï¼Œæ˜¯è§£å†³ä¸€åˆ‡é—®é¢˜çš„å…³é”®ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œ ç”Ÿæ´»ä¸­ï¼Œè‹¥å­¦ç”Ÿä¼šé€€ä¼šå‡ºç°äº†ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸è€ƒè™‘å®ƒå‡ºç°äº†çš„äº‹å®ã€‚ é—®é¢˜çš„å…³é”®ç©¶ç«Ÿä¸ºä½•ï¼Ÿ è€Œè¿™äº›å¹¶ä¸æ˜¯å®Œå…¨é‡è¦ï¼Œæ›´åŠ é‡è¦çš„é—®é¢˜æ˜¯ã€‚\nå¥¥æ–¯ç‰¹æ´›å¤«æ–¯åŸºæ›¾ç»è¯´è¿‡ï¼Œå…±åŒçš„äº‹ä¸šï¼Œå…±åŒçš„æ–—äº‰ï¼Œå¯ä»¥ä½¿äººä»¬äº§ç”Ÿå¿å—ä¸€åˆ‡çš„åŠ›é‡ã€‚ã€€å¸¦ç€è¿™å¥è¯ï¼Œæˆ‘ä»¬è¿˜è¦æ›´åŠ æ…é‡çš„å®¡è§†è¿™ä¸ªé—®é¢˜ï¼š ä¸€èˆ¬æ¥è®²ï¼Œæˆ‘ä»¬éƒ½å¿…é¡»åŠ¡å¿…æ…é‡çš„è€ƒè™‘è€ƒè™‘ã€‚ æ—¢ç„¶å¦‚æ­¤ï¼Œ è¿™ç§äº‹å®å¯¹æœ¬äººæ¥è¯´æ„ä¹‰é‡å¤§ï¼Œç›¸ä¿¡å¯¹è¿™ä¸ªä¸–ç•Œä¹Ÿæ˜¯æœ‰ä¸€å®šæ„ä¹‰çš„ã€‚ å¸¦ç€è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æ¥å®¡è§†ä¸€ä¸‹å­¦ç”Ÿä¼šé€€ä¼šã€‚ æˆ‘è®¤ä¸ºï¼Œ æˆ‘è®¤ä¸ºï¼Œ åœ¨è¿™ç§å›°éš¾çš„æŠ‰æ‹©ä¸‹ï¼Œæœ¬äººæ€æ¥æƒ³å»ï¼Œå¯é£Ÿéš¾å®‰ã€‚ é—®é¢˜çš„å…³é”®ç©¶ç«Ÿä¸ºä½•ï¼Ÿ æ¯ä¸ªäººéƒ½ä¸å¾—ä¸é¢å¯¹è¿™äº›é—®é¢˜ã€‚ åœ¨é¢å¯¹è¿™ç§é—®é¢˜æ—¶ï¼Œ è¦æƒ³æ¸…æ¥šï¼Œå­¦ç”Ÿä¼šé€€ä¼šï¼Œåˆ°åº•æ˜¯ä¸€ç§æ€ä¹ˆæ ·çš„å­˜åœ¨ã€‚ æˆ‘è®¤ä¸ºï¼Œ æ—¢ç„¶å¦‚æ­¤ï¼Œ æ¯ä¸ªäººéƒ½ä¸å¾—ä¸é¢å¯¹è¿™äº›é—®é¢˜ã€‚ åœ¨é¢å¯¹è¿™ç§é—®é¢˜æ—¶ï¼Œ é‚£ä¹ˆï¼Œ æˆ‘è®¤ä¸ºï¼Œ å­¦ç”Ÿä¼šé€€ä¼šå› ä½•è€Œå‘ç”Ÿã€‚\nå¼•ç”¨ æ€å¿µæ˜¯æœ€æš–çš„å¿§ä¼¤åƒä¸€åŒç¿…è†€\nè®©æˆ‘åœä¸äº†é£ä¸è¿œåœ¨è¿‡å¾€æ¸¸è¡\nä¸å‘Šè€Œåˆ«çš„ä½  å°±ç®—ä¸ºäº†æˆ‘ç€æƒ³\nè¿™ä¹ˆæ²‰ç—›çš„å‘µæŠ¤ æˆ‘æ€ä¹ˆèƒ½ç¿±ç¿”\næœ€æš–çš„æ†‚å‚· - ç”°é¦¥ç”„\nå›¾ç‰‡ 1 2 3 ![Photo by Florian Klauer on Unsplash](florian-klauer-nptLmg6jqDo-unsplash.jpg) ![Photo by Luca Bravo on Unsplash](luca-bravo-alS7ewQ41M8-unsplash.jpg) ![Photo by Helena Hertz on Unsplash](helena-hertz-wWZzXlDpMog-unsplash.jpg) ![Photo by Hudai Gayiran on Unsplash](hudai-gayiran-3Od_VKcDEAA-unsplash.jpg) ç›¸å†Œè¯­æ³•æ¥è‡ª Typlog\n","date":"2020-09-09T00:00:00Z","image":"https://chajiuqqq.github.io/blogs/p/test-chinese/helena-hertz-wWZzXlDpMog-unsplash_hu45a5e3ad5e058da6a00650ed8fd40bea_15530_120x120_fill_q75_box_smart1.jpg","permalink":"https://chajiuqqq.github.io/blogs/p/test-chinese/","title":"Chinese Test"},{"content":"This article offers a sample of basic Markdown syntax that can be used in Hugo content files, also it shows whether basic HTML elements are decorated with CSS in a Hugo theme.\nHeadings The following HTML \u0026lt;h1\u0026gt;â€”\u0026lt;h6\u0026gt; elements represent six levels of section headings. \u0026lt;h1\u0026gt; is the highest section level while \u0026lt;h6\u0026gt; is the lowest.\nH1 H2 H3 H4 H5 H6 Paragraph Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.\nItatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.\nBlockquotes The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a footer or cite element, and optionally with in-line changes such as annotations and abbreviations.\nBlockquote without attribution Tiam, ad mint andaepu dandae nostion secatur sequo quae. Note that you can use Markdown syntax within a blockquote.\nBlockquote with attribution Don\u0026rsquo;t communicate by sharing memory, share memory by communicating. â€” Rob Pike1\nTables Tables aren\u0026rsquo;t part of the core Markdown spec, but Hugo supports supports them out-of-the-box.\nName Age Bob 27 Alice 23 Inline Markdown within tables Italics Bold Code italics bold code A B C D E F Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus ultricies, sapien non euismod aliquam, dui ligula tincidunt odio, at accumsan nulla sapien eget ex. Proin eleifend dictum ipsum, non euismod ipsum pulvinar et. Vivamus sollicitudin, quam in pulvinar aliquam, metus elit pretium purus Proin sit amet velit nec enim imperdiet vehicula. Ut bibendum vestibulum quam, eu egestas turpis gravida nec Sed scelerisque nec turpis vel viverra. Vivamus vitae pretium sapien Code Blocks Code block with backticks 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block indented with four spaces \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block with Hugo\u0026rsquo;s internal highlight shortcode 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Diff code block 1 2 3 4 5 [dependencies.bevy] git = \u0026#34;https://github.com/bevyengine/bevy\u0026#34; rev = \u0026#34;11f52b8c72fc3a568e8bb4a4cd1f3eb025ac2e13\u0026#34; - features = [\u0026#34;dynamic\u0026#34;] + features = [\u0026#34;jpeg\u0026#34;, \u0026#34;dynamic\u0026#34;] List Types Ordered List First item Second item Third item Unordered List List item Another item And another item Nested list Fruit Apple Orange Banana Dairy Milk Cheese Other Elements â€” abbr, sub, sup, kbd, mark GIF is a bitmap image format.\nH2O\nXn + Yn = Zn\nPress CTRL+ALT+Delete to end the session.\nMost salamanders are nocturnal, and hunt for insects, worms, and other small creatures.\nHyperlinked image The above quote is excerpted from Rob Pike\u0026rsquo;s talk during Gopherfest, November 18, 2015.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","date":"2019-03-11T00:00:00Z","image":"https://chajiuqqq.github.io/blogs/p/markdown-syntax-guide/pawel-czerwinski-8uZPynIu-rQ-unsplash_hud7e36f7e20e71be184458283bdae4646_55974_120x120_fill_q75_box_smart1.jpg","permalink":"https://chajiuqqq.github.io/blogs/p/markdown-syntax-guide/","title":"Markdown Syntax Guide"},{"content":"Hugo ships with several Built-in Shortcodes for rich content, along with a Privacy Config and a set of Simple Shortcodes that enable static and no-JS versions of various social media embeds.\nYouTube Privacy Enhanced Shortcode Twitter Simple Shortcode â€œIn addition to being more logical, asymmetry has the advantage that its complete appearance is far more optically effective than symmetry.â€\nâ€” Jan Tschichold pic.twitter.com/gcv7SrhvJb\n\u0026mdash; Design Reviewed | Graphic Design History (@DesignReviewed) January 17, 2019 Vimeo Simple Shortcode bilibilibi Shortcode Gist Shortcode Gitlab Snippets Shortcode Quote Shortcode Stack adds a quote shortcode. For example:\nLorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\nâ€• A famous person, The book they wrote Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\nâ€• Anonymous book Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\nâ€• Some book Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\nâ€• Somebody","date":"2019-03-10T00:00:00Z","permalink":"https://chajiuqqq.github.io/blogs/p/rich-content/","title":"Rich Content"},{"content":"Mathematical notation in a Hugo project can be enabled by using third party JavaScript libraries.\nIn this example we will be using KaTeX\nCreate a partial under /layouts/partials/math.html Within this partial reference the Auto-render Extension or host these scripts locally. Include the partial in your templates like so: 1 2 3 {{ if or .Params.math .Site.Params.math }} {{ partial \u0026#34;math.html\u0026#34; . }} {{ end }} To enable KaTex globally set the parameter math to true in a project\u0026rsquo;s configuration To enable KaTex on a per page basis include the parameter math: true in content files Note: Use the online reference of Supported TeX Functions\nExamples Block math: $$ \\varphi = 1+\\frac{1} {1+\\frac{1} {1+\\frac{1} {1+\\cdots} } } $$\n","date":"2019-03-08T00:00:00Z","permalink":"https://chajiuqqq.github.io/blogs/p/math-typesetting/","title":"Math Typesetting"},{"content":"Emoji can be enabled in a Hugo project in a number of ways.\nThe emojify function can be called directly in templates or Inline Shortcodes.\nTo enable emoji globally, set enableEmoji to true in your site\u0026rsquo;s configuration and then you can type emoji shorthand codes directly in content files; e.g.\nThe Emoji cheat sheet is a useful reference for emoji shorthand codes.\nN.B. The above steps enable Unicode Standard emoji characters and sequences in Hugo, however the rendering of these glyphs depends on the browser and the platform. To style the emoji you can either use a third party emoji font or a font stack; e.g.\n1 2 3 .emoji { font-family: Apple Color Emoji, Segoe UI Emoji, NotoColorEmoji, Segoe UI Symbol, Android Emoji, EmojiSymbols; } ","date":"2019-03-05T00:00:00Z","image":"https://chajiuqqq.github.io/blogs/p/emoji-support/the-creative-exchange-d2zvqp3fpro-unsplash_huf941de4769045cdfa8c9ee7036519a2a_35369_120x120_fill_q75_box_smart1.jpg","permalink":"https://chajiuqqq.github.io/blogs/p/emoji-support/","title":"Emoji Support"}]